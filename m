Return-Path: <nouveau-bounces@lists.freedesktop.org>
X-Original-To: lists+nouveau@lfdr.de
Delivered-To: lists+nouveau@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 94130434CC
	for <lists+nouveau@lfdr.de>; Thu, 13 Jun 2019 11:43:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1464B89850;
	Thu, 13 Jun 2019 09:43:51 +0000 (UTC)
X-Original-To: nouveau@lists.freedesktop.org
Delivered-To: nouveau@lists.freedesktop.org
Received: from bombadil.infradead.org (bombadil.infradead.org
 [IPv6:2607:7c80:54:e::133])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A90C489850;
 Thu, 13 Jun 2019 09:43:49 +0000 (UTC)
Received: from mpp-cp1-natpool-1-198.ethz.ch ([82.130.71.198] helo=localhost)
 by bombadil.infradead.org with esmtpsa (Exim 4.92 #3 (Red Hat Linux))
 id 1hbMGo-0001lZ-Cj; Thu, 13 Jun 2019 09:43:46 +0000
From: Christoph Hellwig <hch@lst.de>
To: Dan Williams <dan.j.williams@intel.com>,
 =?UTF-8?q?J=C3=A9r=C3=B4me=20Glisse?= <jglisse@redhat.com>,
 Jason Gunthorpe <jgg@mellanox.com>, Ben Skeggs <bskeggs@redhat.com>
Date: Thu, 13 Jun 2019 11:43:09 +0200
Message-Id: <20190613094326.24093-7-hch@lst.de>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190613094326.24093-1-hch@lst.de>
References: <20190613094326.24093-1-hch@lst.de>
MIME-Version: 1.0
X-SRS-Rewrite: SMTP reverse-path rewritten from <hch@infradead.org> by
 bombadil.infradead.org. See http://www.infradead.org/rpr.html
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; 
 d=infradead.org; s=bombadil.20170209; h=Content-Transfer-Encoding:
 MIME-Version:References:In-Reply-To:Message-Id:Date:Subject:Cc:To:From:Sender
 :Reply-To:Content-Type:Content-ID:Content-Description:Resent-Date:Resent-From
 :Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Id:List-Help:
 List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=U+naUp6GJ2c/vfJkCwMO0IpliZVzAgQ1geAwtt/0bck=; b=QwHN3Ivc9/431JjZXwTTSF08rO
 hXrz9haLO+d9Q3IUHfpmJTWlt7YXy/NmVHDKKTD/S+hOE4Iu0sImh3ze2ah7uPgw3Ei9X4uKveyn/
 nsmcYq0LFNlYJpg+2os1UWxfhf/0nIJoqy+Sw+YSOCSsLRjhEfzfdB5pljAfNGKYcC0tMcDPRgbPE
 fc5wdASA11vbKRHWzIsWFALeW2JqScCVdyapFn6VpyWwynpkuTmK8WBHg8NlvHxlGwpmm3SGTXN+Q
 yYignYCrY/T0XlMl97q/6sfhwXRxvc26NXzsHK9MeWjhS6x6hjc2xLbTs1LjAwLCYlTdNCmJxrgk4
 fOpj7qYg==;
Subject: [Nouveau] [PATCH 06/22] mm: factor out a
 devm_request_free_mem_region helper
X-BeenThere: nouveau@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Nouveau development list <nouveau.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/nouveau>
List-Post: <mailto:nouveau@lists.freedesktop.org>
List-Help: <mailto:nouveau-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-nvdimm@lists.01.org, linux-pci@vger.kernel.org,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 linux-mm@kvack.org, nouveau@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: nouveau-bounces@lists.freedesktop.org
Sender: "Nouveau" <nouveau-bounces@lists.freedesktop.org>

S2VlcCB0aGUgcGh5c2ljYWwgYWRkcmVzcyBhbGxvY2F0aW9uIHRoYXQgaG1tX2FkZF9kZXZpY2Ug
ZG9lcyB3aXRoIHRoZQpyZXN0IG9mIHRoZSByZXNvdXJjZSBjb2RlLCBhbmQgYWxsb3cgZnV0dXJl
IHJldXNlIG9mIGl0IHdpdGhvdXQgdGhlIGhtbQp3cmFwcGVyLgoKU2lnbmVkLW9mZi1ieTogQ2hy
aXN0b3BoIEhlbGx3aWcgPGhjaEBsc3QuZGU+Ci0tLQogaW5jbHVkZS9saW51eC9pb3BvcnQuaCB8
ICAyICsrCiBrZXJuZWwvcmVzb3VyY2UuYyAgICAgIHwgMzkgKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrCiBtbS9obW0uYyAgICAgICAgICAgICAgIHwgMzMgKysrKy0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAzIGZpbGVzIGNoYW5nZWQsIDQ1IGluc2VydGlvbnMo
KyksIDI5IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvaW9wb3J0Lmgg
Yi9pbmNsdWRlL2xpbnV4L2lvcG9ydC5oCmluZGV4IGRhMGViYWVjMjVmMC4uNzZhMzNhZTNiZjZj
IDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2lvcG9ydC5oCisrKyBiL2luY2x1ZGUvbGludXgv
aW9wb3J0LmgKQEAgLTI4Niw2ICsyODYsOCBAQCBzdGF0aWMgaW5saW5lIGJvb2wgcmVzb3VyY2Vf
b3ZlcmxhcHMoc3RydWN0IHJlc291cmNlICpyMSwgc3RydWN0IHJlc291cmNlICpyMikKICAgICAg
ICByZXR1cm4gKHIxLT5zdGFydCA8PSByMi0+ZW5kICYmIHIxLT5lbmQgPj0gcjItPnN0YXJ0KTsK
IH0KIAorc3RydWN0IHJlc291cmNlICpkZXZtX3JlcXVlc3RfZnJlZV9tZW1fcmVnaW9uKHN0cnVj
dCBkZXZpY2UgKmRldiwKKwkJc3RydWN0IHJlc291cmNlICpiYXNlLCB1bnNpZ25lZCBsb25nIHNp
emUpOwogCiAjZW5kaWYgLyogX19BU1NFTUJMWV9fICovCiAjZW5kaWYJLyogX0xJTlVYX0lPUE9S
VF9IICovCmRpZmYgLS1naXQgYS9rZXJuZWwvcmVzb3VyY2UuYyBiL2tlcm5lbC9yZXNvdXJjZS5j
CmluZGV4IDE1OGYwNGVjMWQ0Zi4uOTljNTgxMzRlZDFjIDEwMDY0NAotLS0gYS9rZXJuZWwvcmVz
b3VyY2UuYworKysgYi9rZXJuZWwvcmVzb3VyY2UuYwpAQCAtMTYyOCw2ICsxNjI4LDQ1IEBAIHZv
aWQgcmVzb3VyY2VfbGlzdF9mcmVlKHN0cnVjdCBsaXN0X2hlYWQgKmhlYWQpCiB9CiBFWFBPUlRf
U1lNQk9MKHJlc291cmNlX2xpc3RfZnJlZSk7CiAKKyNpZmRlZiBDT05GSUdfREVWSUNFX1BSSVZB
VEUKKy8qKgorICogZGV2bV9yZXF1ZXN0X2ZyZWVfbWVtX3JlZ2lvbiAtIGZpbmQgZnJlZSByZWdp
b24gZm9yIGRldmljZSBwcml2YXRlIG1lbW9yeQorICoKKyAqIEBkZXY6IGRldmljZSBzdHJ1Y3Qg
dG8gYmluZCB0aGUgcmVzb3VyY2UgdG9vCisgKiBAc2l6ZTogc2l6ZSBpbiBieXRlcyBvZiB0aGUg
ZGV2aWNlIG1lbW9yeSB0byBhZGQKKyAqIEBiYXNlOiByZXNvdXJjZSB0cmVlIHRvIGxvb2sgaW4K
KyAqCisgKiBUaGlzIGZ1bmN0aW9uIHRyaWVzIHRvIGZpbmQgYW4gZW1wdHkgcmFuZ2Ugb2YgcGh5
c2ljYWwgYWRkcmVzcyBiaWcgZW5vdWdoIHRvCisgKiBjb250YWluIHRoZSBuZXcgcmVzb3VyY2Us
IHNvIHRoYXQgaXQgY2FuIGxhdGVyIGJlIGhvdHBsdWdlZCBhcyBaT05FX0RFVklDRQorICogbWVt
b3J5LCB3aGljaCBpbiB0dXJuIGFsbG9jYXRlcyBzdHJ1Y3QgcGFnZXMuCisgKi8KK3N0cnVjdCBy
ZXNvdXJjZSAqZGV2bV9yZXF1ZXN0X2ZyZWVfbWVtX3JlZ2lvbihzdHJ1Y3QgZGV2aWNlICpkZXYs
CisJCXN0cnVjdCByZXNvdXJjZSAqYmFzZSwgdW5zaWduZWQgbG9uZyBzaXplKQoreworCXJlc291
cmNlX3NpemVfdCBlbmQsIGFkZHI7CisJc3RydWN0IHJlc291cmNlICpyZXM7CisKKwlzaXplID0g
QUxJR04oc2l6ZSwgMVVMIDw8IFBBX1NFQ1RJT05fU0hJRlQpOworCWVuZCA9IG1pbl90KHVuc2ln
bmVkIGxvbmcsIGJhc2UtPmVuZCwgKDFVTCA8PCBNQVhfUEhZU01FTV9CSVRTKSAtIDEpOworCWFk
ZHIgPSBlbmQgLSBzaXplICsgMVVMOworCisJZm9yICg7IGFkZHIgPiBzaXplICYmIGFkZHIgPj0g
YmFzZS0+c3RhcnQ7IGFkZHIgLT0gc2l6ZSkgeworCQlpZiAocmVnaW9uX2ludGVyc2VjdHMoYWRk
ciwgc2l6ZSwgMCwgSU9SRVNfREVTQ19OT05FKSAhPQorCQkJCVJFR0lPTl9ESVNKT0lOVCkKKwkJ
CWNvbnRpbnVlOworCisJCXJlcyA9IGRldm1fcmVxdWVzdF9tZW1fcmVnaW9uKGRldiwgYWRkciwg
c2l6ZSwgZGV2X25hbWUoZGV2KSk7CisJCWlmICghcmVzKQorCQkJcmV0dXJuIEVSUl9QVFIoLUVO
T01FTSk7CisJCXJlcy0+ZGVzYyA9IElPUkVTX0RFU0NfREVWSUNFX1BSSVZBVEVfTUVNT1JZOwor
CQlyZXR1cm4gcmVzOworCX0KKworCXJldHVybiBFUlJfUFRSKC1FUkFOR0UpOworfQorRVhQT1JU
X1NZTUJPTF9HUEwoZGV2bV9yZXF1ZXN0X2ZyZWVfbWVtX3JlZ2lvbik7CisjZW5kaWYgLyogQ09O
RklHX0RFVklDRV9QUklWQVRFICovCisKIHN0YXRpYyBpbnQgX19pbml0IHN0cmljdF9pb21lbShj
aGFyICpzdHIpCiB7CiAJaWYgKHN0cnN0cihzdHIsICJyZWxheGVkIikpCmRpZmYgLS1naXQgYS9t
bS9obW0uYyBiL21tL2htbS5jCmluZGV4IGUxZGM5ODQwN2U3Yi4uMTNhMTZmYWYwYTc3IDEwMDY0
NAotLS0gYS9tbS9obW0uYworKysgYi9tbS9obW0uYwpAQCAtMjYsOCArMjYsNiBAQAogI2luY2x1
ZGUgPGxpbnV4L21tdV9ub3RpZmllci5oPgogI2luY2x1ZGUgPGxpbnV4L21lbW9yeV9ob3RwbHVn
Lmg+CiAKLSNkZWZpbmUgUEFfU0VDVElPTl9TSVpFICgxVUwgPDwgUEFfU0VDVElPTl9TSElGVCkK
LQogI2lmIElTX0VOQUJMRUQoQ09ORklHX0hNTV9NSVJST1IpCiBzdGF0aWMgY29uc3Qgc3RydWN0
IG1tdV9ub3RpZmllcl9vcHMgaG1tX21tdV9ub3RpZmllcl9vcHM7CiAKQEAgLTEzNzIsNyArMTM3
MCw2IEBAIHN0cnVjdCBobW1fZGV2bWVtICpobW1fZGV2bWVtX2FkZChjb25zdCBzdHJ1Y3QgaG1t
X2Rldm1lbV9vcHMgKm9wcywKIAkJCQkgIHVuc2lnbmVkIGxvbmcgc2l6ZSkKIHsKIAlzdHJ1Y3Qg
aG1tX2Rldm1lbSAqZGV2bWVtOwotCXJlc291cmNlX3NpemVfdCBhZGRyOwogCXZvaWQgKnJlc3Vs
dDsKIAlpbnQgcmV0OwogCkBAIC0xMzk4LDMyICsxMzk1LDEwIEBAIHN0cnVjdCBobW1fZGV2bWVt
ICpobW1fZGV2bWVtX2FkZChjb25zdCBzdHJ1Y3QgaG1tX2Rldm1lbV9vcHMgKm9wcywKIAlpZiAo
cmV0KQogCQlyZXR1cm4gRVJSX1BUUihyZXQpOwogCi0Jc2l6ZSA9IEFMSUdOKHNpemUsIFBBX1NF
Q1RJT05fU0laRSk7Ci0JYWRkciA9IG1pbigodW5zaWduZWQgbG9uZylpb21lbV9yZXNvdXJjZS5l
bmQsCi0JCSAgICgxVUwgPDwgTUFYX1BIWVNNRU1fQklUUykgLSAxKTsKLQlhZGRyID0gYWRkciAt
IHNpemUgKyAxVUw7Ci0KLQkvKgotCSAqIEZJWE1FIGFkZCBhIG5ldyBoZWxwZXIgdG8gcXVpY2ts
eSB3YWxrIHJlc291cmNlIHRyZWUgYW5kIGZpbmQgZnJlZQotCSAqIHJhbmdlCi0JICoKLQkgKiBG
SVhNRSB3aGF0IGFib3V0IGlvcG9ydF9yZXNvdXJjZSByZXNvdXJjZSA/Ci0JICovCi0JZm9yICg7
IGFkZHIgPiBzaXplICYmIGFkZHIgPj0gaW9tZW1fcmVzb3VyY2Uuc3RhcnQ7IGFkZHIgLT0gc2l6
ZSkgewotCQlyZXQgPSByZWdpb25faW50ZXJzZWN0cyhhZGRyLCBzaXplLCAwLCBJT1JFU19ERVND
X05PTkUpOwotCQlpZiAocmV0ICE9IFJFR0lPTl9ESVNKT0lOVCkKLQkJCWNvbnRpbnVlOwotCi0J
CWRldm1lbS0+cmVzb3VyY2UgPSBkZXZtX3JlcXVlc3RfbWVtX3JlZ2lvbihkZXZpY2UsIGFkZHIs
IHNpemUsCi0JCQkJCQkJICAgZGV2X25hbWUoZGV2aWNlKSk7Ci0JCWlmICghZGV2bWVtLT5yZXNv
dXJjZSkKLQkJCXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwotCQlicmVhazsKLQl9Ci0JaWYgKCFk
ZXZtZW0tPnJlc291cmNlKQotCQlyZXR1cm4gRVJSX1BUUigtRVJBTkdFKTsKLQotCWRldm1lbS0+
cmVzb3VyY2UtPmRlc2MgPSBJT1JFU19ERVNDX0RFVklDRV9QUklWQVRFX01FTU9SWTsKKwlkZXZt
ZW0tPnJlc291cmNlID0gZGV2bV9yZXF1ZXN0X2ZyZWVfbWVtX3JlZ2lvbihkZXZpY2UsICZpb21l
bV9yZXNvdXJjZSwKKwkJCXNpemUpOworCWlmIChJU19FUlIoZGV2bWVtLT5yZXNvdXJjZSkpCisJ
CXJldHVybiBFUlJfQ0FTVChkZXZtZW0tPnJlc291cmNlKTsKIAlkZXZtZW0tPnBmbl9maXJzdCA9
IGRldm1lbS0+cmVzb3VyY2UtPnN0YXJ0ID4+IFBBR0VfU0hJRlQ7CiAJZGV2bWVtLT5wZm5fbGFz
dCA9IGRldm1lbS0+cGZuX2ZpcnN0ICsKIAkJCSAgIChyZXNvdXJjZV9zaXplKGRldm1lbS0+cmVz
b3VyY2UpID4+IFBBR0VfU0hJRlQpOwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpOb3V2ZWF1IG1haWxpbmcgbGlzdApOb3V2ZWF1QGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL25vdXZlYXU=
