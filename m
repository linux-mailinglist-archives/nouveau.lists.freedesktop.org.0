Return-Path: <nouveau-bounces@lists.freedesktop.org>
X-Original-To: lists+nouveau@lfdr.de
Delivered-To: lists+nouveau@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id EDADDD62E1
	for <lists+nouveau@lfdr.de>; Mon, 14 Oct 2019 14:46:57 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4A3866E2A5;
	Mon, 14 Oct 2019 12:46:56 +0000 (UTC)
X-Original-To: nouveau@lists.freedesktop.org
Delivered-To: nouveau@lists.freedesktop.org
Received: from us-smtp-delivery-1.mimecast.com (us-smtp-2.mimecast.com
 [205.139.110.61])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8F0A16E22E
 for <nouveau@lists.freedesktop.org>; Mon, 14 Oct 2019 12:46:54 +0000 (UTC)
Received: from mail-qt1-f197.google.com (mail-qt1-f197.google.com
 [209.85.160.197]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-308-ED8sIrhKN2WOOA8djrZEoA-1; Mon, 14 Oct 2019 08:46:51 -0400
Received: by mail-qt1-f197.google.com with SMTP id y10so17804318qti.1
 for <nouveau@lists.freedesktop.org>; Mon, 14 Oct 2019 05:46:51 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=F4Hid4ZtUHgFm4/Gfd7gQfIRqLASGWwN8ALP+z1HiJE=;
 b=CtKohmXgKNE329X7T9O8i78/vyrb/uHqawIwaOvLGNzQYWT0q/ytrM0Vz9B/0hM2Id
 rnPbxQ1eUnP3z6iKDTd+bA6ubrdkp2Dl42EIxwQqEVa3msuOTu0k0UGCmgywDNIphrnd
 HM89nX4uDC71T8JAfJu+ooUAmW0yxKIUeQ7QK2IIJPEFtlc/jR8IX18IrfhBzwaVUyLL
 QyAPrEljKA4uXmOUNxnDZl7iPvXL+4Y59CZ5A4MvnQ+Cn/FO1AhTqWh9PPdvS9ryvwlZ
 m4QB0kro4pOhgFzs/7aU7IATynF6r1BbZUVz2HNzPXVUxfEs1yfkXDP6UdBWOHSJHpKk
 C3Zg==
X-Gm-Message-State: APjAAAWw+V6mxzEeT1EJze1jx09faDVAYGNQgzbJjNBfmscqv9r3NaZW
 bX1f6U97gfLjxzHEOEoRlzXAHHvNk8bbHP0txLvlC+9yN5FPtvVcEbDgy3WmtFnsMjEjLUmG6fQ
 imWWo5pDuM2hcyYspLuUHSw9RHH1b/E6hewl9ke+y4w==
X-Received: by 2002:ac8:664b:: with SMTP id j11mr32513952qtp.137.1571057210494; 
 Mon, 14 Oct 2019 05:46:50 -0700 (PDT)
X-Google-Smtp-Source: APXvYqxrlqypS1D0oISMEE4tLvucGCc5bUIiHOXnu2n8wyuDdf4e4ufIU7KgUBm8P8b8MEBPtWbMmbmBoglJxI0OMP4=
X-Received: by 2002:ac8:664b:: with SMTP id j11mr32513900qtp.137.1571057209786; 
 Mon, 14 Oct 2019 05:46:49 -0700 (PDT)
MIME-Version: 1.0
References: <20191014052233.30968-1-imirkin@alum.mit.edu>
In-Reply-To: <20191014052233.30968-1-imirkin@alum.mit.edu>
From: Karol Herbst <kherbst@redhat.com>
Date: Mon, 14 Oct 2019 14:46:38 +0200
Message-ID: <CACO55tuktVX1dGAnx4BkC1GRYzYx8b9r-qG-wjTEM54X7c+rtQ@mail.gmail.com>
To: Ilia Mirkin <imirkin@alum.mit.edu>
X-MC-Unique: ED8sIrhKN2WOOA8djrZEoA-1
X-Mimecast-Spam-Score: 0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=redhat.com; 
 s=mimecast20190719; t=1571057213;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=Mo7qfUL5Frk5UguCOT/FS59VwGisEWWOYx8hO6hCVEc=;
 b=GRhInKgJcRtS4s+QhJTjL7f+tqioGzXNI7vrSivU2f1Z0iWdObRq2n1hmfpCPWQ7I0H/Kb
 4Nv+Z+2eBjKAJ+r+ckpIv1Vqsx3aTC3y8PfsKx5H1e5PEIGXKJAc/3Xv/x1SljPSGjD/xn
 IJ2HAZJB+xwg+Ps3riC4SLw+JB6NuHg=
Subject: Re: [Nouveau] [PATCH] gm107/ir: fix loading z offset for layered 3d
 image bindings
X-BeenThere: nouveau@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Nouveau development list <nouveau.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/nouveau>
List-Post: <mailto:nouveau@lists.freedesktop.org>
List-Help: <mailto:nouveau-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=subscribe>
Cc: ML Mesa-dev <mesa-dev@lists.freedesktop.org>,
 nouveau <nouveau@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: nouveau-bounces@lists.freedesktop.org
Sender: "Nouveau" <nouveau-bounces@lists.freedesktop.org>

SSBkb24ndCB0aGluayB0aGlzIGlzIGEgZ29vZCBpZGVhIG92ZXJhbGwuCgpUaGUgd2F5IHNpbXBs
ZXIgc29sdXRpb24gd291bGQgYmUgdG8gZGlzYWJsZSB0aWxpbmcgb24gdGhlIHogYXhpcyBmb3IK
M2QgaW1hZ2VzIHNvIHRoYXQgd2UgZG9uJ3QgaHVydCB0aGUgbW9zdCBjb21tb24gY2FzZSwgMmQg
aW1hZ2VzLiBBbmQKdGhhdCdzIHdoYXQgSSB3YXMgc2VlaW5nIG52aWRpYSBkb2luZyBhbnl3YXku
CgpTbyB3aXRoIHRoYXQgd2Ugd291bGQgZW5kIHVwIGFkZGluZyBhIGJ1bmNoIG9mIGluc3RydWN0
aW9ucyBodXJ0aW5nCnRoZSAyZCBpbWFnZSBjYXNlLCBqdXN0IHRvIHN1cHBvcnQgc29tZXRoaW5n
IG5vIHVzZXIgd2lsbCBjYXJlIGFib3V0CmFueXdheS4KCk9uIE1vbiwgT2N0IDE0LCAyMDE5IGF0
IDc6MjIgQU0gSWxpYSBNaXJraW4gPGltaXJraW5AYWx1bS5taXQuZWR1PiB3cm90ZToKPgo+IFVu
Zm9ydHVhbnRlbHkgd2UgZG9uJ3Qga25vdyBpZiBhIHBhcnRpY3VsYXIgbG9hZCBpcyBhIHJlYWwg
MmQgaW1hZ2UgKGFzCj4gd291bGQgYmUgYSBjdWJlIGZhY2Ugb3IgMmQgYXJyYXkgZWxlbWVudCks
IG9yIGEgbGF5ZXIgb2YgYSAzZCBpbWFnZS4KPiBTaW5jZSB3ZSBwYXNzIGluIHRoZSBUSUMgcmVm
ZXJlbmNlLCB0aGUgaW5zdHJ1Y3Rpb24ncyB0eXBlIGhhcyB0byBtYXRjaAo+IHdoYXQncyBpbiB0
aGUgVElDIChleHBlcmltZW50YWxseSkuIEluIG9yZGVyIHRvIHByb3Blcmx5IHN1cHBvcnQKPiBi
aW5kbGVzcyBpbWFnZXMsIHRoaXMgYWxzbyBjYW4ndCBiZSBkb25lIGJ5IGxvb2tpbmcgYXQgdGhl
IGN1cnJlbnQKPiBiaW5kaW5ncyBhbmQgZ2VuZXJhdGluZyBhcHByb3ByaWF0ZSBjb2RlLgo+Cj4g
QXMgYSByZXN1bHQgYWxsIHBsYWluIDJkIGxvYWRzIGFyZSBjb252ZXJ0ZWQgaW50byBhIHBhaXIg
b2YgMmQvM2QgbG9hZHMsCj4gd2l0aCBhcHByb3ByaWF0ZSBwcmVkaWNhdGVzIHRvIGVuc3VyZSBv
bmx5IG9uZSBvZiB0aG9zZSBhY3R1YWxseQo+IGV4ZWN1dGVzLCBhbmQgdGhlIHZhbHVlcyBhcmUg
YWxsIG1lcmdlZCBpbi4KPgo+IFRoaXMgZ29lcyBzb21ld2hhdCBhZ2FpbnN0IHRoZSBjdXJyZW50
IGZsb3csIHNvIGZvciBHTTEwNyB3ZSBkbyB0aGUgT09CCj4gaGFuZGxpbmcgZGlyZWN0bHkgaW4g
dGhlIHN1cmZhY2UgcHJvY2Vzc2luZyBsb2dpYy4gUGVyaGFwcyB0aGUgb3RoZXIKPiBnZW5zIHNo
b3VsZCBkbyBzb21ldGhpbmcgc2ltaWxhciwgYnV0IHRoYXQgaXMgbGVmdCB0byBhbm90aGVyIGNo
YW5nZS4KPgo+IFRoaXMgZml4ZXMgZEVRUCB0ZXN0cyBsaWtlIGltYWdlX2xvYWRfc3RvcmUuM2Qu
Kl9zaW5nbGVfbGF5ZXIgYW5kIEdMLUNUUwo+IHRlc3RzIGxpa2Ugc2hhZGVyX2ltYWdlX2xvYWRf
c3RvcmUubm9uLWxheWVyZWRfYmluZGluZyB3aXRob3V0IGJyZWFraW5nCj4gYW55dGhpbmcgZWxz
ZS4KPgo+IFNpZ25lZC1vZmYtYnk6IElsaWEgTWlya2luIDxpbWlya2luQGFsdW0ubWl0LmVkdT4K
PiAtLS0KPgo+IE9LLCBmaXJzdCBvZiBhbGwgLS0gdG8gd2hvZXZlciB0aG91Z2h0IHRoYXQgYmlu
ZGluZyBzaW5nbGUgbGF5ZXJzIG9mIGEgM2QKPiBpbWFnZSBhbmQgdGVsbGluZyB0aGUgc2hhZGVy
IHRoZXkgd2VyZSByZWd1bGFyIDJkIGltYWdlcyB3YXMgYSBnb29kIGlkZWEgLS0KPiBJIGRpc2Fn
cmVlLgo+Cj4gVGhpcyBjaGFuZ2UgZmVlbHMgc3VwZXIgc3VwZXIgZGlydHksIGJ1dCBJIGhvbmVz
dGx5IGRvbid0IHNlZSBhIG1hdGVyaWFsbHkKPiBjbGVhbmVyIHdheSBvZiBoYW5kbGluZyBpdC4g
SW5zdGVhZCBvZiBiZWluZyBhYmxlIHRvIHJldXNlIHRoZSBPT0IKPiBoYW5kbGluZywgaXQncyBw
dXQgaW4gd2l0aCB0aGUgY29vcmQgcHJvY2Vzc2luZyAoISksIGFuZCB0aGUgc3VyZmFjZQo+IGNv
bnZlcnNpb24gZnVuY3Rpb24gaXMgc2VyaW91c2x5IGhhY2tlZCB1cC4KPgo+IEJ1dCBzcGxpdHRp
bmcgaXQgdXAgaXMgaGFyZGVyLCBzaW5jZSBhIGxvdCBvZiBpbmZvcm1hdGlvbiBoYXMgdG8gZmxv
dwo+IGZyb20gc3RhZ2UgdG8gc3RhZ2UsIGxpa2Ugd2hlbiB0byBkbyB3aGF0IGtpbmQgb2YgYWNj
ZXNzLCBhbmQgY2xvbmluZwo+IHRoZSBzdXJmYWNlIG9wIGlzIG11Y2ggZWFzaWVyIGluIHRoZSBj
b29yZCBwcm9jZXNzaW5nIHN0YWdlLgo+Cj4gIC4uLi9ub3V2ZWF1L2NvZGVnZW4vbnY1MF9pcl9l
bWl0X2dtMTA3LmNwcCAgICB8ICAzNCArKy0KPiAgLi4uL25vdXZlYXUvY29kZWdlbi9udjUwX2ly
X2xvd2VyaW5nX252YzAuY3BwIHwgMjA2ICsrKysrKysrKysrKystLS0tLQo+ICAuLi4vbm91dmVh
dS9jb2RlZ2VuL252NTBfaXJfbG93ZXJpbmdfbnZjMC5oICAgfCAgIDQgKy0KPiAgc3JjL2dhbGxp
dW0vZHJpdmVycy9ub3V2ZWF1L252YzAvbnZjMF90ZXguYyAgIHwgIDEwICstCj4gIDQgZmlsZXMg
Y2hhbmdlZCwgMjAxIGluc2VydGlvbnMoKyksIDUzIGRlbGV0aW9ucygtKQo+Cj4gZGlmZiAtLWdp
dCBhL3NyYy9nYWxsaXVtL2RyaXZlcnMvbm91dmVhdS9jb2RlZ2VuL252NTBfaXJfZW1pdF9nbTEw
Ny5jcHAgYi9zcmMvZ2FsbGl1bS9kcml2ZXJzL25vdXZlYXUvY29kZWdlbi9udjUwX2lyX2VtaXRf
Z20xMDcuY3BwCj4gaW5kZXggNmVlZmU4ZjAwMjUuLmUyNDRiZDBkNjEwIDEwMDY0NAo+IC0tLSBh
L3NyYy9nYWxsaXVtL2RyaXZlcnMvbm91dmVhdS9jb2RlZ2VuL252NTBfaXJfZW1pdF9nbTEwNy5j
cHAKPiArKysgYi9zcmMvZ2FsbGl1bS9kcml2ZXJzL25vdXZlYXUvY29kZWdlbi9udjUwX2lyX2Vt
aXRfZ20xMDcuY3BwCj4gQEAgLTEyMiw2ICsxMjIsOCBAQCBwcml2YXRlOgo+ICAgICB2b2lkIGVt
aXRTQU0oKTsKPiAgICAgdm9pZCBlbWl0UkFNKCk7Cj4KPiArICAgdm9pZCBlbWl0UFNFVFAoKTsK
PiArCj4gICAgIHZvaWQgZW1pdE1PVigpOwo+ICAgICB2b2lkIGVtaXRTMlIoKTsKPiAgICAgdm9p
ZCBlbWl0Q1MyUigpOwo+IEBAIC02OTAsNiArNjkyLDMxIEBAIENvZGVFbWl0dGVyR00xMDc6OmVt
aXRSQU0oKQo+ICAgKiBwcmVkaWNhdGUvY2MKPiAgICoqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KPgo+
ICt2b2lkCj4gK0NvZGVFbWl0dGVyR00xMDc6OmVtaXRQU0VUUCgpCj4gK3sKPiArCj4gKyAgIGVt
aXRJbnNuKDB4NTA5MDAwMDApOwo+ICsKPiArICAgc3dpdGNoIChpbnNuLT5vcCkgewo+ICsgICBj
YXNlIE9QX0FORDogZW1pdEZpZWxkKDB4MTgsIDMsIDApOyBicmVhazsKPiArICAgY2FzZSBPUF9P
UjogIGVtaXRGaWVsZCgweDE4LCAzLCAxKTsgYnJlYWs7Cj4gKyAgIGNhc2UgT1BfWE9SOiBlbWl0
RmllbGQoMHgxOCwgMywgMik7IGJyZWFrOwo+ICsgICBkZWZhdWx0Ogo+ICsgICAgICBhc3NlcnQo
ISJ1bmV4cGVjdGVkIG9wZXJhdGlvbiIpOwo+ICsgICAgICBicmVhazsKPiArICAgfQo+ICsKPiAr
ICAgLy8gZW1pdElOViAoMHgyYSk7Cj4gKyAgIGVtaXRQUkVEKDB4MjcpOyAvLyBUT0RPOiBzdXBw
b3J0IDMtYXJnCj4gKyAgIGVtaXRJTlYgKDB4MjAsIGluc24tPnNyYygxKSk7Cj4gKyAgIGVtaXRQ
UkVEKDB4MWQsIGluc24tPnNyYygxKSk7Cj4gKyAgIGVtaXRJTlYgKDB4MGYsIGluc24tPnNyYygw
KSk7Cj4gKyAgIGVtaXRQUkVEKDB4MGMsIGluc24tPnNyYygwKSk7Cj4gKyAgIGVtaXRQUkVEKDB4
MDMsIGluc24tPmRlZigwKSk7Cj4gKyAgIGVtaXRQUkVEKDB4MDApOwo+ICt9Cj4gKwo+ICAvKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKgo+ICAgKiBtb3ZlbWVudCAvIGNvbnZlcnNpb24KPiAgICoqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKi8KPiBAQCAtMzU1Nyw3ICszNTg0LDEyIEBAIENvZGVFbWl0dGVyR00x
MDc6OmVtaXRJbnN0cnVjdGlvbihJbnN0cnVjdGlvbiAqaSkKPiAgICAgY2FzZSBPUF9BTkQ6Cj4g
ICAgIGNhc2UgT1BfT1I6Cj4gICAgIGNhc2UgT1BfWE9SOgo+IC0gICAgICBlbWl0TE9QKCk7Cj4g
KyAgICAgIHN3aXRjaCAoaW5zbi0+ZGVmKDApLmdldEZpbGUoKSkgewo+ICsgICAgICBjYXNlIEZJ
TEVfR1BSOiBlbWl0TE9QKCk7IGJyZWFrOwo+ICsgICAgICBjYXNlIEZJTEVfUFJFRElDQVRFOiBl
bWl0UFNFVFAoKTsgYnJlYWs7Cj4gKyAgICAgIGRlZmF1bHQ6Cj4gKyAgICAgICAgIGFzc2VydCgh
ImludmFsaWQgYm9vbCBvcCIpOwo+ICsgICAgICB9Cj4gICAgICAgIGJyZWFrOwo+ICAgICBjYXNl
IE9QX05PVDoKPiAgICAgICAgZW1pdE5PVCgpOwo+IGRpZmYgLS1naXQgYS9zcmMvZ2FsbGl1bS9k
cml2ZXJzL25vdXZlYXUvY29kZWdlbi9udjUwX2lyX2xvd2VyaW5nX252YzAuY3BwIGIvc3JjL2dh
bGxpdW0vZHJpdmVycy9ub3V2ZWF1L2NvZGVnZW4vbnY1MF9pcl9sb3dlcmluZ19udmMwLmNwcAo+
IGluZGV4IDFmNzAyYTk4N2Q4Li4wZjY4YTlhMjI5ZiAxMDA2NDQKPiAtLS0gYS9zcmMvZ2FsbGl1
bS9kcml2ZXJzL25vdXZlYXUvY29kZWdlbi9udjUwX2lyX2xvd2VyaW5nX252YzAuY3BwCj4gKysr
IGIvc3JjL2dhbGxpdW0vZHJpdmVycy9ub3V2ZWF1L2NvZGVnZW4vbnY1MF9pcl9sb3dlcmluZ19u
dmMwLmNwcAo+IEBAIC0xODAyLDYgKzE4MDIsOSBAQCBOVkMwTG93ZXJpbmdQYXNzOjpsb2FkU3VJ
bmZvMzIoVmFsdWUgKnB0ciwgaW50IHNsb3QsIHVpbnQzMl90IG9mZiwgYm9vbCBiaW5kbGVzcwo+
ICB7Cj4gICAgIHVpbnQzMl90IGJhc2UgPSBzbG90ICogTlZDMF9TVV9JTkZPX19TVFJJREU7Cj4K
PiArICAgLy8gV2UgZG9uJ3QgdXBsb2FkIHN1cmZhY2UgaW5mbyBmb3IgYmluZGxlc3MgZm9yIEdN
MTA3Kwo+ICsgICBhc3NlcnQoIWJpbmRsZXNzIHx8IHRhcmctPmdldENoaXBzZXQoKSA8IE5WSVNB
X0dNMTA3X0NISVBTRVQpOwo+ICsKPiAgICAgaWYgKHB0cikgewo+ICAgICAgICBwdHIgPSBibGQu
bWtPcDJ2KE9QX0FERCwgVFlQRV9VMzIsIGJsZC5nZXRTU0EoKSwgcHRyLCBibGQubWtJbW0oc2xv
dCkpOwo+ICAgICAgICBpZiAoYmluZGxlc3MpCj4gQEAgLTIyMDQsNyArMjIwNyw3IEBAIGdldERl
c3RUeXBlKGNvbnN0IEltZ1R5cGUgdHlwZSkgewo+ICB9Cj4KPiAgdm9pZAo+IC1OVkMwTG93ZXJp
bmdQYXNzOjpjb252ZXJ0U3VyZmFjZUZvcm1hdChUZXhJbnN0cnVjdGlvbiAqc3UpCj4gK05WQzBM
b3dlcmluZ1Bhc3M6OmNvbnZlcnRTdXJmYWNlRm9ybWF0KFRleEluc3RydWN0aW9uICpzdSwgSW5z
dHJ1Y3Rpb24gKipsb2FkZWQpCj4gIHsKPiAgICAgY29uc3QgVGV4SW5zdHJ1Y3Rpb246OkltZ0Zv
cm1hdERlc2MgKmZvcm1hdCA9IHN1LT50ZXguZm9ybWF0Owo+ICAgICBpbnQgd2lkdGggPSBmb3Jt
YXQtPmJpdHNbMF0gKyBmb3JtYXQtPmJpdHNbMV0gKwo+IEBAIC0yMjIzLDIxICsyMjI2LDM4IEBA
IE5WQzBMb3dlcmluZ1Bhc3M6OmNvbnZlcnRTdXJmYWNlRm9ybWF0KFRleEluc3RydWN0aW9uICpz
dSkKPiAgICAgaWYgKHdpZHRoIDwgMzIpCj4gICAgICAgIHVudHlwZWREc3RbMF0gPSBibGQuZ2V0
U1NBKCk7Cj4KPiAtICAgZm9yIChpbnQgaSA9IDA7IGkgPCA0OyBpKyspIHsKPiAtICAgICAgdHlw
ZWREc3RbaV0gPSBzdS0+Z2V0RGVmKGkpOwo+ICsgICBpZiAobG9hZGVkICYmIGxvYWRlZFswXSkg
ewo+ICsgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDQ7IGkrKykgewo+ICsgICAgICAgICBpZiAo
bG9hZGVkW2ldKQo+ICsgICAgICAgICAgICB0eXBlZERzdFtpXSA9IGxvYWRlZFtpXS0+Z2V0RGVm
KDApOwo+ICsgICAgICB9Cj4gKyAgIH0gZWxzZSB7Cj4gKyAgICAgIGZvciAoaW50IGkgPSAwOyBp
IDwgNDsgaSsrKSB7Cj4gKyAgICAgICAgIHR5cGVkRHN0W2ldID0gc3UtPmdldERlZihpKTsKPiAr
ICAgICAgfQo+ICAgICB9Cj4KPiAgICAgLy8gU2V0IHRoZSB1bnR5cGVkIGRzdHMgYXMgdGhlIHN1
J3MgZGVzdGluYXRpb25zCj4gLSAgIGZvciAoaW50IGkgPSAwOyBpIDwgNDsgaSsrKQo+IC0gICAg
ICBzdS0+c2V0RGVmKGksIHVudHlwZWREc3RbaV0pOwo+ICsgICBpZiAobG9hZGVkICYmIGxvYWRl
ZFswXSkgewo+ICsgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDQ7IGkrKykKPiArICAgICAgICAg
aWYgKGxvYWRlZFtpXSkKPiArICAgICAgICAgICAgbG9hZGVkW2ldLT5zZXREZWYoMCwgdW50eXBl
ZERzdFtpXSk7Cj4gKyAgIH0gZWxzZSB7Cj4gKyAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNDsg
aSsrKQo+ICsgICAgICAgICBzdS0+c2V0RGVmKGksIHVudHlwZWREc3RbaV0pOwo+Cj4gLSAgIGJs
ZC5zZXRQb3NpdGlvbihzdSwgdHJ1ZSk7Cj4gKyAgICAgIGJsZC5zZXRQb3NpdGlvbihzdSwgdHJ1
ZSk7Cj4gKyAgIH0KPgo+ICAgICAvLyBVbnBhY2sgZWFjaCBjb21wb25lbnQgaW50byB0aGUgdHlw
ZWQgZHN0cwo+ICAgICBpbnQgYml0cyA9IDA7Cj4gICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNDsg
Yml0cyArPSBmb3JtYXQtPmJpdHNbaV0sIGkrKykgewo+ICAgICAgICBpZiAoIXR5cGVkRHN0W2ld
KQo+ICAgICAgICAgICBjb250aW51ZTsKPiArCj4gKyAgICAgIGlmIChsb2FkZWQgJiYgbG9hZGVk
WzBdKQo+ICsgICAgICAgICBibGQuc2V0UG9zaXRpb24obG9hZGVkW2ldLCB0cnVlKTsKPiArCj4g
ICAgICAgIGlmIChpID49IGZvcm1hdC0+Y29tcG9uZW50cykgewo+ICAgICAgICAgICBpZiAoZm9y
bWF0LT50eXBlID09IEZMT0FUIHx8Cj4gICAgICAgICAgICAgICBmb3JtYXQtPnR5cGUgPT0gVU5P
Uk0gfHwKPiBAQCAtMjMwOCw3ICsyMzI4LDcgQEAgTlZDMExvd2VyaW5nUGFzczo6aGFuZGxlU3Vy
ZmFjZU9wTlZFNChUZXhJbnN0cnVjdGlvbiAqc3UpCj4gICAgIHByb2Nlc3NTdXJmYWNlQ29vcmRz
TlZFNChzdSk7Cj4KPiAgICAgaWYgKHN1LT5vcCA9PSBPUF9TVUxEUCkgewo+IC0gICAgICBjb252
ZXJ0U3VyZmFjZUZvcm1hdChzdSk7Cj4gKyAgICAgIGNvbnZlcnRTdXJmYWNlRm9ybWF0KHN1LCBO
VUxMKTsKPiAgICAgICAgaW5zZXJ0T09CU3VyZmFjZU9wUmVzdWx0KHN1KTsKPiAgICAgfQo+Cj4g
QEAgLTI0MjEsNyArMjQ0MSw3IEBAIE5WQzBMb3dlcmluZ1Bhc3M6OmhhbmRsZVN1cmZhY2VPcE5W
QzAoVGV4SW5zdHJ1Y3Rpb24gKnN1KQo+ICAgICBwcm9jZXNzU3VyZmFjZUNvb3Jkc05WQzAoc3Up
Owo+Cj4gICAgIGlmIChzdS0+b3AgPT0gT1BfU1VMRFApIHsKPiAtICAgICAgY29udmVydFN1cmZh
Y2VGb3JtYXQoc3UpOwo+ICsgICAgICBjb252ZXJ0U3VyZmFjZUZvcm1hdChzdSwgTlVMTCk7Cj4g
ICAgICAgIGluc2VydE9PQlN1cmZhY2VPcFJlc3VsdChzdSk7Cj4gICAgIH0KPgo+IEBAIC0yNDYz
LDE0ICsyNDgzLDE2IEBAIE5WQzBMb3dlcmluZ1Bhc3M6OmhhbmRsZVN1cmZhY2VPcE5WQzAoVGV4
SW5zdHJ1Y3Rpb24gKnN1KQo+ICAgICB9Cj4gIH0KPgo+IC12b2lkCj4gLU5WQzBMb3dlcmluZ1Bh
c3M6OnByb2Nlc3NTdXJmYWNlQ29vcmRzR00xMDcoVGV4SW5zdHJ1Y3Rpb24gKnN1KQo+ICtUZXhJ
bnN0cnVjdGlvbiAqCj4gK05WQzBMb3dlcmluZ1Bhc3M6OnByb2Nlc3NTdXJmYWNlQ29vcmRzR00x
MDcoVGV4SW5zdHJ1Y3Rpb24gKnN1LCBJbnN0cnVjdGlvbiAqcmV0WzRdKQo+ICB7Cj4gICAgIGNv
bnN0IGludCBzbG90ID0gc3UtPnRleC5yOwo+ICAgICBjb25zdCBpbnQgZGltID0gc3UtPnRleC50
YXJnZXQuZ2V0RGltKCk7Cj4gLSAgIGNvbnN0IGludCBhcmcgPSBkaW0gKyAoc3UtPnRleC50YXJn
ZXQuaXNBcnJheSgpIHx8IHN1LT50ZXgudGFyZ2V0LmlzQ3ViZSgpKTsKPiArICAgY29uc3QgYm9v
bCBhcnJheSA9IHN1LT50ZXgudGFyZ2V0LmlzQXJyYXkoKSB8fCBzdS0+dGV4LnRhcmdldC5pc0N1
YmUoKTsKPiArICAgY29uc3QgaW50IGFyZyA9IGRpbSArIGFycmF5Owo+ICAgICBWYWx1ZSAqaW5k
ID0gc3UtPmdldEluZGlyZWN0UigpOwo+ICAgICBWYWx1ZSAqaGFuZGxlOwo+ICsgICBJbnN0cnVj
dGlvbiAqcHJlZCA9IE5VTEwsICpwcmVkMmQgPSBOVUxMOwo+ICAgICBpbnQgcG9zID0gMDsKPgo+
ICAgICBibGQuc2V0UG9zaXRpb24oc3UsIGZhbHNlKTsKPiBAQCAtMjQ4OSw2NyArMjUxMSwxNTMg
QEAgTlZDMExvd2VyaW5nUGFzczo6cHJvY2Vzc1N1cmZhY2VDb29yZHNHTTEwNyhUZXhJbnN0cnVj
dGlvbiAqc3UpCj4gICAgICAgIGFzc2VydChwb3MgPT0gMCk7Cj4gICAgICAgIGJyZWFrOwo+ICAg
ICB9Cj4gKwo+ICsgICBpZiAoZGltID09IDIgJiYgIWFycmF5KSB7Cj4gKyAgICAgIC8vIFRoaXMg
bWlnaHQgYmUgYSAyZCBzbGljZSBvZiBhIDNkIHRleHR1cmUsIHRyeSB0byBsb2FkIHRoZSB6Cj4g
KyAgICAgIC8vIGNvb3JkaW5hdGUgaW4uCj4gKyAgICAgIFZhbHVlICp2Owo+ICsgICAgICBpZiAo
IXN1LT50ZXguYmluZGxlc3MpCj4gKyAgICAgICAgIHYgPSBsb2FkU3VJbmZvMzIoaW5kLCBzbG90
LCBOVkMwX1NVX0lORk9fVU5LMUMsIHN1LT50ZXguYmluZGxlc3MpOwo+ICsgICAgICBlbHNlCj4g
KyAgICAgICAgIHYgPSBibGQubWtPcDJ2KE9QX1NIUiwgVFlQRV9VMzIsIGJsZC5nZXRTU0EoKSwg
aW5kLCBibGQubWtJbW0oMTEpKTsKPiArICAgICAgVmFsdWUgKmlzXzNkID0gYmxkLm1rT3AydihP
UF9BTkQsIFRZUEVfVTMyLCBibGQuZ2V0U1NBKCksIHYsIGJsZC5ta0ltbSgxKSk7Cj4gKyAgICAg
IHByZWQyZCA9IGJsZC5ta0NtcChPUF9TRVQsIENDX0VRLCBUWVBFX1UzMiwgYmxkLmdldFNTQSgx
LCBGSUxFX1BSRURJQ0FURSksCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICBUWVBFX1UzMiwg
YmxkLm1rSW1tKDApLCBpc18zZCk7Cj4gKwo+ICsgICAgICBibGQubWtPcDIoT1BfU0hSLCBUWVBF
X1UzMiwgdiwgdiwgYmxkLmxvYWRJbW0oTlVMTCwgMTYpKTsKPiArICAgICAgc3UtPm1vdmVTb3Vy
Y2VzKGRpbSwgMSk7Cj4gKyAgICAgIHN1LT5zZXRTcmMoZGltLCB2KTsKPiArICAgICAgc3UtPnRl
eC50YXJnZXQgPSBudjUwX2lyOjpURVhfVEFSR0VUXzNEOwo+ICsgICAgICBwb3MrKzsKPiArICAg
fQo+ICsKPiAgICAgaWYgKHN1LT50ZXguYmluZGxlc3MpCj4gICAgICAgIGhhbmRsZSA9IGluZDsK
PiAgICAgZWxzZQo+ICAgICAgICBoYW5kbGUgPSBsb2FkVGV4SGFuZGxlKGluZCwgc2xvdCArIDMy
KTsKPiArCj4gICAgIHN1LT5zZXRTcmMoYXJnICsgcG9zLCBoYW5kbGUpOwo+Cj4gICAgIC8vIFRo
ZSBhZGRyZXNzIGNoZWNrIGRvZXNuJ3QgbWFrZSBzZW5zZSBoZXJlLiBUaGUgZm9ybWF0IGNoZWNr
IGNvdWxkIG1ha2UKPiAgICAgLy8gc2Vuc2UgYnV0IGl0J3MgYSBiaXQgb2YgYSBwYWluLgo+IC0g
ICBpZiAoc3UtPnRleC5iaW5kbGVzcykKPiAtICAgICAgcmV0dXJuOwo+ICsgICBpZiAoIXN1LT50
ZXguYmluZGxlc3MpIHsKPiArICAgICAgLy8gcHJldmVudCByZWFkIGZhdWx0IHdoZW4gdGhlIGlt
YWdlIGlzIG5vdCBhY3R1YWxseSBib3VuZAo+ICsgICAgICBwcmVkID0KPiArICAgICAgICAgYmxk
Lm1rQ21wKE9QX1NFVCwgQ0NfRVEsIFRZUEVfVTMyLCBibGQuZ2V0U1NBKDEsIEZJTEVfUFJFRElD
QVRFKSwKPiArICAgICAgICAgICAgICAgICAgIFRZUEVfVTMyLCBibGQubWtJbW0oMCksCj4gKyAg
ICAgICAgICAgICAgICAgICBsb2FkU3VJbmZvMzIoaW5kLCBzbG90LCBOVkMwX1NVX0lORk9fQURE
Uiwgc3UtPnRleC5iaW5kbGVzcykpOwo+ICsgICAgICBpZiAoc3UtPm9wICE9IE9QX1NVU1RQICYm
IHN1LT50ZXguZm9ybWF0KSB7Cj4gKyAgICAgICAgIGNvbnN0IFRleEluc3RydWN0aW9uOjpJbWdG
b3JtYXREZXNjICpmb3JtYXQgPSBzdS0+dGV4LmZvcm1hdDsKPiArICAgICAgICAgaW50IGJsb2Nr
d2lkdGggPSBmb3JtYXQtPmJpdHNbMF0gKyBmb3JtYXQtPmJpdHNbMV0gKwo+ICsgICAgICAgICAg
ICBmb3JtYXQtPmJpdHNbMl0gKyBmb3JtYXQtPmJpdHNbM107Cj4gKwo+ICsgICAgICAgICBhc3Nl
cnQoZm9ybWF0LT5jb21wb25lbnRzICE9IDApOwo+ICsgICAgICAgICAvLyBtYWtlIHN1cmUgdGhh
dCB0aGUgZm9ybWF0IGRvZXNuJ3QgbWlzbWF0Y2ggd2hlbiBpdCdzIG5vdCBGTVRfTk9ORQo+ICsg
ICAgICAgICBibGQubWtDbXAoT1BfU0VUX09SLCBDQ19ORSwgVFlQRV9VMzIsIHByZWQtPmdldERl
ZigwKSwKPiArICAgICAgICAgICAgICAgICAgIFRZUEVfVTMyLCBibGQubG9hZEltbShOVUxMLCBi
bG9ja3dpZHRoIC8gOCksCj4gKyAgICAgICAgICAgICAgICAgICBsb2FkU3VJbmZvMzIoaW5kLCBz
bG90LCBOVkMwX1NVX0lORk9fQlNJWkUsIHN1LT50ZXguYmluZGxlc3MpLAo+ICsgICAgICAgICAg
ICAgICAgICAgcHJlZC0+Z2V0RGVmKDApKTsKPiArICAgICAgfQo+ICsgICB9Cj4KPiAtICAgLy8g
cHJldmVudCByZWFkIGZhdWx0IHdoZW4gdGhlIGltYWdlIGlzIG5vdCBhY3R1YWxseSBib3VuZAo+
IC0gICBDbXBJbnN0cnVjdGlvbiAqcHJlZCA9Cj4gLSAgICAgIGJsZC5ta0NtcChPUF9TRVQsIEND
X0VRLCBUWVBFX1UzMiwgYmxkLmdldFNTQSgxLCBGSUxFX1BSRURJQ0FURSksCj4gLSAgICAgICAg
ICAgICAgICBUWVBFX1UzMiwgYmxkLm1rSW1tKDApLAo+IC0gICAgICAgICAgICAgICAgbG9hZFN1
SW5mbzMyKGluZCwgc2xvdCwgTlZDMF9TVV9JTkZPX0FERFIsIHN1LT50ZXguYmluZGxlc3MpKTsK
PiAtICAgaWYgKHN1LT5vcCAhPSBPUF9TVVNUUCAmJiBzdS0+dGV4LmZvcm1hdCkgewo+IC0gICAg
ICBjb25zdCBUZXhJbnN0cnVjdGlvbjo6SW1nRm9ybWF0RGVzYyAqZm9ybWF0ID0gc3UtPnRleC5m
b3JtYXQ7Cj4gLSAgICAgIGludCBibG9ja3dpZHRoID0gZm9ybWF0LT5iaXRzWzBdICsgZm9ybWF0
LT5iaXRzWzFdICsKPiAtICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQtPmJpdHNbMl0gKyBm
b3JtYXQtPmJpdHNbM107Cj4gKyAgIC8vIE5vdyB3ZSBoYXZlICJwcmVkIiB3aGljaCAob3B0aW9u
YWxseSkgY29udGFpbnMgd2hldGhlciB0byBkbyB0aGUgc3VyZmFjZQo+ICsgICAvLyBvcCBhdCBh
bGwsIGFuZCBhICJwcmVkMmQiIHdoaWNoIGluZGljYXRlcyB0aGF0LCBpbiBjYXNlIG9mIGRvaW5n
IHRoZQo+ICsgICAvLyBzdXJmYWNlIG9wLCB3ZSBoYXZlIHRvIGNyZWF0ZSBhIDJkIGFuZCAzZCB2
ZXJzaW9uLCBjb25kaXRpb25lZCBvbiBwcmVkMmQuCj4gKyAgIFRleEluc3RydWN0aW9uICpzdTJk
ID0gTlVMTDsKPiArICAgaWYgKHByZWQyZCkgewo+ICsgICAgICBzdTJkID0gY2xvbmVGb3J3YXJk
KGZ1bmMsIHN1KS0+YXNUZXgoKTsKPiArICAgICAgZm9yICh1bnNpZ25lZCBpID0gMDsgc3UtPmRl
ZkV4aXN0cyhpKTsgKytpKQo+ICsgICAgICAgICBzdTJkLT5zZXREZWYoaSwgYmxkLmdldFNTQSgp
KTsKPiArICAgICAgc3UyZC0+bW92ZVNvdXJjZXMoZGltICsgMSwgLTEpOwo+ICsgICAgICBzdTJk
LT50ZXgudGFyZ2V0ID0gbnY1MF9pcjo6VEVYX1RBUkdFVF8yRDsKPiArICAgfQo+ICsgICBpZiAo
cHJlZDJkICYmIHByZWQpIHsKPiArICAgICAgSW5zdHJ1Y3Rpb24gKnByZWQzZCA9IGJsZC5ta09w
MihPUF9BTkQsIFRZUEVfVTgsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgYmxkLmdldFNTQSgxLCBGSUxFX1BSRURJQ0FURSksCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcHJlZC0+Z2V0RGVmKDApLCBwcmVkMmQtPmdldERlZigwKSk7Cj4g
KyAgICAgIHByZWQzZC0+c3JjKDApLm1vZCA9IE1vZGlmaWVyKE5WNTBfSVJfTU9EX05PVCk7Cj4g
KyAgICAgIHByZWQzZC0+c3JjKDEpLm1vZCA9IE1vZGlmaWVyKE5WNTBfSVJfTU9EX05PVCk7Cj4g
KyAgICAgIHN1LT5zZXRQcmVkaWNhdGUoQ0NfUCwgcHJlZDNkLT5nZXREZWYoMCkpOwo+ICsgICAg
ICBwcmVkMmQgPSBibGQubWtPcDIoT1BfQU5ELCBUWVBFX1U4LCBibGQuZ2V0U1NBKDEsIEZJTEVf
UFJFRElDQVRFKSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgIHByZWQtPmdldERlZigwKSwg
cHJlZDJkLT5nZXREZWYoMCkpOwo+ICsgICAgICBwcmVkMmQtPnNyYygwKS5tb2QgPSBNb2RpZmll
cihOVjUwX0lSX01PRF9OT1QpOwo+ICsgICB9IGVsc2UgaWYgKHByZWQpIHsKPiArICAgICAgc3Ut
PnNldFByZWRpY2F0ZShDQ19OT1RfUCwgcHJlZC0+Z2V0RGVmKDApKTsKPiArICAgfSBlbHNlIGlm
IChwcmVkMmQpIHsKPiArICAgICAgc3UtPnNldFByZWRpY2F0ZShDQ19OT1RfUCwgcHJlZDJkLT5n
ZXREZWYoMCkpOwo+ICsgICB9Cj4gKyAgIGlmIChzdTJkKSB7Cj4gKyAgICAgIHN1MmQtPnNldFBy
ZWRpY2F0ZShDQ19QLCBwcmVkMmQtPmdldERlZigwKSk7Cj4gKyAgICAgIGJsZC5pbnNlcnQoc3Uy
ZCk7Cj4gKwo+ICsgICAgICAvLyBDcmVhdGUgYSBVTklPTiBzbyB0aGF0IFJBIGFzc2lnbnMgdGhl
IHNhbWUgcmVnaXN0ZXJzCj4gKyAgICAgIGJsZC5zZXRQb3NpdGlvbihzdSwgdHJ1ZSk7Cj4gKyAg
ICAgIGZvciAodW5zaWduZWQgaSA9IDA7IHN1LT5kZWZFeGlzdHMoaSk7ICsraSkgewo+ICsgICAg
ICAgICBhc3NlcnQoaSA8IDQpOwo+Cj4gLSAgICAgIGFzc2VydChmb3JtYXQtPmNvbXBvbmVudHMg
IT0gMCk7Cj4gLSAgICAgIC8vIG1ha2Ugc3VyZSB0aGF0IHRoZSBmb3JtYXQgZG9lc24ndCBtaXNt
YXRjaCB3aGVuIGl0J3Mgbm90IEZNVF9OT05FCj4gLSAgICAgIGJsZC5ta0NtcChPUF9TRVRfT1Is
IENDX05FLCBUWVBFX1UzMiwgcHJlZC0+Z2V0RGVmKDApLAo+IC0gICAgICAgICAgICAgICAgVFlQ
RV9VMzIsIGJsZC5sb2FkSW1tKE5VTEwsIGJsb2Nrd2lkdGggLyA4KSwKPiAtICAgICAgICAgICAg
ICAgIGxvYWRTdUluZm8zMihpbmQsIHNsb3QsIE5WQzBfU1VfSU5GT19CU0laRSwgc3UtPnRleC5i
aW5kbGVzcyksCj4gLSAgICAgICAgICAgICAgICBwcmVkLT5nZXREZWYoMCkpOwo+ICsgICAgICAg
ICBWYWx1ZURlZiAmZGVmID0gc3UtPmRlZihpKTsKPiArICAgICAgICAgVmFsdWVEZWYgJmRlZjIg
PSBzdTJkLT5kZWYoaSk7Cj4gKyAgICAgICAgIEluc3RydWN0aW9uICptb3YgPSBOVUxMOwo+ICsK
PiArICAgICAgICAgaWYgKHByZWQpIHsKPiArICAgICAgICAgICAgbW92ID0gYmxkLm1rTW92KGJs
ZC5nZXRTU0EoKSwgYmxkLmxvYWRJbW0oTlVMTCwgMCkpOwo+ICsgICAgICAgICAgICBtb3YtPnNl
dFByZWRpY2F0ZShDQ19QLCBwcmVkLT5nZXREZWYoMCkpOwo+ICsgICAgICAgICB9Cj4gKwo+ICsg
ICAgICAgICBJbnN0cnVjdGlvbiAqdW5pID0gcmV0W2ldID0gYmxkLm1rT3AyKE9QX1VOSU9OLCBU
WVBFX1UzMiwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibGQuZ2V0
U1NBKCksCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCwgZGVm
Mi5nZXQoKSk7Cj4gKyAgICAgICAgIGRlZi5yZXBsYWNlKHVuaS0+Z2V0RGVmKDApLCBmYWxzZSk7
Cj4gKyAgICAgICAgIHVuaS0+c2V0U3JjKDAsIGRlZi5nZXQoKSk7Cj4gKyAgICAgICAgIGlmICht
b3YpCj4gKyAgICAgICAgICAgIHVuaS0+c2V0U3JjKDIsIG1vdi0+Z2V0RGVmKDApKTsKPiArICAg
ICAgfQo+ICsgICB9IGVsc2UgaWYgKHByZWQpIHsKPiArICAgICAgLy8gQ3JlYXRlIGEgVU5JT04g
c28gdGhhdCBSQSBhc3NpZ25zIHRoZSBzYW1lIHJlZ2lzdGVycwo+ICsgICAgICBibGQuc2V0UG9z
aXRpb24oc3UsIHRydWUpOwo+ICsgICAgICBmb3IgKHVuc2lnbmVkIGkgPSAwOyBzdS0+ZGVmRXhp
c3RzKGkpOyArK2kpIHsKPiArICAgICAgICAgYXNzZXJ0KGkgPCA0KTsKPiArCj4gKyAgICAgICAg
IFZhbHVlRGVmICZkZWYgPSBzdS0+ZGVmKGkpOwo+ICsKPiArICAgICAgICAgSW5zdHJ1Y3Rpb24g
Km1vdiA9IGJsZC5ta01vdihibGQuZ2V0U1NBKCksIGJsZC5sb2FkSW1tKE5VTEwsIDApKTsKPiAr
ICAgICAgICAgbW92LT5zZXRQcmVkaWNhdGUoQ0NfUCwgcHJlZC0+Z2V0RGVmKDApKTsKPiArCj4g
KyAgICAgICAgIEluc3RydWN0aW9uICp1bmkgPSByZXRbaV0gPSBibGQubWtPcDIoT1BfVU5JT04s
IFRZUEVfVTMyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsZC5n
ZXRTU0EoKSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMLCBt
b3YtPmdldERlZigwKSk7Cj4gKyAgICAgICAgIGRlZi5yZXBsYWNlKHVuaS0+Z2V0RGVmKDApLCBm
YWxzZSk7Cj4gKyAgICAgICAgIHVuaS0+c2V0U3JjKDAsIGRlZi5nZXQoKSk7Cj4gKyAgICAgIH0K
PiAgICAgfQo+IC0gICBzdS0+c2V0UHJlZGljYXRlKENDX05PVF9QLCBwcmVkLT5nZXREZWYoMCkp
Owo+ICsKPiArICAgcmV0dXJuIHN1MmQ7Cj4gIH0KPgo+ICB2b2lkCj4gIE5WQzBMb3dlcmluZ1Bh
c3M6OmhhbmRsZVN1cmZhY2VPcEdNMTA3KFRleEluc3RydWN0aW9uICpzdSkKPiAgewo+IC0gICBw
cm9jZXNzU3VyZmFjZUNvb3Jkc0dNMTA3KHN1KTsKPiArICAgLy8gcHJvY2Vzc1N1cmZhY2VDb29y
ZHMgYWxzbyB0YWtlcyBjYXJlIG9mIGZpeGluZyB1cCB0aGUgb3V0cHV0cyBhbmQKPiArICAgLy8g
dW5pb24naW5nIHRoZW0gd2l0aCAwIGFzIG5lY2Vzc2FyeS4gQWRkaXRpb25hbGx5IGl0IG1heSBj
cmVhdGUgYSBzZWNvbmQKPiArICAgLy8gc3VyZmFjZSB3aGljaCBuZWVkcyBzb21lIG9mIHRoZSBz
aW1pbGFyIGZpeHVwcy4KPiArCj4gKyAgIEluc3RydWN0aW9uICpsb2FkZWRbNF0gPSB7fTsKPiAr
ICAgVGV4SW5zdHJ1Y3Rpb24gKnN1MiA9IHByb2Nlc3NTdXJmYWNlQ29vcmRzR00xMDcoc3UsIGxv
YWRlZCk7Cj4KPiAgICAgaWYgKHN1LT5vcCA9PSBPUF9TVUxEUCkgewo+IC0gICAgICBjb252ZXJ0
U3VyZmFjZUZvcm1hdChzdSk7Cj4gLSAgICAgIGluc2VydE9PQlN1cmZhY2VPcFJlc3VsdChzdSk7
Cj4gKyAgICAgIGNvbnZlcnRTdXJmYWNlRm9ybWF0KHN1LCBsb2FkZWQpOwo+ICAgICB9Cj4KPiAg
ICAgaWYgKHN1LT5vcCA9PSBPUF9TVVJFRFApIHsKPiAtICAgICAgVmFsdWUgKmRlZiA9IHN1LT5n
ZXREZWYoMCk7Cj4gLQo+ICAgICAgICBzdS0+b3AgPSBPUF9TVVJFREI7Cj4gKyAgIH0KPgo+IC0g
ICAgICAvLyBUaGVyZSBtYXkgbm90IGJlIGEgcHJlZGljYXRlIGluIHRoZSBiaW5kbGVzcyBjYXNl
Lgo+IC0gICAgICBpZiAoc3UtPmdldFByZWRpY2F0ZSgpKSB7Cj4gLSAgICAgICAgIHN1LT5zZXRE
ZWYoMCwgYmxkLmdldFNTQSgpKTsKPiAtCj4gLSAgICAgICAgIGJsZC5zZXRQb3NpdGlvbihzdSwg
dHJ1ZSk7Cj4gLQo+IC0gICAgICAgICAvLyBtYWtlIHN1cmUgdG8gaW5pdGlhbGl6ZSBkc3QgdmFs
dWUgd2hlbiB0aGUgYXRvbWljIG9wZXJhdGlvbiBpcyBub3QKPiAtICAgICAgICAgLy8gcGVyZm9y
bWVkCj4gLSAgICAgICAgIEluc3RydWN0aW9uICptb3YgPSBibGQubWtNb3YoYmxkLmdldFNTQSgp
LCBibGQubG9hZEltbShOVUxMLCAwKSk7Cj4gLQo+IC0gICAgICAgICBhc3NlcnQoc3UtPmNjID09
IENDX05PVF9QKTsKPiAtICAgICAgICAgbW92LT5zZXRQcmVkaWNhdGUoQ0NfUCwgc3UtPmdldFBy
ZWRpY2F0ZSgpKTsKPiAtCj4gLSAgICAgICAgIGJsZC5ta09wMihPUF9VTklPTiwgVFlQRV9VMzIs
IGRlZiwgc3UtPmdldERlZigwKSwgbW92LT5nZXREZWYoMCkpOwo+IC0gICAgICB9Cj4gKyAgIC8v
IElmIHdlIGZpeGVkIHVwIHRoZSB0eXBlIG9mIHRoZSByZWd1bGFyIHN1cmZhY2UgbG9hZCBpbnN0
cnVjdGlvbiwgd2UgYWxzbwo+ICsgICAvLyBoYXZlIHRvIGZpeCB1cCB0aGUgY29weS4KPiArICAg
aWYgKHN1Mikgewo+ICsgICAgICBzdTItPm9wID0gc3UtPm9wOwo+ICsgICAgICBzdTItPmRUeXBl
ID0gc3UtPmRUeXBlOwo+ICsgICAgICBzdTItPnNUeXBlID0gc3UtPnNUeXBlOwo+ICAgICB9Cj4g
IH0KPgo+IGRpZmYgLS1naXQgYS9zcmMvZ2FsbGl1bS9kcml2ZXJzL25vdXZlYXUvY29kZWdlbi9u
djUwX2lyX2xvd2VyaW5nX252YzAuaCBiL3NyYy9nYWxsaXVtL2RyaXZlcnMvbm91dmVhdS9jb2Rl
Z2VuL252NTBfaXJfbG93ZXJpbmdfbnZjMC5oCj4gaW5kZXggMGNlMmE0YjgwZjguLmI0YzQwNWE5
ZWE1IDEwMDY0NAo+IC0tLSBhL3NyYy9nYWxsaXVtL2RyaXZlcnMvbm91dmVhdS9jb2RlZ2VuL252
NTBfaXJfbG93ZXJpbmdfbnZjMC5oCj4gKysrIGIvc3JjL2dhbGxpdW0vZHJpdmVycy9ub3V2ZWF1
L2NvZGVnZW4vbnY1MF9pcl9sb3dlcmluZ19udmMwLmgKPiBAQCAtMTcxLDEwICsxNzEsMTAgQEAg
cHJpdmF0ZToKPiAgICAgVmFsdWUgKmxvYWRNc0luZm8zMihWYWx1ZSAqcHRyLCB1aW50MzJfdCBv
ZmYpOwo+Cj4gICAgIHZvaWQgYWRqdXN0Q29vcmRpbmF0ZXNNUyhUZXhJbnN0cnVjdGlvbiAqKTsK
PiAtICAgdm9pZCBwcm9jZXNzU3VyZmFjZUNvb3Jkc0dNMTA3KFRleEluc3RydWN0aW9uICopOwo+
ICsgICBUZXhJbnN0cnVjdGlvbiAqcHJvY2Vzc1N1cmZhY2VDb29yZHNHTTEwNyhUZXhJbnN0cnVj
dGlvbiAqLCBJbnN0cnVjdGlvbiAqWzRdKTsKPiAgICAgdm9pZCBwcm9jZXNzU3VyZmFjZUNvb3Jk
c05WRTQoVGV4SW5zdHJ1Y3Rpb24gKik7Cj4gICAgIHZvaWQgcHJvY2Vzc1N1cmZhY2VDb29yZHNO
VkMwKFRleEluc3RydWN0aW9uICopOwo+IC0gICB2b2lkIGNvbnZlcnRTdXJmYWNlRm9ybWF0KFRl
eEluc3RydWN0aW9uICopOwo+ICsgICB2b2lkIGNvbnZlcnRTdXJmYWNlRm9ybWF0KFRleEluc3Ry
dWN0aW9uICosIEluc3RydWN0aW9uICoqKTsKPiAgICAgdm9pZCBpbnNlcnRPT0JTdXJmYWNlT3BS
ZXN1bHQoVGV4SW5zdHJ1Y3Rpb24gKik7Cj4gICAgIFZhbHVlICpjYWxjdWxhdGVTYW1wbGVPZmZz
ZXQoVmFsdWUgKnNhbXBsZUlEKTsKPgo+IGRpZmYgLS1naXQgYS9zcmMvZ2FsbGl1bS9kcml2ZXJz
L25vdXZlYXUvbnZjMC9udmMwX3RleC5jIGIvc3JjL2dhbGxpdW0vZHJpdmVycy9ub3V2ZWF1L252
YzAvbnZjMF90ZXguYwo+IGluZGV4IGY2MmU1MDgyNThiLi40OTQ4YThmNGNlYSAxMDA2NDQKPiAt
LS0gYS9zcmMvZ2FsbGl1bS9kcml2ZXJzL25vdXZlYXUvbnZjMC9udmMwX3RleC5jCj4gKysrIGIv
c3JjL2dhbGxpdW0vZHJpdmVycy9ub3V2ZWF1L252YzAvbnZjMF90ZXguYwo+IEBAIC0xNDMzLDcg
KzE0MzMsMTUgQEAgZ20xMDdfY3JlYXRlX2ltYWdlX2hhbmRsZShzdHJ1Y3QgcGlwZV9jb250ZXh0
ICpwaXBlLAo+Cj4gICAgIG52YzAtPnNjcmVlbi0+dGljLmxvY2tbdGljLT5pZCAvIDMyXSB8PSAx
IDw8ICh0aWMtPmlkICUgMzIpOwo+Cj4gLSAgIHJldHVybiAweDEwMDAwMDAwMFVMTCB8IHRpYy0+
aWQ7Cj4gKyAgIC8vIENvbXB1dGUgaGFuZGxlLiBUaGlzIHdpbGwgaW5jbHVkZSB0aGUgVElDIGFz
IHdlbGwgYXMgc29tZSBhZGRpdGlvbmFsCj4gKyAgIC8vIGluZm8gcmVnYXJkaW5nIHRoZSBib3Vu
ZCAzZCBzdXJmYWNlIGxheWVyLCBpZiBhcHBsaWNhYmxlLgo+ICsgICB1aW50NjRfdCBoYW5kbGUg
PSAweDEwMDAwMDAwMFVMTCB8IHRpYy0+aWQ7Cj4gKyAgIHN0cnVjdCBudjA0X3Jlc291cmNlICpy
ZXMgPSBudjA0X3Jlc291cmNlKHZpZXctPnJlc291cmNlKTsKPiArICAgaWYgKHJlcy0+YmFzZS50
YXJnZXQgPT0gUElQRV9URVhUVVJFXzNEKSB7Cj4gKyAgICAgIGhhbmRsZSB8PSAxIDw8IDExOwo+
ICsgICAgICBoYW5kbGUgfD0gdmlldy0+dS50ZXguZmlyc3RfbGF5ZXIgPDwgKDExICsgMTYpOwo+
ICsgICB9Cj4gKyAgIHJldHVybiBoYW5kbGU7Cj4KPiAgZmFpbDoKPiAgICAgRlJFRSh0aWMpOwo+
IC0tCj4gMi4yMS4wCj4KPiBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwo+IE5vdXZlYXUgbWFpbGluZyBsaXN0Cj4gTm91dmVhdUBsaXN0cy5mcmVlZGVza3Rv
cC5vcmcKPiBodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL25v
dXZlYXUKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCk5v
dXZlYXUgbWFpbGluZyBsaXN0Ck5vdXZlYXVAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8v
bGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vbm91dmVhdQ==
