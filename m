Return-Path: <nouveau-bounces@lists.freedesktop.org>
X-Original-To: lists+nouveau@lfdr.de
Delivered-To: lists+nouveau@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id BED07568DB
	for <lists+nouveau@lfdr.de>; Wed, 26 Jun 2019 14:27:57 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 04A9C6E3CE;
	Wed, 26 Jun 2019 12:27:56 +0000 (UTC)
X-Original-To: nouveau@lists.freedesktop.org
Delivered-To: nouveau@lists.freedesktop.org
Received: from bombadil.infradead.org (bombadil.infradead.org
 [IPv6:2607:7c80:54:e::133])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E21876E3CE;
 Wed, 26 Jun 2019 12:27:54 +0000 (UTC)
Received: from clnet-p19-102.ikbnet.co.at ([83.175.77.102] helo=localhost)
 by bombadil.infradead.org with esmtpsa (Exim 4.92 #3 (Red Hat Linux))
 id 1hg71e-0001MX-8g; Wed, 26 Jun 2019 12:27:46 +0000
From: Christoph Hellwig <hch@lst.de>
To: Dan Williams <dan.j.williams@intel.com>,
 =?UTF-8?q?J=C3=A9r=C3=B4me=20Glisse?= <jglisse@redhat.com>,
 Jason Gunthorpe <jgg@mellanox.com>, Ben Skeggs <bskeggs@redhat.com>
Date: Wed, 26 Jun 2019 14:27:06 +0200
Message-Id: <20190626122724.13313-8-hch@lst.de>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190626122724.13313-1-hch@lst.de>
References: <20190626122724.13313-1-hch@lst.de>
MIME-Version: 1.0
X-SRS-Rewrite: SMTP reverse-path rewritten from <hch@infradead.org> by
 bombadil.infradead.org. See http://www.infradead.org/rpr.html
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; 
 d=infradead.org; s=bombadil.20170209; h=Content-Transfer-Encoding:
 MIME-Version:References:In-Reply-To:Message-Id:Date:Subject:Cc:To:From:Sender
 :Reply-To:Content-Type:Content-ID:Content-Description:Resent-Date:Resent-From
 :Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Id:List-Help:
 List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=mt4+zc9IpSRPEzC4cMWHk/yq2yqrTYKLdoT+AMW6Qz8=; b=nIyI1gI2JcHVUXx+jXX71rKB3G
 /XpA3ZY5LzkiUTJN1oA3IOdt45tcLua2Uy9FyFVXuJC0c5X8BBMzJA41qG8Y99gIfd1C7GCe5DJJd
 Eh4lgGJ1X6o41RIhoOM0BBJxaETP/8Mj5RBgQ4DP+G9fpKqnG1rQdi0mwUTQbrIxb0bsPbFo13NwX
 3xAPRn8oGEMHUyvDW6xdgV80ocjOn88UacI1mjEwcsiAmQWvtKLIFqBidgTpW2fUibEQblL5U/xpS
 usb6ODdl6HifjRKkjVSSirZqtJMju39OzLvmokEvgVxm3ops4idZHit93FdxRmcFIOpreUIAMWn0V
 9GJBgs0A==;
Subject: [Nouveau] [PATCH 07/25] mm: factor out a
 devm_request_free_mem_region helper
X-BeenThere: nouveau@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Nouveau development list <nouveau.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/nouveau>
List-Post: <mailto:nouveau@lists.freedesktop.org>
List-Help: <mailto:nouveau-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-nvdimm@lists.01.org, linux-pci@vger.kernel.org,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 linux-mm@kvack.org, nouveau@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: nouveau-bounces@lists.freedesktop.org
Sender: "Nouveau" <nouveau-bounces@lists.freedesktop.org>

S2VlcCB0aGUgcGh5c2ljYWwgYWRkcmVzcyBhbGxvY2F0aW9uIHRoYXQgaG1tX2FkZF9kZXZpY2Ug
ZG9lcyB3aXRoIHRoZQpyZXN0IG9mIHRoZSByZXNvdXJjZSBjb2RlLCBhbmQgYWxsb3cgZnV0dXJl
IHJldXNlIG9mIGl0IHdpdGhvdXQgdGhlIGhtbQp3cmFwcGVyLgoKU2lnbmVkLW9mZi1ieTogQ2hy
aXN0b3BoIEhlbGx3aWcgPGhjaEBsc3QuZGU+ClJldmlld2VkLWJ5OiBKYXNvbiBHdW50aG9ycGUg
PGpnZ0BtZWxsYW5veC5jb20+ClJldmlld2VkLWJ5OiBKb2huIEh1YmJhcmQgPGpodWJiYXJkQG52
aWRpYS5jb20+Ci0tLQogaW5jbHVkZS9saW51eC9pb3BvcnQuaCB8ICAyICsrCiBrZXJuZWwvcmVz
b3VyY2UuYyAgICAgIHwgMzkgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
CiBtbS9obW0uYyAgICAgICAgICAgICAgIHwgMzMgKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCiAzIGZpbGVzIGNoYW5nZWQsIDQ1IGluc2VydGlvbnMoKyksIDI5IGRlbGV0aW9ucygt
KQoKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvaW9wb3J0LmggYi9pbmNsdWRlL2xpbnV4L2lv
cG9ydC5oCmluZGV4IGRkOTYxODgyYmM3NC4uYTAyYjI5MGNhMDhhIDEwMDY0NAotLS0gYS9pbmNs
dWRlL2xpbnV4L2lvcG9ydC5oCisrKyBiL2luY2x1ZGUvbGludXgvaW9wb3J0LmgKQEAgLTI4NSw2
ICsyODUsOCBAQCBzdGF0aWMgaW5saW5lIGJvb2wgcmVzb3VyY2Vfb3ZlcmxhcHMoc3RydWN0IHJl
c291cmNlICpyMSwgc3RydWN0IHJlc291cmNlICpyMikKICAgICAgICByZXR1cm4gKHIxLT5zdGFy
dCA8PSByMi0+ZW5kICYmIHIxLT5lbmQgPj0gcjItPnN0YXJ0KTsKIH0KIAorc3RydWN0IHJlc291
cmNlICpkZXZtX3JlcXVlc3RfZnJlZV9tZW1fcmVnaW9uKHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJ
c3RydWN0IHJlc291cmNlICpiYXNlLCB1bnNpZ25lZCBsb25nIHNpemUpOwogCiAjZW5kaWYgLyog
X19BU1NFTUJMWV9fICovCiAjZW5kaWYJLyogX0xJTlVYX0lPUE9SVF9IICovCmRpZmYgLS1naXQg
YS9rZXJuZWwvcmVzb3VyY2UuYyBiL2tlcm5lbC9yZXNvdXJjZS5jCmluZGV4IDE1OGYwNGVjMWQ0
Zi4uZDIyNDIzZTg1Y2Y4IDEwMDY0NAotLS0gYS9rZXJuZWwvcmVzb3VyY2UuYworKysgYi9rZXJu
ZWwvcmVzb3VyY2UuYwpAQCAtMTYyOCw2ICsxNjI4LDQ1IEBAIHZvaWQgcmVzb3VyY2VfbGlzdF9m
cmVlKHN0cnVjdCBsaXN0X2hlYWQgKmhlYWQpCiB9CiBFWFBPUlRfU1lNQk9MKHJlc291cmNlX2xp
c3RfZnJlZSk7CiAKKyNpZmRlZiBDT05GSUdfREVWSUNFX1BSSVZBVEUKKy8qKgorICogZGV2bV9y
ZXF1ZXN0X2ZyZWVfbWVtX3JlZ2lvbiAtIGZpbmQgZnJlZSByZWdpb24gZm9yIGRldmljZSBwcml2
YXRlIG1lbW9yeQorICoKKyAqIEBkZXY6IGRldmljZSBzdHJ1Y3QgdG8gYmluZCB0aGUgcmVzb3Vy
Y2UgdG8KKyAqIEBzaXplOiBzaXplIGluIGJ5dGVzIG9mIHRoZSBkZXZpY2UgbWVtb3J5IHRvIGFk
ZAorICogQGJhc2U6IHJlc291cmNlIHRyZWUgdG8gbG9vayBpbgorICoKKyAqIFRoaXMgZnVuY3Rp
b24gdHJpZXMgdG8gZmluZCBhbiBlbXB0eSByYW5nZSBvZiBwaHlzaWNhbCBhZGRyZXNzIGJpZyBl
bm91Z2ggdG8KKyAqIGNvbnRhaW4gdGhlIG5ldyByZXNvdXJjZSwgc28gdGhhdCBpdCBjYW4gbGF0
ZXIgYmUgaG90cGx1Z2dlZCBhcyBaT05FX0RFVklDRQorICogbWVtb3J5LCB3aGljaCBpbiB0dXJu
IGFsbG9jYXRlcyBzdHJ1Y3QgcGFnZXMuCisgKi8KK3N0cnVjdCByZXNvdXJjZSAqZGV2bV9yZXF1
ZXN0X2ZyZWVfbWVtX3JlZ2lvbihzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCXN0cnVjdCByZXNvdXJj
ZSAqYmFzZSwgdW5zaWduZWQgbG9uZyBzaXplKQoreworCXJlc291cmNlX3NpemVfdCBlbmQsIGFk
ZHI7CisJc3RydWN0IHJlc291cmNlICpyZXM7CisKKwlzaXplID0gQUxJR04oc2l6ZSwgMVVMIDw8
IFBBX1NFQ1RJT05fU0hJRlQpOworCWVuZCA9IG1pbl90KHVuc2lnbmVkIGxvbmcsIGJhc2UtPmVu
ZCwgKDFVTCA8PCBNQVhfUEhZU01FTV9CSVRTKSAtIDEpOworCWFkZHIgPSBlbmQgLSBzaXplICsg
MVVMOworCisJZm9yICg7IGFkZHIgPiBzaXplICYmIGFkZHIgPj0gYmFzZS0+c3RhcnQ7IGFkZHIg
LT0gc2l6ZSkgeworCQlpZiAocmVnaW9uX2ludGVyc2VjdHMoYWRkciwgc2l6ZSwgMCwgSU9SRVNf
REVTQ19OT05FKSAhPQorCQkJCVJFR0lPTl9ESVNKT0lOVCkKKwkJCWNvbnRpbnVlOworCisJCXJl
cyA9IGRldm1fcmVxdWVzdF9tZW1fcmVnaW9uKGRldiwgYWRkciwgc2l6ZSwgZGV2X25hbWUoZGV2
KSk7CisJCWlmICghcmVzKQorCQkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CisJCXJlcy0+ZGVz
YyA9IElPUkVTX0RFU0NfREVWSUNFX1BSSVZBVEVfTUVNT1JZOworCQlyZXR1cm4gcmVzOworCX0K
KworCXJldHVybiBFUlJfUFRSKC1FUkFOR0UpOworfQorRVhQT1JUX1NZTUJPTF9HUEwoZGV2bV9y
ZXF1ZXN0X2ZyZWVfbWVtX3JlZ2lvbik7CisjZW5kaWYgLyogQ09ORklHX0RFVklDRV9QUklWQVRF
ICovCisKIHN0YXRpYyBpbnQgX19pbml0IHN0cmljdF9pb21lbShjaGFyICpzdHIpCiB7CiAJaWYg
KHN0cnN0cihzdHIsICJyZWxheGVkIikpCmRpZmYgLS1naXQgYS9tbS9obW0uYyBiL21tL2htbS5j
CmluZGV4IGU3ZGQyYWI4ZjlhYi4uNDg1NzRmODQ4NWJiIDEwMDY0NAotLS0gYS9tbS9obW0uYwor
KysgYi9tbS9obW0uYwpAQCAtMjUsOCArMjUsNiBAQAogI2luY2x1ZGUgPGxpbnV4L21tdV9ub3Rp
Zmllci5oPgogI2luY2x1ZGUgPGxpbnV4L21lbW9yeV9ob3RwbHVnLmg+CiAKLSNkZWZpbmUgUEFf
U0VDVElPTl9TSVpFICgxVUwgPDwgUEFfU0VDVElPTl9TSElGVCkKLQogI2lmIElTX0VOQUJMRUQo
Q09ORklHX0hNTV9NSVJST1IpCiBzdGF0aWMgY29uc3Qgc3RydWN0IG1tdV9ub3RpZmllcl9vcHMg
aG1tX21tdV9ub3RpZmllcl9vcHM7CiAKQEAgLTE0MDgsNyArMTQwNiw2IEBAIHN0cnVjdCBobW1f
ZGV2bWVtICpobW1fZGV2bWVtX2FkZChjb25zdCBzdHJ1Y3QgaG1tX2Rldm1lbV9vcHMgKm9wcywK
IAkJCQkgIHVuc2lnbmVkIGxvbmcgc2l6ZSkKIHsKIAlzdHJ1Y3QgaG1tX2Rldm1lbSAqZGV2bWVt
OwotCXJlc291cmNlX3NpemVfdCBhZGRyOwogCXZvaWQgKnJlc3VsdDsKIAlpbnQgcmV0OwogCkBA
IC0xNDMwLDMyICsxNDI3LDEwIEBAIHN0cnVjdCBobW1fZGV2bWVtICpobW1fZGV2bWVtX2FkZChj
b25zdCBzdHJ1Y3QgaG1tX2Rldm1lbV9vcHMgKm9wcywKIAlpZiAocmV0KQogCQlyZXR1cm4gRVJS
X1BUUihyZXQpOwogCi0Jc2l6ZSA9IEFMSUdOKHNpemUsIFBBX1NFQ1RJT05fU0laRSk7Ci0JYWRk
ciA9IG1pbigodW5zaWduZWQgbG9uZylpb21lbV9yZXNvdXJjZS5lbmQsCi0JCSAgICgxVUwgPDwg
TUFYX1BIWVNNRU1fQklUUykgLSAxKTsKLQlhZGRyID0gYWRkciAtIHNpemUgKyAxVUw7Ci0KLQkv
KgotCSAqIEZJWE1FIGFkZCBhIG5ldyBoZWxwZXIgdG8gcXVpY2tseSB3YWxrIHJlc291cmNlIHRy
ZWUgYW5kIGZpbmQgZnJlZQotCSAqIHJhbmdlCi0JICoKLQkgKiBGSVhNRSB3aGF0IGFib3V0IGlv
cG9ydF9yZXNvdXJjZSByZXNvdXJjZSA/Ci0JICovCi0JZm9yICg7IGFkZHIgPiBzaXplICYmIGFk
ZHIgPj0gaW9tZW1fcmVzb3VyY2Uuc3RhcnQ7IGFkZHIgLT0gc2l6ZSkgewotCQlyZXQgPSByZWdp
b25faW50ZXJzZWN0cyhhZGRyLCBzaXplLCAwLCBJT1JFU19ERVNDX05PTkUpOwotCQlpZiAocmV0
ICE9IFJFR0lPTl9ESVNKT0lOVCkKLQkJCWNvbnRpbnVlOwotCi0JCWRldm1lbS0+cmVzb3VyY2Ug
PSBkZXZtX3JlcXVlc3RfbWVtX3JlZ2lvbihkZXZpY2UsIGFkZHIsIHNpemUsCi0JCQkJCQkJICAg
ZGV2X25hbWUoZGV2aWNlKSk7Ci0JCWlmICghZGV2bWVtLT5yZXNvdXJjZSkKLQkJCXJldHVybiBF
UlJfUFRSKC1FTk9NRU0pOwotCQlicmVhazsKLQl9Ci0JaWYgKCFkZXZtZW0tPnJlc291cmNlKQot
CQlyZXR1cm4gRVJSX1BUUigtRVJBTkdFKTsKLQotCWRldm1lbS0+cmVzb3VyY2UtPmRlc2MgPSBJ
T1JFU19ERVNDX0RFVklDRV9QUklWQVRFX01FTU9SWTsKKwlkZXZtZW0tPnJlc291cmNlID0gZGV2
bV9yZXF1ZXN0X2ZyZWVfbWVtX3JlZ2lvbihkZXZpY2UsICZpb21lbV9yZXNvdXJjZSwKKwkJCXNp
emUpOworCWlmIChJU19FUlIoZGV2bWVtLT5yZXNvdXJjZSkpCisJCXJldHVybiBFUlJfQ0FTVChk
ZXZtZW0tPnJlc291cmNlKTsKIAlkZXZtZW0tPnBmbl9maXJzdCA9IGRldm1lbS0+cmVzb3VyY2Ut
PnN0YXJ0ID4+IFBBR0VfU0hJRlQ7CiAJZGV2bWVtLT5wZm5fbGFzdCA9IGRldm1lbS0+cGZuX2Zp
cnN0ICsKIAkJCSAgIChyZXNvdXJjZV9zaXplKGRldm1lbS0+cmVzb3VyY2UpID4+IFBBR0VfU0hJ
RlQpOwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwpOb3V2ZWF1IG1haWxpbmcgbGlzdApOb3V2ZWF1QGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL25vdXZlYXU=
