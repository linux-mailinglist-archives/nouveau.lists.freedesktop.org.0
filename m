Return-Path: <nouveau-bounces@lists.freedesktop.org>
X-Original-To: lists+nouveau@lfdr.de
Delivered-To: lists+nouveau@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 9B9F7E2CCA
	for <lists+nouveau@lfdr.de>; Thu, 24 Oct 2019 11:04:30 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D1CC36E177;
	Thu, 24 Oct 2019 09:04:28 +0000 (UTC)
X-Original-To: nouveau@lists.freedesktop.org
Delivered-To: nouveau@lists.freedesktop.org
Received: from mail-oi1-x241.google.com (mail-oi1-x241.google.com
 [IPv6:2607:f8b0:4864:20::241])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 402326E177
 for <nouveau@lists.freedesktop.org>; Thu, 24 Oct 2019 09:04:28 +0000 (UTC)
Received: by mail-oi1-x241.google.com with SMTP id j7so1219956oib.3
 for <nouveau@lists.freedesktop.org>; Thu, 24 Oct 2019 02:04:28 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=LI6A5/WkSbkCLEF6Gi3QmlKrlWf74OE55pWrbF8qr9c=;
 b=OQY+Qwl0Hyz22zL+uInwL2RctCW2l4PvkGlP3OmJQzwFUWi1FMXn0obRP0lO17xg25
 6UaA/QErOMZ8qpx7gBa8aqF2YxheOox7FAkRuGaJNOcu5QJS32pKUV20n4YR0Rl3T9PD
 V3OF5IwNIYZGfqmRD9krKRVeEdeF/s9lUyWD1OFExEXg2yDVqWzg9TOYK/9+HbIiwY+y
 bU5VmMx+CT2mJKzPkFkC9bHZJ1Gie9GRmeY8k7cpv9e0DaaYo3ebaZuf6YJXXRMYGz/s
 vfxVYfxbnmzrt7RZnHyhoIwlS372+H1j7AqkjLJmYh5RVPt49kNccfj9ETXIFxee6QIN
 gK5Q==
X-Gm-Message-State: APjAAAXjnBeEOOZBEKiSKqjpAeqbcDRNX5qcdZHqFE1CuDLGFEI/guWI
 hwWPdS48Uwlt1wSwLxMAn8mLZM5F147zps5hpu78ug==
X-Google-Smtp-Source: APXvYqw6in35B5fxb5wINiS5ncPrdD/94h0ujQzPPvl9W2HWM7U8lT3UxbtSbfrKbNpv/Z/IgJjcILFXJ8NfWrrosXc=
X-Received: by 2002:a54:4e8a:: with SMTP id c10mr3697050oiy.14.1571907867284; 
 Thu, 24 Oct 2019 02:04:27 -0700 (PDT)
MIME-Version: 1.0
References: <20191021145017.17384-1-daniel.vetter@ffwll.ch>
 <20191021145017.17384-3-daniel.vetter@ffwll.ch>
In-Reply-To: <20191021145017.17384-3-daniel.vetter@ffwll.ch>
From: Daniel Vetter <daniel.vetter@ffwll.ch>
Date: Thu, 24 Oct 2019 11:04:15 +0200
Message-ID: <CAKMK7uH=ULdw6_1y5XsUt=9YhBy96BPyuELc97kWwF+tVCqY2A@mail.gmail.com>
To: DRI Development <dri-devel@lists.freedesktop.org>, 
 "airlied@gmail.com" <airlied@gmail.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=LI6A5/WkSbkCLEF6Gi3QmlKrlWf74OE55pWrbF8qr9c=;
 b=NxogbiI/XEhXGXhDD7iMdfdstE6KmgLlgp0qNqx3simzDdQOxPxKTZqAfnbS0gnjZ3
 A61HJ6g6uti0/nk3pLAF21dgkgAEoEh+I2yDC7C412COmvZGH1atf9gSt6+Iw1pGf31D
 90Jjj9KbjeZlH9MeivctQDX84ylzjnm0NriM8=
Subject: Re: [Nouveau] [PATCH 2/3] drm/nouveau: slowpath for pushbuf ioctl
X-BeenThere: nouveau@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Nouveau development list <nouveau.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/nouveau>
List-Post: <mailto:nouveau@lists.freedesktop.org>
List-Help: <mailto:nouveau-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=subscribe>
Cc: Nouveau Dev <nouveau@lists.freedesktop.org>,
 Intel Graphics Development <intel-gfx@lists.freedesktop.org>,
 Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
 Ben Skeggs <bskeggs@redhat.com>, Daniel Vetter <daniel.vetter@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: nouveau-bounces@lists.freedesktop.org
Sender: "Nouveau" <nouveau-bounces@lists.freedesktop.org>

T24gTW9uLCBPY3QgMjEsIDIwMTkgYXQgNDo1MCBQTSBEYW5pZWwgVmV0dGVyIDxkYW5pZWwudmV0
dGVyQGZmd2xsLmNoPiB3cm90ZToKPgo+IFdlIGNhbid0IGNvcHlfKl91c2VyIHdoaWxlIGhvbGRp
bmcgcmVzZXJ2YXRpb25zLCB0aGF0IHdpbGwgKHNvb24gZXZlbgo+IGZvciBub3V2ZWF1KSBsZWFk
IHRvIGRlYWRsb2Nrcy4gQW5kIGl0IGJyZWFrcyB0aGUgY3Jvc3MtZHJpdmVyCj4gY29udHJhY3Qg
YXJvdW5kIGRtYV9yZXN2Lgo+Cj4gRml4IHRoaXMgYnkgYWRkaW5nIGEgc2xvd3BhdGggZm9yIHdo
ZW4gd2UgbmVlZCByZWxvY2F0aW9ucywgYW5kIGJ5Cj4gcHVzaGluZyB0aGUgd3JpdGViYWNrIG9m
IHRoZSBuZXcgcHJlc3VtZWQgb2Zmc2V0cyB0byB0aGUgdmVyeSBlbmQuCj4KPiBBc2lkZSBmcm9t
ICJpdCBjb21waWxlcyIgZW50aXJlbHkgdW50ZXN0ZWQgdW5mb3J0dW5hdGVseS4KPgo+IFNpZ25l
ZC1vZmYtYnk6IERhbmllbCBWZXR0ZXIgPGRhbmllbC52ZXR0ZXJAaW50ZWwuY29tPgo+IENjOiBJ
bGlhIE1pcmtpbiA8aW1pcmtpbkBhbHVtLm1pdC5lZHU+Cj4gQ2M6IE1hYXJ0ZW4gTGFua2hvcnN0
IDxtYWFydGVuLmxhbmtob3JzdEBsaW51eC5pbnRlbC5jb20+Cj4gQ2M6IEJlbiBTa2VnZ3MgPGJz
a2VnZ3NAcmVkaGF0LmNvbT4KPiBDYzogbm91dmVhdUBsaXN0cy5mcmVlZGVza3RvcC5vcmcKClBp
bmcgZm9yIHJldmlldy90ZXN0aW5nL2FjaywgSSdkIHJlYWxseSBsaWtlIHRvIGdldCB0aGlzIGlu
LgotRGFuaWVsCgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2dlbS5j
IHwgNTcgKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tCj4gIDEgZmlsZSBjaGFuZ2VkLCAzOCBp
bnNlcnRpb25zKCspLCAxOSBkZWxldGlvbnMoLSkKPgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vbm91dmVhdS9ub3V2ZWF1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91
dmVhdV9nZW0uYwo+IGluZGV4IDEzMjRjMTlmNGU1Yy4uMDVlYzhlZGQ2YThiIDEwMDY0NAo+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZ2VtLmMKPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2dlbS5jCj4gQEAgLTQ4NCwxMiArNDg0LDkgQEAgdmFs
aWRhdGVfaW5pdChzdHJ1Y3Qgbm91dmVhdV9jaGFubmVsICpjaGFuLCBzdHJ1Y3QgZHJtX2ZpbGUg
KmZpbGVfcHJpdiwKPgo+ICBzdGF0aWMgaW50Cj4gIHZhbGlkYXRlX2xpc3Qoc3RydWN0IG5vdXZl
YXVfY2hhbm5lbCAqY2hhbiwgc3RydWN0IG5vdXZlYXVfY2xpICpjbGksCj4gLSAgICAgICAgICAg
ICBzdHJ1Y3QgbGlzdF9oZWFkICpsaXN0LCBzdHJ1Y3QgZHJtX25vdXZlYXVfZ2VtX3B1c2hidWZf
Ym8gKnBiYm8sCj4gLSAgICAgICAgICAgICB1aW50NjRfdCB1c2VyX3BiYm9fcHRyKQo+ICsgICAg
ICAgICAgICAgc3RydWN0IGxpc3RfaGVhZCAqbGlzdCwgc3RydWN0IGRybV9ub3V2ZWF1X2dlbV9w
dXNoYnVmX2JvICpwYmJvKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3Qgbm91dmVhdV9kcm0gKmRybSA9
IGNoYW4tPmRybTsKPiAtICAgICAgIHN0cnVjdCBkcm1fbm91dmVhdV9nZW1fcHVzaGJ1Zl9ibyBf
X3VzZXIgKnVwYmJvID0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh2b2lkIF9f
Zm9yY2UgX191c2VyICopKHVpbnRwdHJfdCl1c2VyX3BiYm9fcHRyOwo+ICAgICAgICAgc3RydWN0
IG5vdXZlYXVfYm8gKm52Ym87Cj4gICAgICAgICBpbnQgcmV0LCByZWxvY3MgPSAwOwo+Cj4gQEAg
LTUzMywxMCArNTMwLDYgQEAgdmFsaWRhdGVfbGlzdChzdHJ1Y3Qgbm91dmVhdV9jaGFubmVsICpj
aGFuLCBzdHJ1Y3Qgbm91dmVhdV9jbGkgKmNsaSwKPiAgICAgICAgICAgICAgICAgICAgICAgICBi
LT5wcmVzdW1lZC5vZmZzZXQgPSBudmJvLT5iby5vZmZzZXQ7Cj4gICAgICAgICAgICAgICAgICAg
ICAgICAgYi0+cHJlc3VtZWQudmFsaWQgPSAwOwo+ICAgICAgICAgICAgICAgICAgICAgICAgIHJl
bG9jcysrOwo+IC0KPiAtICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29weV90b191c2VyKCZ1
cGJib1tudmJvLT5wYmJvX2luZGV4XS5wcmVzdW1lZCwKPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAmYi0+cHJlc3VtZWQsIHNpemVvZihiLT5wcmVzdW1lZCkp
KQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7Cj4gICAg
ICAgICAgICAgICAgIH0KPiAgICAgICAgIH0KPgo+IEBAIC01NDcsOCArNTQwLDggQEAgc3RhdGlj
IGludAo+ICBub3V2ZWF1X2dlbV9wdXNoYnVmX3ZhbGlkYXRlKHN0cnVjdCBub3V2ZWF1X2NoYW5u
ZWwgKmNoYW4sCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZHJtX2ZpbGUg
KmZpbGVfcHJpdiwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fbm91
dmVhdV9nZW1fcHVzaGJ1Zl9ibyAqcGJibywKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHVpbnQ2NF90IHVzZXJfYnVmZmVycywgaW50IG5yX2J1ZmZlcnMsCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdHJ1Y3QgdmFsaWRhdGVfb3AgKm9wLCBpbnQgKmFwcGx5X3JlbG9jcykK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBucl9idWZmZXJzLAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHZhbGlkYXRlX29wICpvcCwgYm9vbCAqYXBwbHlf
cmVsb2NzKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3Qgbm91dmVhdV9jbGkgKmNsaSA9IG5vdXZlYXVf
Y2xpKGZpbGVfcHJpdik7Cj4gICAgICAgICBpbnQgcmV0Owo+IEBAIC01NjUsNyArNTU4LDcgQEAg
bm91dmVhdV9nZW1fcHVzaGJ1Zl92YWxpZGF0ZShzdHJ1Y3Qgbm91dmVhdV9jaGFubmVsICpjaGFu
LAo+ICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+ICAgICAgICAgfQo+Cj4gLSAgICAgICBy
ZXQgPSB2YWxpZGF0ZV9saXN0KGNoYW4sIGNsaSwgJm9wLT5saXN0LCBwYmJvLCB1c2VyX2J1ZmZl
cnMpOwo+ICsgICAgICAgcmV0ID0gdmFsaWRhdGVfbGlzdChjaGFuLCBjbGksICZvcC0+bGlzdCwg
cGJibyk7Cj4gICAgICAgICBpZiAodW5saWtlbHkocmV0IDwgMCkpIHsKPiAgICAgICAgICAgICAg
ICAgaWYgKHJldCAhPSAtRVJFU1RBUlRTWVMpCj4gICAgICAgICAgICAgICAgICAgICAgICAgTlZf
UFJJTlRLKGVyciwgY2xpLCAidmFsaWRhdGluZyBibyBsaXN0XG4iKTsKPiBAQCAtNjA1LDE2ICs1
OTgsMTIgQEAgdV9tZW1jcHlhKHVpbnQ2NF90IHVzZXIsIHVuc2lnbmVkIG5tZW1iLCB1bnNpZ25l
ZCBzaXplKQo+ICBzdGF0aWMgaW50Cj4gIG5vdXZlYXVfZ2VtX3B1c2hidWZfcmVsb2NfYXBwbHko
c3RydWN0IG5vdXZlYXVfY2xpICpjbGksCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgZHJtX25vdXZlYXVfZ2VtX3B1c2hidWYgKnJlcSwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fbm91dmVhdV9nZW1fcHVzaGJ1Zl9yZWxvYyAqcmVs
b2MsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZHJtX25vdXZlYXVf
Z2VtX3B1c2hidWZfYm8gKmJvKQo+ICB7Cj4gLSAgICAgICBzdHJ1Y3QgZHJtX25vdXZlYXVfZ2Vt
X3B1c2hidWZfcmVsb2MgKnJlbG9jID0gTlVMTDsKPiAgICAgICAgIGludCByZXQgPSAwOwo+ICAg
ICAgICAgdW5zaWduZWQgaTsKPgo+IC0gICAgICAgcmVsb2MgPSB1X21lbWNweWEocmVxLT5yZWxv
Y3MsIHJlcS0+bnJfcmVsb2NzLCBzaXplb2YoKnJlbG9jKSk7Cj4gLSAgICAgICBpZiAoSVNfRVJS
KHJlbG9jKSkKPiAtICAgICAgICAgICAgICAgcmV0dXJuIFBUUl9FUlIocmVsb2MpOwo+IC0KPiAg
ICAgICAgIGZvciAoaSA9IDA7IGkgPCByZXEtPm5yX3JlbG9jczsgaSsrKSB7Cj4gICAgICAgICAg
ICAgICAgIHN0cnVjdCBkcm1fbm91dmVhdV9nZW1fcHVzaGJ1Zl9yZWxvYyAqciA9ICZyZWxvY1tp
XTsKPiAgICAgICAgICAgICAgICAgc3RydWN0IGRybV9ub3V2ZWF1X2dlbV9wdXNoYnVmX2JvICpi
Owo+IEBAIC02OTMsMTEgKzY4MiwxMyBAQCBub3V2ZWF1X2dlbV9pb2N0bF9wdXNoYnVmKHN0cnVj
dCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gICAgICAgICBzdHJ1Y3Qgbm91dmVhdV9k
cm0gKmRybSA9IG5vdXZlYXVfZHJtKGRldik7Cj4gICAgICAgICBzdHJ1Y3QgZHJtX25vdXZlYXVf
Z2VtX3B1c2hidWYgKnJlcSA9IGRhdGE7Cj4gICAgICAgICBzdHJ1Y3QgZHJtX25vdXZlYXVfZ2Vt
X3B1c2hidWZfcHVzaCAqcHVzaDsKPiArICAgICAgIHN0cnVjdCBkcm1fbm91dmVhdV9nZW1fcHVz
aGJ1Zl9yZWxvYyAqcmVsb2MgPSBOVUxMOwo+ICAgICAgICAgc3RydWN0IGRybV9ub3V2ZWF1X2dl
bV9wdXNoYnVmX2JvICpibzsKPiAgICAgICAgIHN0cnVjdCBub3V2ZWF1X2NoYW5uZWwgKmNoYW4g
PSBOVUxMOwo+ICAgICAgICAgc3RydWN0IHZhbGlkYXRlX29wIG9wOwo+ICAgICAgICAgc3RydWN0
IG5vdXZlYXVfZmVuY2UgKmZlbmNlID0gTlVMTDsKPiAtICAgICAgIGludCBpLCBqLCByZXQgPSAw
LCBkb19yZWxvYyA9IDA7Cj4gKyAgICAgICBpbnQgaSwgaiwgcmV0ID0gMDsKPiArICAgICAgIGJv
b2wgZG9fcmVsb2MgPSBmYWxzZTsKPgo+ICAgICAgICAgaWYgKHVubGlrZWx5KCFhYmkxNikpCj4g
ICAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+IEBAIC03NTUsNyArNzQ2LDggQEAgbm91
dmVhdV9nZW1faW9jdGxfcHVzaGJ1ZihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRh
LAo+ICAgICAgICAgfQo+Cj4gICAgICAgICAvKiBWYWxpZGF0ZSBidWZmZXIgbGlzdCAqLwo+IC0g
ICAgICAgcmV0ID0gbm91dmVhdV9nZW1fcHVzaGJ1Zl92YWxpZGF0ZShjaGFuLCBmaWxlX3ByaXYs
IGJvLCByZXEtPmJ1ZmZlcnMsCj4gK3JldmFsaWRhdGU6Cj4gKyAgICAgICByZXQgPSBub3V2ZWF1
X2dlbV9wdXNoYnVmX3ZhbGlkYXRlKGNoYW4sIGZpbGVfcHJpdiwgYm8sCj4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+bnJfYnVmZmVycywgJm9wLCAmZG9f
cmVsb2MpOwo+ICAgICAgICAgaWYgKHJldCkgewo+ICAgICAgICAgICAgICAgICBpZiAocmV0ICE9
IC1FUkVTVEFSVFNZUykKPiBAQCAtNzY1LDcgKzc1NywxOCBAQCBub3V2ZWF1X2dlbV9pb2N0bF9w
dXNoYnVmKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4KPiAgICAgICAgIC8q
IEFwcGx5IGFueSByZWxvY2F0aW9ucyB0aGF0IGFyZSByZXF1aXJlZCAqLwo+ICAgICAgICAgaWYg
KGRvX3JlbG9jKSB7Cj4gLSAgICAgICAgICAgICAgIHJldCA9IG5vdXZlYXVfZ2VtX3B1c2hidWZf
cmVsb2NfYXBwbHkoY2xpLCByZXEsIGJvKTsKPiArICAgICAgICAgICAgICAgaWYgKCFyZWxvYykg
ewo+ICsgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlX2ZpbmkoJm9wLCBjaGFuLCBOVUxM
LCBibyk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmVsb2MgPSB1X21lbWNweWEocmVxLT5y
ZWxvY3MsIHJlcS0+bnJfcmVsb2NzLCBzaXplb2YoKnJlbG9jKSk7Cj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKElTX0VSUihyZWxvYykpIHsKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHJldCA9IFBUUl9FUlIocmVsb2MpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZ290byBvdXRfcHJldmFsaWQ7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgfQo+ICsK
PiArICAgICAgICAgICAgICAgICAgICAgICBnb3RvIHJldmFsaWRhdGU7Cj4gKyAgICAgICAgICAg
ICAgIH0KPiArCj4gKyAgICAgICAgICAgICAgIHJldCA9IG5vdXZlYXVfZ2VtX3B1c2hidWZfcmVs
b2NfYXBwbHkoY2xpLCByZXEsIHJlbG9jLCBibyk7Cj4gICAgICAgICAgICAgICAgIGlmIChyZXQp
IHsKPiAgICAgICAgICAgICAgICAgICAgICAgICBOVl9QUklOVEsoZXJyLCBjbGksICJyZWxvYyBh
cHBseTogJWRcbiIsIHJldCk7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXQ7Cj4g
QEAgLTg1MSw2ICs4NTQsMjIgQEAgbm91dmVhdV9nZW1faW9jdGxfcHVzaGJ1ZihzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgICAgICAgdmFsaWRhdGVfZmluaSgmb3AsIGNo
YW4sIGZlbmNlLCBibyk7Cj4gICAgICAgICBub3V2ZWF1X2ZlbmNlX3VucmVmKCZmZW5jZSk7Cj4K
PiArICAgICAgIGlmIChkb19yZWxvYykgewo+ICsgICAgICAgICAgICAgICBzdHJ1Y3QgZHJtX25v
dXZlYXVfZ2VtX3B1c2hidWZfYm8gX191c2VyICp1cGJibyA9Cj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgdTY0X3RvX3VzZXJfcHRyKHJlcS0+YnVmZmVycyk7Cj4gKwo+ICsgICAgICAgICAgICAg
ICBmb3IgKGkgPSAwOyBpIDwgcmVxLT5ucl9idWZmZXJzOyBpKyspIHsKPiArICAgICAgICAgICAg
ICAgICAgICAgICBpZiAoYm9baV0ucHJlc3VtZWQudmFsaWQpCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjb250aW51ZTsKPiArCj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYg
KGNvcHlfdG9fdXNlcigmdXBiYm9baV0ucHJlc3VtZWQsICZib1tpXS5wcmVzdW1lZCwKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZihib1tpXS5wcmVzdW1l
ZCkpKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXQgPSAtRUZBVUxUOwo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgfQo+ICsgICAgICAgICAgICAgICB9Cj4gKyAgICAgICAgICAgICAgIHVfZnJlZShy
ZWxvYyk7Cj4gKyAgICAgICB9Cj4gIG91dF9wcmV2YWxpZDoKPiAgICAgICAgIHVfZnJlZShibyk7
Cj4gICAgICAgICB1X2ZyZWUocHVzaCk7Cj4gLS0KPiAyLjIzLjAKPgoKCi0tIApEYW5pZWwgVmV0
dGVyClNvZnR3YXJlIEVuZ2luZWVyLCBJbnRlbCBDb3Jwb3JhdGlvbgorNDEgKDApIDc5IDM2NSA1
NyA0OCAtIGh0dHA6Ly9ibG9nLmZmd2xsLmNoCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCk5vdXZlYXUgbWFpbGluZyBsaXN0Ck5vdXZlYXVAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vbm91dmVhdQ==
