Return-Path: <nouveau-bounces@lists.freedesktop.org>
X-Original-To: lists+nouveau@lfdr.de
Delivered-To: lists+nouveau@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5E6D2148A7D
	for <lists+nouveau@lfdr.de>; Fri, 24 Jan 2020 15:49:00 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D416E6E3C6;
	Fri, 24 Jan 2020 14:48:58 +0000 (UTC)
X-Original-To: nouveau@lists.freedesktop.org
Delivered-To: nouveau@lists.freedesktop.org
Received: from mupuf.org (mupuf.org [167.71.42.210])
 by gabe.freedesktop.org (Postfix) with ESMTP id 17E076E3BC
 for <nouveau@lists.freedesktop.org>; Fri, 24 Jan 2020 14:48:58 +0000 (UTC)
Received: from alne.cl.cam.ac.uk (unknown
 [IPv6:2001:630:212:238:62a4:4cff:fed0:3ab1])
 by Neelix.spliet.org (Postfix) with ESMTPSA id 492DA60088
 for <nouveau@lists.freedesktop.org>; Fri, 24 Jan 2020 14:48:50 +0000 (GMT)
DKIM-Filter: OpenDKIM Filter v2.11.0 Neelix.spliet.org 492DA60088
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=spliet.org;
 s=default; t=1579877330;
 bh=6nqWv0uzTfZlMPZzcCHoaDIKUsPPDXApeqA67qw1VGE=;
 h=Subject:To:References:From:Date:In-Reply-To:From;
 b=Asi1Jdd2/RoZmwkg6qjTj0NqdBBmnyzyChIzS2EX/vclkXbhbHzcXooOgqZ5JNzRh
 c9U8haDsBlVowgBri/fpoqk/jxeeRvopAo8EfTdkazx4r0KnmwOV7eB9io1ZTxSul+
 cSHg2YbfYNmerv93a0Qe8wTJvSEQiLFdlvJAUY5Y=
To: nouveau@lists.freedesktop.org
References: <20200124143042.93733-1-christian.koenig@amd.com>
 <20200124143042.93733-2-christian.koenig@amd.com>
From: Roy Spliet <nouveau@spliet.org>
Message-ID: <05f870ff-5c2b-c1bf-acbf-f1bffe4c426d@spliet.org>
Date: Fri, 24 Jan 2020 14:48:49 +0000
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.0
MIME-Version: 1.0
In-Reply-To: <20200124143042.93733-2-christian.koenig@amd.com>
Content-Language: en-GB
X-Spam-Status: No, score=-1.7 required=5.0 tests=BAYES_00,DKIM_INVALID,
 DKIM_SIGNED,UNPARSEABLE_RELAY autolearn=no autolearn_force=no
 version=3.4.3
X-Spam-Checker-Version: SpamAssassin 3.4.3 (2019-12-06) on Neelix
X-Virus-Scanned: clamav-milter 0.101.5 at Neelix
X-Virus-Status: Clean
Subject: Re: [Nouveau] [PATCH 1/2] drm/nouveau: move io_reserve_lru handling
 into the driver v2
X-BeenThere: nouveau@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Nouveau development list <nouveau.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/nouveau>
List-Post: <mailto:nouveau@lists.freedesktop.org>
List-Help: <mailto:nouveau-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: nouveau-bounces@lists.freedesktop.org
Sender: "Nouveau" <nouveau-bounces@lists.freedesktop.org>

V2l0aG91dCBkaXZpbmcgaW4gYW55IG9mIHRoZSBkZXRhaWxzLCB5b3VyIGNvbW1pdCBtZXNzYWdl
IGhhcyBtZSBjdXJpb3VzIAphbmQgY29uY2VybmVkLi4uIEluIGEgIm1hbmFnZXIiIGtpbmQgb2Yg
d2F5LCBkZXNwaXRlIGJlaW5nIG5laXRoZXIgYSAKbWFuYWdlciBub3IgYW4gaW5zaWRlciBvciBh
Y3RpdmUgY29udHJpYnV0b3IuIDstKQoKT24gMjQvMDEvMjAyMCAxNDozMCwgQ2hyaXN0aWFuIEvD
tm5pZyB3cm90ZToKPiBGcm9tOiBDaHJpc3RpYW4gS8O2bmlnIDxja29lbmlnLmxlaWNodHp1bWVy
a2VuQGdtYWlsLmNvbT4KPiAKPiBXaGlsZSB3b3JraW5nIG9uIFRUTSBjbGVhbnVwcyBJJ3ZlIGZv
dW5kIHRoYXQgdGhlIGlvX3Jlc2VydmVfbHJ1IHVzZWQgYnkKPiBOb3V2ZWF1IGlzIGFjdHVhbGx5
IG5vdCB3b3JraW5nIGF0IGFsbC4KCldoYXQgbWFkZSB5b3UgY29uY2x1ZGUgdGhpcyBtZWNoYW5p
c20gZG9lc24ndCB3b3JrPyBEb2VzIHRoaXMgaW1wbHkgdGhhdCAKTm91dmVhdSBpcyBicm9rZW4/
IElmIHNvOiBEb2VzIHRoZSBtaWdyYXRpb24gb2YgdGhpcyBjb2RlIGZyb20gVFRNIHRvIApOb3V2
ZWF1IG1lYW4gdGhhdCBOb3V2ZWF1IHJlbWFpbnMgYnJva2VuLCBidXQgaXQncyBub3cgc2ltcGx5
IG5vIGxvbmdlciAKeW91ciBwcm9ibGVtPyBBbmQgd2hhdCB3b3VsZCBpdCB0YWtlIHRvIGZpeCBO
b3V2ZWF1PwpCZXN0LAoKUm95Cgo+IAo+IEluIGdlbmVyYWwgd2Ugc2hvdWxkIHJlbW92ZSBkcml2
ZXIgc3BlY2lmaWMgaGFuZGxpbmcgZnJvbSB0aGUgbWVtb3J5Cj4gbWFuYWdlbWVudCwgc28gdGhp
cyBwYXRjaCBtb3ZlcyB0aGUgaW9fcmVzZXJ2ZV9scnUgaGFuZGxpbmcgaW50byBOb3V2ZWF1Cj4g
aW5zdGVhZC4KPiAKPiBUaGUgcGF0Y2ggc2hvdWxkIGJlIGZ1bmN0aW9uYWwgY29ycmVjdCwgYnV0
IGlzIG9ubHkgY29tcGlsZSB0ZXN0ZWQhCj4gCj4gdjI6IGRvbid0IGNhbGwgdHRtX2JvX3VubWFw
X3ZpcnR1YWwgaW4gbm91dmVhdV90dG1faW9fbWVtX3Jlc2VydmUKPiAKPiBTaWduZWQtb2ZmLWJ5
OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+Cj4gQWNrZWQtYnk6
IERhbmllbCBWZXR0ZXIgPGRhbmllbC52ZXR0ZXJAZmZ3bGwuY2g+Cj4gLS0tCj4gICBkcml2ZXJz
L2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMgIHwgMTA3ICsrKysrKysrKysrKysrKysrKysr
LS0tLS0tCj4gICBkcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmggIHwgICAzICsK
PiAgIGRyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZHJ2LmggfCAgIDIgKwo+ICAgZHJp
dmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV90dG0uYyB8ICA0MyArKysrKysrKysrLQo+ICAg
NCBmaWxlcyBjaGFuZ2VkLCAxMzEgaW5zZXJ0aW9ucygrKSwgMjQgZGVsZXRpb25zKC0pCj4gCj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uYyBiL2RyaXZl
cnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uYwo+IGluZGV4IDgxNjY4MTA0NTk1Zi4uYWNl
ZTA1NGY3N2VkIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVf
Ym8uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uYwo+IEBAIC0x
MzcsNiArMTM3LDcgQEAgbm91dmVhdV9ib19kZWxfdHRtKHN0cnVjdCB0dG1fYnVmZmVyX29iamVj
dCAqYm8pCj4gICAJc3RydWN0IG5vdXZlYXVfYm8gKm52Ym8gPSBub3V2ZWF1X2JvKGJvKTsKPiAg
IAo+ICAgCVdBUk5fT04obnZiby0+cGluX3JlZmNudCA+IDApOwo+ICsJbm91dmVhdV9ib19kZWxf
aW9fcmVzZXJ2ZV9scnUoYm8pOwo+ICAgCW52MTBfYm9fcHV0X3RpbGVfcmVnaW9uKGRldiwgbnZi
by0+dGlsZSwgTlVMTCk7Cj4gICAKPiAgIAkvKgo+IEBAIC0zMDQsNiArMzA1LDcgQEAgbm91dmVh
dV9ib19pbml0KHN0cnVjdCBub3V2ZWF1X2JvICpudmJvLCB1NjQgc2l6ZSwgaW50IGFsaWduLCB1
MzIgZmxhZ3MsCj4gICAKPiAgIAludmJvLT5iby5tZW0ubnVtX3BhZ2VzID0gc2l6ZSA+PiBQQUdF
X1NISUZUOwo+ICAgCW5vdXZlYXVfYm9fcGxhY2VtZW50X3NldChudmJvLCBmbGFncywgMCk7Cj4g
KwlJTklUX0xJU1RfSEVBRCgmbnZiby0+aW9fcmVzZXJ2ZV9scnUpOwo+ICAgCj4gICAJcmV0ID0g
dHRtX2JvX2luaXQobnZiby0+Ym8uYmRldiwgJm52Ym8tPmJvLCBzaXplLCB0eXBlLAo+ICAgCQkJ
ICAmbnZiby0+cGxhY2VtZW50LCBhbGlnbiA+PiBQQUdFX1NISUZULCBmYWxzZSwKPiBAQCAtNTc0
LDYgKzU3NiwyNiBAQCBub3V2ZWF1X2JvX3N5bmNfZm9yX2NwdShzdHJ1Y3Qgbm91dmVhdV9ibyAq
bnZibykKPiAgIAkJCQkJUEFHRV9TSVpFLCBETUFfRlJPTV9ERVZJQ0UpOwo+ICAgfQo+ICAgCj4g
K3ZvaWQgbm91dmVhdV9ib19hZGRfaW9fcmVzZXJ2ZV9scnUoc3RydWN0IHR0bV9idWZmZXJfb2Jq
ZWN0ICpibykKPiArewo+ICsJc3RydWN0IG5vdXZlYXVfZHJtICpkcm0gPSBub3V2ZWF1X2JkZXYo
Ym8tPmJkZXYpOwo+ICsJc3RydWN0IG5vdXZlYXVfYm8gKm52Ym8gPSBub3V2ZWF1X2JvKGJvKTsK
PiArCj4gKwltdXRleF9sb2NrKCZkcm0tPnR0bS5pb19yZXNlcnZlX211dGV4KTsKPiArCWxpc3Rf
bW92ZV90YWlsKCZudmJvLT5pb19yZXNlcnZlX2xydSwgJmRybS0+dHRtLmlvX3Jlc2VydmVfbHJ1
KTsKPiArCW11dGV4X3VubG9jaygmZHJtLT50dG0uaW9fcmVzZXJ2ZV9tdXRleCk7Cj4gK30KPiAr
Cj4gK3ZvaWQgbm91dmVhdV9ib19kZWxfaW9fcmVzZXJ2ZV9scnUoc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibykKPiArewo+ICsJc3RydWN0IG5vdXZlYXVfZHJtICpkcm0gPSBub3V2ZWF1X2Jk
ZXYoYm8tPmJkZXYpOwo+ICsJc3RydWN0IG5vdXZlYXVfYm8gKm52Ym8gPSBub3V2ZWF1X2JvKGJv
KTsKPiArCj4gKwltdXRleF9sb2NrKCZkcm0tPnR0bS5pb19yZXNlcnZlX211dGV4KTsKPiArCWxp
c3RfZGVsX2luaXQoJm52Ym8tPmlvX3Jlc2VydmVfbHJ1KTsKPiArCW11dGV4X3VubG9jaygmZHJt
LT50dG0uaW9fcmVzZXJ2ZV9tdXRleCk7Cj4gK30KPiArCj4gICBpbnQKPiAgIG5vdXZlYXVfYm9f
dmFsaWRhdGUoc3RydWN0IG5vdXZlYXVfYm8gKm52Ym8sIGJvb2wgaW50ZXJydXB0aWJsZSwKPiAg
IAkJICAgIGJvb2wgbm9fd2FpdF9ncHUpCj4gQEAgLTY3NSw4ICs2OTcsNiBAQCBub3V2ZWF1X2Jv
X2luaXRfbWVtX3R5cGUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHVpbnQzMl90IHR5cGUs
Cj4gICAJCQl9Cj4gICAKPiAgIAkJCW1hbi0+ZnVuYyA9ICZub3V2ZWF1X3ZyYW1fbWFuYWdlcjsK
PiAtCQkJbWFuLT5pb19yZXNlcnZlX2Zhc3RwYXRoID0gZmFsc2U7Cj4gLQkJCW1hbi0+dXNlX2lv
X3Jlc2VydmVfbHJ1ID0gdHJ1ZTsKPiAgIAkJfSBlbHNlIHsKPiAgIAkJCW1hbi0+ZnVuYyA9ICZ0
dG1fYm9fbWFuYWdlcl9mdW5jOwo+ICAgCQl9Cj4gQEAgLTEzMDUsNiArMTMyNSw4IEBAIG5vdXZl
YXVfYm9fbW92ZV9udGZ5KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sIGJvb2wgZXZpY3Qs
Cj4gICAJaWYgKGJvLT5kZXN0cm95ICE9IG5vdXZlYXVfYm9fZGVsX3R0bSkKPiAgIAkJcmV0dXJu
Owo+ICAgCj4gKwlub3V2ZWF1X2JvX2RlbF9pb19yZXNlcnZlX2xydShibyk7Cj4gKwo+ICAgCWlm
IChtZW0gJiYgbmV3X3JlZy0+bWVtX3R5cGUgIT0gVFRNX1BMX1NZU1RFTSAmJgo+ICAgCSAgICBt
ZW0tPm1lbS5wYWdlID09IG52Ym8tPnBhZ2UpIHsKPiAgIAkJbGlzdF9mb3JfZWFjaF9lbnRyeSh2
bWEsICZudmJvLT52bWFfbGlzdCwgaGVhZCkgewo+IEBAIC0xNDI3LDYgKzE0NDksMzAgQEAgbm91
dmVhdV9ib192ZXJpZnlfYWNjZXNzKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sIHN0cnVj
dCBmaWxlICpmaWxwKQo+ICAgCQkJCQkgIGZpbHAtPnByaXZhdGVfZGF0YSk7Cj4gICB9Cj4gICAK
PiArc3RhdGljIHZvaWQKPiArbm91dmVhdV90dG1faW9fbWVtX2ZyZWVfbG9ja2VkKHN0cnVjdCBu
b3V2ZWF1X2RybSAqZHJtLCBzdHJ1Y3QgdHRtX21lbV9yZWcgKnJlZykKPiArewo+ICsJc3RydWN0
IG5vdXZlYXVfbWVtICptZW0gPSBub3V2ZWF1X21lbShyZWcpOwo+ICsKPiArCWlmICghcmVnLT5i
dXMuYmFzZSkKPiArCQlyZXR1cm47IC8qIGFscmVhZHkgZnJlZWQgKi8KPiArCj4gKwlpZiAoZHJt
LT5jbGllbnQubWVtLT5vY2xhc3MgPj0gTlZJRl9DTEFTU19NRU1fTlY1MCkgewo+ICsJCXN3aXRj
aCAocmVnLT5tZW1fdHlwZSkgewo+ICsJCWNhc2UgVFRNX1BMX1RUOgo+ICsJCQlpZiAobWVtLT5r
aW5kKQo+ICsJCQkJbnZpZl9vYmplY3RfdW5tYXBfaGFuZGxlKCZtZW0tPm1lbS5vYmplY3QpOwo+
ICsJCQlicmVhazsKPiArCQljYXNlIFRUTV9QTF9WUkFNOgo+ICsJCQludmlmX29iamVjdF91bm1h
cF9oYW5kbGUoJm1lbS0+bWVtLm9iamVjdCk7Cj4gKwkJCWJyZWFrOwo+ICsJCWRlZmF1bHQ6Cj4g
KwkJCWJyZWFrOwo+ICsJCX0KPiArCX0KPiArCXJlZy0+YnVzLmJhc2UgPSAwOwo+ICt9Cj4gKwo+
ICAgc3RhdGljIGludAo+ICAgbm91dmVhdV90dG1faW9fbWVtX3Jlc2VydmUoc3RydWN0IHR0bV9i
b19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fbWVtX3JlZyAqcmVnKQo+ICAgewo+IEBAIC0xNDM0
LDE4ICsxNDgwLDI2IEBAIG5vdXZlYXVfdHRtX2lvX21lbV9yZXNlcnZlKHN0cnVjdCB0dG1fYm9f
ZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX21lbV9yZWcgKnJlZykKPiAgIAlzdHJ1Y3Qgbm91dmVh
dV9kcm0gKmRybSA9IG5vdXZlYXVfYmRldihiZGV2KTsKPiAgIAlzdHJ1Y3QgbnZrbV9kZXZpY2Ug
KmRldmljZSA9IG52eHhfZGV2aWNlKCZkcm0tPmNsaWVudC5kZXZpY2UpOwo+ICAgCXN0cnVjdCBu
b3V2ZWF1X21lbSAqbWVtID0gbm91dmVhdV9tZW0ocmVnKTsKPiArCXN0cnVjdCBub3V2ZWF1X2Jv
ICpudmJvOwo+ICsJaW50IHJldDsKPiArCj4gKwlpZiAocmVnLT5idXMuYmFzZSkKPiArCQlyZXR1
cm4gMDsgLyogYWxyZWFkeSBtYXBwZWQgKi8KPiAgIAo+ICAgCXJlZy0+YnVzLmFkZHIgPSBOVUxM
Owo+ICAgCXJlZy0+YnVzLm9mZnNldCA9IDA7Cj4gICAJcmVnLT5idXMuc2l6ZSA9IHJlZy0+bnVt
X3BhZ2VzIDw8IFBBR0VfU0hJRlQ7Cj4gLQlyZWctPmJ1cy5iYXNlID0gMDsKPiAgIAlyZWctPmJ1
cy5pc19pb21lbSA9IGZhbHNlOwo+ICAgCWlmICghKG1hbi0+ZmxhZ3MgJiBUVE1fTUVNVFlQRV9G
TEFHX01BUFBBQkxFKSkKPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gKwo+ICsJbXV0ZXhfbG9jaygm
ZHJtLT50dG0uaW9fcmVzZXJ2ZV9tdXRleCk7Cj4gK3JldHJ5Ogo+ICAgCXN3aXRjaCAocmVnLT5t
ZW1fdHlwZSkgewo+ICAgCWNhc2UgVFRNX1BMX1NZU1RFTToKPiAgIAkJLyogU3lzdGVtIG1lbW9y
eSAqLwo+IC0JCXJldHVybiAwOwo+ICsJCXJldCA9IDA7Cj4gKwkJZ290byBvdXQ7Cj4gICAJY2Fz
ZSBUVE1fUExfVFQ6Cj4gICAjaWYgSVNfRU5BQkxFRChDT05GSUdfQUdQKQo+ICAgCQlpZiAoZHJt
LT5hZ3AuYnJpZGdlKSB7Cj4gQEAgLTE0NjksNyArMTUyMyw2IEBAIG5vdXZlYXVfdHRtX2lvX21l
bV9yZXNlcnZlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX21lbV9yZWcg
KnJlZykKPiAgIAkJCX0gYXJnczsKPiAgIAkJCXU2NCBoYW5kbGUsIGxlbmd0aDsKPiAgIAkJCXUz
MiBhcmdjID0gMDsKPiAtCQkJaW50IHJldDsKPiAgIAo+ICAgCQkJc3dpdGNoIChtZW0tPm1lbS5v
YmplY3Qub2NsYXNzKSB7Cj4gICAJCQljYXNlIE5WSUZfQ0xBU1NfTUVNX05WNTA6Cj4gQEAgLTE0
OTMsMzggKzE1NDYsNDYgQEAgbm91dmVhdV90dG1faW9fbWVtX3Jlc2VydmUoc3RydWN0IHR0bV9i
b19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fbWVtX3JlZyAqcmVnKQo+ICAgCQkJcmV0ID0gbnZp
Zl9vYmplY3RfbWFwX2hhbmRsZSgmbWVtLT5tZW0ub2JqZWN0LAo+ICAgCQkJCQkJICAgICAmYXJn
cywgYXJnYywKPiAgIAkJCQkJCSAgICAgJmhhbmRsZSwgJmxlbmd0aCk7Cj4gLQkJCWlmIChyZXQg
IT0gMSkKPiAtCQkJCXJldHVybiByZXQgPyByZXQgOiAtRUlOVkFMOwo+ICsJCQlpZiAocmV0ICE9
IDEpIHsKPiArCQkJCXJldCA9IHJldCA/IHJldCA6IC1FSU5WQUw7Cj4gKwkJCQlnb3RvIG91dDsK
PiArCQkJfQo+ICsJCQlyZXQgPSAwOwo+ICAgCj4gICAJCQlyZWctPmJ1cy5iYXNlID0gMDsKPiAg
IAkJCXJlZy0+YnVzLm9mZnNldCA9IGhhbmRsZTsKPiAgIAkJfQo+ICAgCQlicmVhazsKPiAgIAlk
ZWZhdWx0Ogo+IC0JCXJldHVybiAtRUlOVkFMOwo+ICsJCXJldCA9IC1FSU5WQUw7Cj4gICAJfQo+
IC0JcmV0dXJuIDA7Cj4gKwo+ICtvdXQ6Cj4gKwlpZiAocmV0ID09IC1FQUdBSU4pIHsKPiArCQlu
dmJvID0gbGlzdF9maXJzdF9lbnRyeV9vcl9udWxsKCZkcm0tPnR0bS5pb19yZXNlcnZlX2xydSwK
PiArCQkJCQkJdHlwZW9mKCpudmJvKSwKPiArCQkJCQkJaW9fcmVzZXJ2ZV9scnUpOwo+ICsJCWlm
IChudmJvKSB7Cj4gKwkJCWxpc3RfZGVsX2luaXQoJm52Ym8tPmlvX3Jlc2VydmVfbHJ1KTsKPiAr
CQkJZHJtX3ZtYV9ub2RlX3VubWFwKCZudmJvLT5iby5iYXNlLnZtYV9ub2RlLAo+ICsJCQkJCSAg
IGJkZXYtPmRldl9tYXBwaW5nKTsKPiArCQkJbm91dmVhdV90dG1faW9fbWVtX2ZyZWVfbG9ja2Vk
KGRybSwgJm52Ym8tPmJvLm1lbSk7Cj4gKwkJCWdvdG8gcmV0cnk7Cj4gKwkJfQo+ICsKPiArCX0K
PiArCW11dGV4X3VubG9jaygmZHJtLT50dG0uaW9fcmVzZXJ2ZV9tdXRleCk7Cj4gKwlyZXR1cm4g
cmV0Owo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+ICAgbm91dmVhdV90dG1faW9fbWVtX2Zy
ZWUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fbWVtX3JlZyAqcmVnKQo+
ICAgewo+ICAgCXN0cnVjdCBub3V2ZWF1X2RybSAqZHJtID0gbm91dmVhdV9iZGV2KGJkZXYpOwo+
IC0Jc3RydWN0IG5vdXZlYXVfbWVtICptZW0gPSBub3V2ZWF1X21lbShyZWcpOwo+ICAgCj4gLQlp
ZiAoZHJtLT5jbGllbnQubWVtLT5vY2xhc3MgPj0gTlZJRl9DTEFTU19NRU1fTlY1MCkgewo+IC0J
CXN3aXRjaCAocmVnLT5tZW1fdHlwZSkgewo+IC0JCWNhc2UgVFRNX1BMX1RUOgo+IC0JCQlpZiAo
bWVtLT5raW5kKQo+IC0JCQkJbnZpZl9vYmplY3RfdW5tYXBfaGFuZGxlKCZtZW0tPm1lbS5vYmpl
Y3QpOwo+IC0JCQlicmVhazsKPiAtCQljYXNlIFRUTV9QTF9WUkFNOgo+IC0JCQludmlmX29iamVj
dF91bm1hcF9oYW5kbGUoJm1lbS0+bWVtLm9iamVjdCk7Cj4gLQkJCWJyZWFrOwo+IC0JCWRlZmF1
bHQ6Cj4gLQkJCWJyZWFrOwo+IC0JCX0KPiAtCX0KPiArCW11dGV4X2xvY2soJmRybS0+dHRtLmlv
X3Jlc2VydmVfbXV0ZXgpOwo+ICsJbm91dmVhdV90dG1faW9fbWVtX2ZyZWVfbG9ja2VkKGRybSwg
cmVnKTsKPiArCW11dGV4X3VubG9jaygmZHJtLT50dG0uaW9fcmVzZXJ2ZV9tdXRleCk7Cj4gICB9
Cj4gICAKPiAgIHN0YXRpYyBpbnQKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL25vdXZl
YXUvbm91dmVhdV9iby5oIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5oCj4g
aW5kZXggMzhmOWQ4MzUwOTYzLi5jNDdmY2RmODBhZGUgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL25vdXZl
YXUvbm91dmVhdV9iby5oCj4gQEAgLTE3LDYgKzE3LDcgQEAgc3RydWN0IG5vdXZlYXVfYm8gewo+
ICAgCWJvb2wgZm9yY2VfY29oZXJlbnQ7Cj4gICAJc3RydWN0IHR0bV9ib19rbWFwX29iaiBrbWFw
Owo+ICAgCXN0cnVjdCBsaXN0X2hlYWQgaGVhZDsKPiArCXN0cnVjdCBsaXN0X2hlYWQgaW9fcmVz
ZXJ2ZV9scnU7Cj4gICAKPiAgIAkvKiBwcm90ZWN0ZWQgYnkgdHRtX2JvX3Jlc2VydmUoKSAqLwo+
ICAgCXN0cnVjdCBkcm1fZmlsZSAqcmVzZXJ2ZWRfYnk7Cj4gQEAgLTkyLDYgKzkzLDggQEAgaW50
ICBub3V2ZWF1X2JvX3ZhbGlkYXRlKHN0cnVjdCBub3V2ZWF1X2JvICosIGJvb2wgaW50ZXJydXB0
aWJsZSwKPiAgIAkJCSBib29sIG5vX3dhaXRfZ3B1KTsKPiAgIHZvaWQgbm91dmVhdV9ib19zeW5j
X2Zvcl9kZXZpY2Uoc3RydWN0IG5vdXZlYXVfYm8gKm52Ym8pOwo+ICAgdm9pZCBub3V2ZWF1X2Jv
X3N5bmNfZm9yX2NwdShzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibyk7Cj4gK3ZvaWQgbm91dmVhdV9i
b19hZGRfaW9fcmVzZXJ2ZV9scnUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyk7Cj4gK3Zv
aWQgbm91dmVhdV9ib19kZWxfaW9fcmVzZXJ2ZV9scnUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0
ICpibyk7Cj4gICAKPiAgIC8qIFRPRE86IHN1Ym1pdCBlcXVpdmFsZW50IHRvIFRUTSBnZW5lcmlj
IEFQSSB1cHN0cmVhbT8gKi8KPiAgIHN0YXRpYyBpbmxpbmUgdm9pZCBfX2lvbWVtICoKPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9kcnYuaCBiL2RyaXZlcnMv
Z3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZHJ2LmgKPiBpbmRleCBkYThjNDZlMDk5NDMuLmNkMTlj
OGNlNTkzOSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2Ry
di5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9kcnYuaAo+IEBAIC0x
NTgsNiArMTU4LDggQEAgc3RydWN0IG5vdXZlYXVfZHJtIHsKPiAgIAkJaW50IHR5cGVfdnJhbTsK
PiAgIAkJaW50IHR5cGVfaG9zdFsyXTsKPiAgIAkJaW50IHR5cGVfbmNvaFsyXTsKPiArCQlzdHJ1
Y3QgbXV0ZXggaW9fcmVzZXJ2ZV9tdXRleDsKPiArCQlzdHJ1Y3QgbGlzdF9oZWFkIGlvX3Jlc2Vy
dmVfbHJ1Owo+ICAgCX0gdHRtOwo+ICAgCj4gICAJLyogR0VNIGludGVyZmFjZSBzdXBwb3J0ICov
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfdHRtLmMgYi9k
cml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3R0bS5jCj4gaW5kZXggNzdhMGM2YWQzY2Vm
Li41MDUxOGI0OGU5YjQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91
dmVhdV90dG0uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfdHRtLmMK
PiBAQCAtMTYyLDEzICsxNjIsNTEgQEAgY29uc3Qgc3RydWN0IHR0bV9tZW1fdHlwZV9tYW5hZ2Vy
X2Z1bmMgbnYwNF9nYXJ0X21hbmFnZXIgPSB7Cj4gICAJLmRlYnVnID0gbm91dmVhdV9tYW5hZ2Vy
X2RlYnVnCj4gICB9Owo+ICAgCj4gK3N0YXRpYyB2bV9mYXVsdF90IG5vdXZlYXVfdHRtX2ZhdWx0
KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQo+ICt7Cj4gKwlzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZt
YSA9IHZtZi0+dm1hOwo+ICsJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyA9IHZtYS0+dm1f
cHJpdmF0ZV9kYXRhOwo+ICsJcGdwcm90X3QgcHJvdDsKPiArCXZtX2ZhdWx0X3QgcmV0Owo+ICsK
PiArCXJldCA9IHR0bV9ib192bV9yZXNlcnZlKGJvLCB2bWYpOwo+ICsJaWYgKHJldCkKPiArCQly
ZXR1cm4gcmV0Owo+ICsKPiArCW5vdXZlYXVfYm9fZGVsX2lvX3Jlc2VydmVfbHJ1KGJvKTsKPiAr
Cj4gKwlwcm90ID0gdm1fZ2V0X3BhZ2VfcHJvdCh2bWEtPnZtX2ZsYWdzKTsKPiArCXJldCA9IHR0
bV9ib192bV9mYXVsdF9yZXNlcnZlZCh2bWYsIHByb3QsIFRUTV9CT19WTV9OVU1fUFJFRkFVTFQp
Owo+ICsJaWYgKHJldCA9PSBWTV9GQVVMVF9SRVRSWSAmJiAhKHZtZi0+ZmxhZ3MgJiBGQVVMVF9G
TEFHX1JFVFJZX05PV0FJVCkpCj4gKwkJcmV0dXJuIHJldDsKPiArCj4gKwlub3V2ZWF1X2JvX2Fk
ZF9pb19yZXNlcnZlX2xydShibyk7Cj4gKwo+ICsJZG1hX3Jlc3ZfdW5sb2NrKGJvLT5iYXNlLnJl
c3YpOwo+ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gK3N0YXRpYyBzdHJ1Y3Qgdm1fb3Bl
cmF0aW9uc19zdHJ1Y3Qgbm91dmVhdV90dG1fdm1fb3BzID0gewo+ICsJLmZhdWx0ID0gbm91dmVh
dV90dG1fZmF1bHQsCj4gKwkub3BlbiA9IHR0bV9ib192bV9vcGVuLAo+ICsJLmNsb3NlID0gdHRt
X2JvX3ZtX2Nsb3NlLAo+ICsJLmFjY2VzcyA9IHR0bV9ib192bV9hY2Nlc3MKPiArfTsKPiArCj4g
ICBpbnQKPiAgIG5vdXZlYXVfdHRtX21tYXAoc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdCB2bV9h
cmVhX3N0cnVjdCAqdm1hKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2ID0g
ZmlscC0+cHJpdmF0ZV9kYXRhOwo+ICAgCXN0cnVjdCBub3V2ZWF1X2RybSAqZHJtID0gbm91dmVh
dV9kcm0oZmlsZV9wcml2LT5taW5vci0+ZGV2KTsKPiArCWludCByZXQ7Cj4gICAKPiAtCXJldHVy
biB0dG1fYm9fbW1hcChmaWxwLCB2bWEsICZkcm0tPnR0bS5iZGV2KTsKPiArCXJldCA9IHR0bV9i
b19tbWFwKGZpbHAsIHZtYSwgJmRybS0+dHRtLmJkZXYpOwo+ICsJaWYgKHJldCkKPiArCQlyZXR1
cm4gcmV0Owo+ICsKPiArCXZtYS0+dm1fb3BzID0gJm5vdXZlYXVfdHRtX3ZtX29wczsKPiArCXJl
dHVybiAwOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50Cj4gQEAgLTI3Myw2ICszMTEsOSBAQCBu
b3V2ZWF1X3R0bV9pbml0KHN0cnVjdCBub3V2ZWF1X2RybSAqZHJtKQo+ICAgCQlyZXR1cm4gcmV0
Owo+ICAgCX0KPiAgIAo+ICsJbXV0ZXhfaW5pdCgmZHJtLT50dG0uaW9fcmVzZXJ2ZV9tdXRleCk7
Cj4gKwlJTklUX0xJU1RfSEVBRCgmZHJtLT50dG0uaW9fcmVzZXJ2ZV9scnUpOwo+ICsKPiAgIAlO
Vl9JTkZPKGRybSwgIlZSQU06ICVkIE1pQlxuIiwgKHUzMikoZHJtLT5nZW0udnJhbV9hdmFpbGFi
bGUgPj4gMjApKTsKPiAgIAlOVl9JTkZPKGRybSwgIkdBUlQ6ICVkIE1pQlxuIiwgKHUzMikoZHJt
LT5nZW0uZ2FydF9hdmFpbGFibGUgPj4gMjApKTsKPiAgIAlyZXR1cm4gMDsKPiAKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTm91dmVhdSBtYWlsaW5nIGxp
c3QKTm91dmVhdUBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9ub3V2ZWF1Cg==
