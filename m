Return-Path: <nouveau-bounces@lists.freedesktop.org>
X-Original-To: lists+nouveau@lfdr.de
Delivered-To: lists+nouveau@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 72252B14A8
	for <lists+nouveau@lfdr.de>; Thu, 12 Sep 2019 21:00:39 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id BD73B6EDFE;
	Thu, 12 Sep 2019 19:00:37 +0000 (UTC)
X-Original-To: nouveau@lists.freedesktop.org
Delivered-To: nouveau@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E3DC16EDFD
 for <nouveau@lists.freedesktop.org>; Thu, 12 Sep 2019 19:00:36 +0000 (UTC)
Received: from mail-wr1-f72.google.com (mail-wr1-f72.google.com
 [209.85.221.72])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 54FE74E4E6
 for <nouveau@lists.freedesktop.org>; Thu, 12 Sep 2019 19:00:36 +0000 (UTC)
Received: by mail-wr1-f72.google.com with SMTP id b1so12403965wru.4
 for <nouveau@lists.freedesktop.org>; Thu, 12 Sep 2019 12:00:36 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=t1H76sOO/RfZBMOwThMJxeZsuRD9fOMQF3SIFMch5CI=;
 b=bS2y4cDN5k6sj38vEeQJ0vlMiKHw6odTkbU+9rQ1JW/B6ZVLQ8c4O+VAgFjRgXcRXR
 FmENrjI2VU7PFVhEpoMfspN8XZPvOvIOQFO6VZ5L+cNiPYp5vaNEWKuwfRPUqVwQSRov
 p8TWkG+kczd6x9eOHEwncK5a6fP5w4WEle+lL1ygy7N60HUQuroL9SgP5tvxwljuesmn
 9/jsp47OwrrqNgXCUrGql+yT5ekNzOBHXfsgx+m82oaY/qKiyGFnxoGb0RSKrZV4fbdn
 I+Y6azGehbOSgKtRIIJxVBe2bLJxGh6WE8Lk2zbxaNuMbiJiDYO9Ibz74mjpnuwq1DxR
 VCjA==
X-Gm-Message-State: APjAAAUn0xRvDcOin5ml9NGFHNYHa74wJ6b8sVUQ3tMcZP9v/NFpNFrL
 KPj/zOC9QiSO9W7bOrXEilKngguI3oo/x8+C5V2e11suZO2U+iwvof/1Mmw++ZQ/2BZgBilVLPm
 WnIufhyXcUvgXVQgGNaMxapMAEA==
X-Received: by 2002:a5d:4251:: with SMTP id s17mr2840123wrr.126.1568314834771; 
 Thu, 12 Sep 2019 12:00:34 -0700 (PDT)
X-Google-Smtp-Source: APXvYqzHnXRhMVXeQeyCVpVpvPoXFlKWpXqW9AMf8v9jki4dbV90VNDvTmxBSjpNG2uuE7q863vr6Q==
X-Received: by 2002:a5d:4251:: with SMTP id s17mr2840105wrr.126.1568314834526; 
 Thu, 12 Sep 2019 12:00:34 -0700 (PDT)
Received: from kherbst.pingu.com ([2a02:8308:b0be:6900:f075:99ad:7efe:778d])
 by smtp.gmail.com with ESMTPSA id i9sm34104426wrb.18.2019.09.12.12.00.33
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 12 Sep 2019 12:00:33 -0700 (PDT)
From: Karol Herbst <kherbst@redhat.com>
To: nouveau@lists.freedesktop.org
Date: Thu, 12 Sep 2019 21:00:26 +0200
Message-Id: <20190912190028.27977-2-kherbst@redhat.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190912190028.27977-1-kherbst@redhat.com>
References: <20190912190028.27977-1-kherbst@redhat.com>
MIME-Version: 1.0
Subject: [Nouveau] [PATCH 1/3] pci: force disable ASPM before changing the
 link speed
X-BeenThere: nouveau@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Nouveau development list <nouveau.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/nouveau>
List-Post: <mailto:nouveau@lists.freedesktop.org>
List-Help: <mailto:nouveau-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: nouveau-bounces@lists.freedesktop.org
Sender: "Nouveau" <nouveau-bounces@lists.freedesktop.org>

dGFrZW4gZnJvbSBudmdwdQoKU2lnbmVkLW9mZi1ieTogS2Fyb2wgSGVyYnN0IDxraGVyYnN0QHJl
ZGhhdC5jb20+Ci0tLQogZHJtL25vdXZlYXUvbnZrbS9zdWJkZXYvcGNpL2c4NC5jICAgfCAgOSAr
KysrKysrKysKIGRybS9ub3V2ZWF1L252a20vc3ViZGV2L3BjaS9nOTIuYyAgIHwgIDEgKwogZHJt
L25vdXZlYXUvbnZrbS9zdWJkZXYvcGNpL2c5NC5jICAgfCAgMSArCiBkcm0vbm91dmVhdS9udmtt
L3N1YmRldi9wY2kvZ2YxMDAuYyB8ICAxICsKIGRybS9ub3V2ZWF1L252a20vc3ViZGV2L3BjaS9n
ZjEwNi5jIHwgIDEgKwogZHJtL25vdXZlYXUvbnZrbS9zdWJkZXYvcGNpL2drMTA0LmMgfCAgMSAr
CiBkcm0vbm91dmVhdS9udmttL3N1YmRldi9wY2kvcGNpZS5jICB8IDE0ICsrKysrKysrKysrKysr
CiBkcm0vbm91dmVhdS9udmttL3N1YmRldi9wY2kvcHJpdi5oICB8ICAyICsrCiA4IGZpbGVzIGNo
YW5nZWQsIDMwIGluc2VydGlvbnMoKykKCmRpZmYgLS1naXQgYS9kcm0vbm91dmVhdS9udmttL3N1
YmRldi9wY2kvZzg0LmMgYi9kcm0vbm91dmVhdS9udmttL3N1YmRldi9wY2kvZzg0LmMKaW5kZXgg
NjI0MzhkODkyLi4zNTNkNzBkN2UgMTAwNjQ0Ci0tLSBhL2RybS9ub3V2ZWF1L252a20vc3ViZGV2
L3BjaS9nODQuYworKysgYi9kcm0vbm91dmVhdS9udmttL3N1YmRldi9wY2kvZzg0LmMKQEAgLTEy
Miw2ICsxMjIsMTQgQEAgZzg0X3BjaV9pbml0KHN0cnVjdCBudmttX3BjaSAqcGNpKQogCQludmtt
X3BjaV9tYXNrKHBjaSwgMHgwNDFjLCAweDAwMDAwMDYwLCAweDAwMDAwMDAwKTsKIH0KIAordm9p
ZAorZzg0X3BjaWVfZm9yY2VfYXNwbV9vZmYoc3RydWN0IG52a21fcGNpICpwY2ksIGJvb2wgc3Rh
dHVzKQoreworCS8qIEwwcyBhbmQgTDEgKi8KKwl1MzIgdmFsdWUgPSBzdGF0dXMgPyAweDE4MCA6
IDB4MDsKKwludmttX3BjaV9tYXNrKHBjaSwgMHgxNTAsIDB4MTgwLCB2YWx1ZSk7Cit9CisKIGlu
dAogZzg0X3BjaWVfaW5pdChzdHJ1Y3QgbnZrbV9wY2kgKnBjaSkKIHsKQEAgLTE0Nyw2ICsxNTUs
NyBAQCBnODRfcGNpX2Z1bmMgPSB7CiAJLnBjaWUuc2V0X3ZlcnNpb24gPSBnODRfcGNpZV9zZXRf
dmVyc2lvbiwKIAkucGNpZS52ZXJzaW9uID0gZzg0X3BjaWVfdmVyc2lvbiwKIAkucGNpZS52ZXJz
aW9uX3N1cHBvcnRlZCA9IGc4NF9wY2llX3ZlcnNpb25fc3VwcG9ydGVkLAorCS5wY2llLmZvcmNl
X2FzcG1fb2ZmID0gZzg0X3BjaWVfZm9yY2VfYXNwbV9vZmYsCiB9OwogCiBpbnQKZGlmZiAtLWdp
dCBhL2RybS9ub3V2ZWF1L252a20vc3ViZGV2L3BjaS9nOTIuYyBiL2RybS9ub3V2ZWF1L252a20v
c3ViZGV2L3BjaS9nOTIuYwppbmRleCA0ODg3NDM1OWQuLjhjMzVjYzg5ZSAxMDA2NDQKLS0tIGEv
ZHJtL25vdXZlYXUvbnZrbS9zdWJkZXYvcGNpL2c5Mi5jCisrKyBiL2RybS9ub3V2ZWF1L252a20v
c3ViZGV2L3BjaS9nOTIuYwpAQCAtNDgsNiArNDgsNyBAQCBnOTJfcGNpX2Z1bmMgPSB7CiAJLnBj
aWUuc2V0X3ZlcnNpb24gPSBnODRfcGNpZV9zZXRfdmVyc2lvbiwKIAkucGNpZS52ZXJzaW9uID0g
Zzg0X3BjaWVfdmVyc2lvbiwKIAkucGNpZS52ZXJzaW9uX3N1cHBvcnRlZCA9IGc5Ml9wY2llX3Zl
cnNpb25fc3VwcG9ydGVkLAorCS5wY2llLmZvcmNlX2FzcG1fb2ZmID0gZzg0X3BjaWVfZm9yY2Vf
YXNwbV9vZmYsCiB9OwogCiBpbnQKZGlmZiAtLWdpdCBhL2RybS9ub3V2ZWF1L252a20vc3ViZGV2
L3BjaS9nOTQuYyBiL2RybS9ub3V2ZWF1L252a20vc3ViZGV2L3BjaS9nOTQuYwppbmRleCAwOWFk
YjM3YTUuLmFhMTUyZDc5OCAxMDA2NDQKLS0tIGEvZHJtL25vdXZlYXUvbnZrbS9zdWJkZXYvcGNp
L2c5NC5jCisrKyBiL2RybS9ub3V2ZWF1L252a20vc3ViZGV2L3BjaS9nOTQuYwpAQCAtNDAsNiAr
NDAsNyBAQCBnOTRfcGNpX2Z1bmMgPSB7CiAJLnBjaWUuc2V0X3ZlcnNpb24gPSBnODRfcGNpZV9z
ZXRfdmVyc2lvbiwKIAkucGNpZS52ZXJzaW9uID0gZzg0X3BjaWVfdmVyc2lvbiwKIAkucGNpZS52
ZXJzaW9uX3N1cHBvcnRlZCA9IGc5Ml9wY2llX3ZlcnNpb25fc3VwcG9ydGVkLAorCS5wY2llLmZv
cmNlX2FzcG1fb2ZmID0gZzg0X3BjaWVfZm9yY2VfYXNwbV9vZmYsCiB9OwogCiBpbnQKZGlmZiAt
LWdpdCBhL2RybS9ub3V2ZWF1L252a20vc3ViZGV2L3BjaS9nZjEwMC5jIGIvZHJtL25vdXZlYXUv
bnZrbS9zdWJkZXYvcGNpL2dmMTAwLmMKaW5kZXggMDBhNWU3ZDNlLi44Njc2NDgwYzMgMTAwNjQ0
Ci0tLSBhL2RybS9ub3V2ZWF1L252a20vc3ViZGV2L3BjaS9nZjEwMC5jCisrKyBiL2RybS9ub3V2
ZWF1L252a20vc3ViZGV2L3BjaS9nZjEwMC5jCkBAIC05Myw2ICs5Myw3IEBAIGdmMTAwX3BjaV9m
dW5jID0gewogCS5wY2llLnNldF92ZXJzaW9uID0gZ2YxMDBfcGNpZV9zZXRfdmVyc2lvbiwKIAku
cGNpZS52ZXJzaW9uID0gZ2YxMDBfcGNpZV92ZXJzaW9uLAogCS5wY2llLnZlcnNpb25fc3VwcG9y
dGVkID0gZzkyX3BjaWVfdmVyc2lvbl9zdXBwb3J0ZWQsCisJLnBjaWUuZm9yY2VfYXNwbV9vZmYg
PSBnODRfcGNpZV9mb3JjZV9hc3BtX29mZiwKIH07CiAKIGludApkaWZmIC0tZ2l0IGEvZHJtL25v
dXZlYXUvbnZrbS9zdWJkZXYvcGNpL2dmMTA2LmMgYi9kcm0vbm91dmVhdS9udmttL3N1YmRldi9w
Y2kvZ2YxMDYuYwppbmRleCAxMWJmNDE5YWYuLjgwNzllYmRkNCAxMDA2NDQKLS0tIGEvZHJtL25v
dXZlYXUvbnZrbS9zdWJkZXYvcGNpL2dmMTA2LmMKKysrIGIvZHJtL25vdXZlYXUvbnZrbS9zdWJk
ZXYvcGNpL2dmMTA2LmMKQEAgLTQwLDYgKzQwLDcgQEAgZ2YxMDZfcGNpX2Z1bmMgPSB7CiAJLnBj
aWUuc2V0X3ZlcnNpb24gPSBnZjEwMF9wY2llX3NldF92ZXJzaW9uLAogCS5wY2llLnZlcnNpb24g
PSBnZjEwMF9wY2llX3ZlcnNpb24sCiAJLnBjaWUudmVyc2lvbl9zdXBwb3J0ZWQgPSBnOTJfcGNp
ZV92ZXJzaW9uX3N1cHBvcnRlZCwKKwkucGNpZS5mb3JjZV9hc3BtX29mZiA9IGc4NF9wY2llX2Zv
cmNlX2FzcG1fb2ZmLAogfTsKIAogaW50CmRpZmYgLS1naXQgYS9kcm0vbm91dmVhdS9udmttL3N1
YmRldi9wY2kvZ2sxMDQuYyBiL2RybS9ub3V2ZWF1L252a20vc3ViZGV2L3BjaS9nazEwNC5jCmlu
ZGV4IGU2ODAzMDUwNy4uYjczOTIyYzUyIDEwMDY0NAotLS0gYS9kcm0vbm91dmVhdS9udmttL3N1
YmRldi9wY2kvZ2sxMDQuYworKysgYi9kcm0vbm91dmVhdS9udmttL3N1YmRldi9wY2kvZ2sxMDQu
YwpAQCAtMjE5LDYgKzIxOSw3IEBAIGdrMTA0X3BjaV9mdW5jID0gewogCS5wY2llLnNldF92ZXJz
aW9uID0gZ2YxMDBfcGNpZV9zZXRfdmVyc2lvbiwKIAkucGNpZS52ZXJzaW9uID0gZ2YxMDBfcGNp
ZV92ZXJzaW9uLAogCS5wY2llLnZlcnNpb25fc3VwcG9ydGVkID0gZ2sxMDRfcGNpZV92ZXJzaW9u
X3N1cHBvcnRlZCwKKwkucGNpZS5mb3JjZV9hc3BtX29mZiA9IGc4NF9wY2llX2ZvcmNlX2FzcG1f
b2ZmLAogfTsKIAogaW50CmRpZmYgLS1naXQgYS9kcm0vbm91dmVhdS9udmttL3N1YmRldi9wY2kv
cGNpZS5jIGIvZHJtL25vdXZlYXUvbnZrbS9zdWJkZXYvcGNpL3BjaWUuYwppbmRleCBkNzFlNWRi
NTAuLjM1NGFjNGM4NSAxMDA2NDQKLS0tIGEvZHJtL25vdXZlYXUvbnZrbS9zdWJkZXYvcGNpL3Bj
aWUuYworKysgYi9kcm0vbm91dmVhdS9udmttL3N1YmRldi9wY2kvcGNpZS5jCkBAIC0xMTEsNiAr
MTExLDE0IEBAIG52a21fcGNpZV9pbml0KHN0cnVjdCBudmttX3BjaSAqcGNpKQogCXJldHVybiAw
OwogfQogCit2b2lkCitudmttX3BjaWVfZm9yY2VfYXNwbV9vZmYoc3RydWN0IG52a21fcGNpICpw
Y2ksIGJvb2wgc3RhdHVzKQoreworCWlmICghcGNpLT5mdW5jLT5wY2llLmZvcmNlX2FzcG1fb2Zm
KQorCQlyZXR1cm47CisJcGNpLT5mdW5jLT5wY2llLmZvcmNlX2FzcG1fb2ZmKHBjaSwgc3RhdHVz
KTsKK30KKwogaW50CiBudmttX3BjaWVfc2V0X2xpbmsoc3RydWN0IG52a21fcGNpICpwY2ksIGVu
dW0gbnZrbV9wY2llX3NwZWVkIHNwZWVkLCB1OCB3aWR0aCkKIHsKQEAgLTE1Nyw5ICsxNjUsMTUg
QEAgbnZrbV9wY2llX3NldF9saW5rKHN0cnVjdCBudmttX3BjaSAqcGNpLCBlbnVtIG52a21fcGNp
ZV9zcGVlZCBzcGVlZCwgdTggd2lkdGgpCiAJbnZrbV9kZWJ1ZyhzdWJkZXYsICJzZXQgbGluayB0
byAlcyB4JWlcbiIsCiAJCSAgIG52a21fcGNpZV9zcGVlZHNbc3BlZWRdLCB3aWR0aCk7CiAKKwkv
KiBmb3JjZSBkaXNhYmxlIEFTUE0gKi8KKwludmttX3BjaWVfZm9yY2VfYXNwbV9vZmYocGNpLCB0
cnVlKTsKKwogCXJldCA9IHBjaS0+ZnVuYy0+cGNpZS5zZXRfbGluayhwY2ksIHNwZWVkLCB3aWR0
aCk7CiAJaWYgKHJldCA8IDApCiAJCW52a21fZXJyb3Ioc3ViZGV2LCAic2V0dGluZyBsaW5rIGZh
aWxlZDogJWlcbiIsIHJldCk7CiAKKwkvKiBsaWZ0IGZvcmNlIGRpc2FibGUgQVNQTSAqLworCW52
a21fcGNpZV9mb3JjZV9hc3BtX29mZihwY2ksIGZhbHNlKTsKKwogCXJldHVybiByZXQ7CiB9CmRp
ZmYgLS1naXQgYS9kcm0vbm91dmVhdS9udmttL3N1YmRldi9wY2kvcHJpdi5oIGIvZHJtL25vdXZl
YXUvbnZrbS9zdWJkZXYvcGNpL3ByaXYuaAppbmRleCA3MDA5YWFkODYuLmM2YTllZjMzMCAxMDA2
NDQKLS0tIGEvZHJtL25vdXZlYXUvbnZrbS9zdWJkZXYvcGNpL3ByaXYuaAorKysgYi9kcm0vbm91
dmVhdS9udmttL3N1YmRldi9wY2kvcHJpdi5oCkBAIC0yNCw2ICsyNCw3IEBAIHN0cnVjdCBudmtt
X3BjaV9mdW5jIHsKIAkJdm9pZCAoKnNldF92ZXJzaW9uKShzdHJ1Y3QgbnZrbV9wY2kgKiwgdTgp
OwogCQlpbnQgKCp2ZXJzaW9uKShzdHJ1Y3QgbnZrbV9wY2kgKik7CiAJCWludCAoKnZlcnNpb25f
c3VwcG9ydGVkKShzdHJ1Y3QgbnZrbV9wY2kgKik7CisJCXZvaWQgKCpmb3JjZV9hc3BtX29mZiko
c3RydWN0IG52a21fcGNpICosIGJvb2wpOwogCX0gcGNpZTsKIH07CiAKQEAgLTQyLDYgKzQzLDcg
QEAgaW50IGc4NF9wY2llX3ZlcnNpb24oc3RydWN0IG52a21fcGNpICopOwogdm9pZCBnODRfcGNp
ZV9zZXRfbGlua19zcGVlZChzdHJ1Y3QgbnZrbV9wY2kgKiwgZW51bSBudmttX3BjaWVfc3BlZWQp
OwogZW51bSBudmttX3BjaWVfc3BlZWQgZzg0X3BjaWVfY3VyX3NwZWVkKHN0cnVjdCBudmttX3Bj
aSAqKTsKIGVudW0gbnZrbV9wY2llX3NwZWVkIGc4NF9wY2llX21heF9zcGVlZChzdHJ1Y3QgbnZr
bV9wY2kgKik7Cit2b2lkIGc4NF9wY2llX2ZvcmNlX2FzcG1fb2ZmKHN0cnVjdCBudmttX3BjaSAq
LCBib29sIHN0YXR1cyk7CiBpbnQgZzg0X3BjaWVfaW5pdChzdHJ1Y3QgbnZrbV9wY2kgKik7CiBp
bnQgZzg0X3BjaWVfc2V0X2xpbmsoc3RydWN0IG52a21fcGNpICosIGVudW0gbnZrbV9wY2llX3Nw
ZWVkLCB1OCk7CiAKLS0gCjIuMjEuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KTm91dmVhdSBtYWlsaW5nIGxpc3QKTm91dmVhdUBsaXN0cy5mcmVlZGVz
a3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9u
b3V2ZWF1
