Return-Path: <nouveau-bounces@lists.freedesktop.org>
X-Original-To: lists+nouveau@lfdr.de
Delivered-To: lists+nouveau@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id C8D6CB574B
	for <lists+nouveau@lfdr.de>; Tue, 17 Sep 2019 23:01:05 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 343176ED74;
	Tue, 17 Sep 2019 21:01:04 +0000 (UTC)
X-Original-To: nouveau@lists.freedesktop.org
Delivered-To: nouveau@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 443036ED74
 for <nouveau@lists.freedesktop.org>; Tue, 17 Sep 2019 21:01:03 +0000 (UTC)
Received: from mail-wm1-f69.google.com (mail-wm1-f69.google.com
 [209.85.128.69])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 9DA204E8AC
 for <nouveau@lists.freedesktop.org>; Tue, 17 Sep 2019 21:01:02 +0000 (UTC)
Received: by mail-wm1-f69.google.com with SMTP id n11so10419wmc.8
 for <nouveau@lists.freedesktop.org>; Tue, 17 Sep 2019 14:01:02 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=QwKuJTiWIgIPXHsqb+98XW8T4YQ9YImyaGSyX+nyn90=;
 b=pfeYOvhfqZmRDWYRaej99RimunismZTJ4q+00oUJRFpMVWfg3pfZng77rHCIndnnhC
 ss2B+K1iju0g7k1O/dLo20gw8aL5A7g+j38hME/zjlCxWd64fW0qvAdHqXMvNRbxU+9G
 R5+yRsx7Wrx1FPDoyKT9uzyzClGGlY/lkGUywmZHpa0CVelKwrXYYBTTPoGgRVNQd0DP
 TqCMZG75L+h5keH39+gScjHyXIC8g27zL3XwqLJ1TiSpFncleSfELRJr/ixsB0WKZV/7
 Z2ZSfoqREH2aLYuQQ76+aIzS87hXpfDowiRGPK+gxoRAuBvzNJ9W9pOdV7C/vxWmdlLH
 BMjA==
X-Gm-Message-State: APjAAAXsDXHagCcbT0zZaEJAX8YG6VC/rFs8kmAH1nYj7ON0CUtIJzxP
 HIbKXAOl4+PKmBEmcS+04XH8qr+ONNzNjXZdZeZLcyJ0FoRrMrr+EYCCD734pwrUDL99lEBCMpN
 WDPACPZDkU0cmV34AjgQlDzIiJw==
X-Received: by 2002:a1c:5942:: with SMTP id n63mr31405wmb.65.1568754060977;
 Tue, 17 Sep 2019 14:01:00 -0700 (PDT)
X-Google-Smtp-Source: APXvYqxtqfG/8KNcCZXQf2+IiSxre87OSZNF8FpHSOI58Ptph/6qRuVoakj4v7qIRLMsknIXbEukfA==
X-Received: by 2002:a1c:5942:: with SMTP id n63mr31390wmb.65.1568754060739;
 Tue, 17 Sep 2019 14:01:00 -0700 (PDT)
Received: from kherbst.pingu.com ([2a02:8308:b0be:6900:e8b1:5ee7:bce5:6a14])
 by smtp.gmail.com with ESMTPSA id i74sm15907wmg.44.2019.09.17.14.00.59
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 17 Sep 2019 14:00:59 -0700 (PDT)
From: Karol Herbst <kherbst@redhat.com>
To: nouveau@lists.freedesktop.org
Date: Tue, 17 Sep 2019 23:00:49 +0200
Message-Id: <20190917210050.24457-6-kherbst@redhat.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190917210050.24457-1-kherbst@redhat.com>
References: <20190917210050.24457-1-kherbst@redhat.com>
MIME-Version: 1.0
Subject: [Nouveau] [PATCH 5/6] pci: set the pcie link speed to 8.0 when
 suspending
X-BeenThere: nouveau@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Nouveau development list <nouveau.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/nouveau>
List-Post: <mailto:nouveau@lists.freedesktop.org>
List-Help: <mailto:nouveau-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: nouveau-bounces@lists.freedesktop.org
Sender: "Nouveau" <nouveau-bounces@lists.freedesktop.org>

QXBwZXJhbnRseSB0aGluZ3MgZ28gc291dGggaWYgd2Ugc3VzcGVuZCB0aGUgZGV2aWNlIHdpdGgg
YSBQQ0llIGxpbmsgc3BlZWQKc2V0IHRvIDIuNS4gRml4ZXMgcnVudGltZSBzdXNwZW5kIG9uIG15
IGdwMTA3LgoKVGhpcyBhbGwgbG9va3MgbGlrZSBzb21lIGJ1ZyBpbnNpZGUgdGhlIHBjaSBzdWJz
eXN0ZW0gYW5kIEkgd291bGQgcHJlZmVyIGEKZml4IHRoZXJlIGluc3RlYWQgb2Ygbm91dmVhdSwg
YnV0IG1heWJlIHRoZXJlIGlzIG5vIHJlYWwgbmljZSB3YXkgb2YgZG9pbmcKdGhhdCBvdXRzaWRl
IG9mIGRyaXZlcnM/Cgp2Mjogc3F1YXNoZWQgdG9nZXRoZXIgcGF0Y2ggNCBhbmQgNQp2Mzogb25s
eSByZXN0b3JlIHBjaWUgc3BlZWQgb24gbWFjaGluZXMgd2l0aCBydW5wbQogICAgYWRkIE52UnVu
cG1Xb3JrYXJvdW5kIGNvbmZpZyBvcHRpb24gdG8gZGlzYWJsZSB0aGUgd29ya2Fyb3VuZAp2NDog
b25seSBydW4gdGhlIGNvZGUgb24gc3VzcGVuZAogICAgYWx3YXlzIHB1dCB0aGUgY2FyZCBpbnRv
IDguMCBtb2RlLCBub3Qgd2hhdCBub3V2ZWF1IGRldGVjdGVkIG9uIGxvYWQKClNpZ25lZC1vZmYt
Ynk6IEthcm9sIEhlcmJzdCA8a2hlcmJzdEByZWRoYXQuY29tPgpSZXZpZXdlZC1ieTogTHl1ZGUg
UGF1bCA8bHl1ZGVAcmVkaGF0LmNvbT4KLS0tCiBkcm0vbm91dmVhdS9pbmNsdWRlL252a20vY29y
ZS9kZXZpY2UuaCB8ICAyICsrCiBkcm0vbm91dmVhdS9pbmNsdWRlL252a20vc3ViZGV2L3BjaS5o
ICB8ICAzICsrLQogZHJtL25vdXZlYXUvbm91dmVhdV9kcm0uYyAgICAgICAgICAgICAgfCAgMSAr
CiBkcm0vbm91dmVhdS9udmttL3N1YmRldi9jbGsvYmFzZS5jICAgICB8ICAyICstCiBkcm0vbm91
dmVhdS9udmttL3N1YmRldi9wY2kvYmFzZS5jICAgICB8ICAyICsrCiBkcm0vbm91dmVhdS9udmtt
L3N1YmRldi9wY2kvcGNpZS5jICAgICB8IDI3ICsrKysrKysrKysrKysrKysrKysrKystLS0tCiBk
cm0vbm91dmVhdS9udmttL3N1YmRldi9wY2kvcHJpdi5oICAgICB8ICAxICsKIDcgZmlsZXMgY2hh
bmdlZCwgMzIgaW5zZXJ0aW9ucygrKSwgNiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcm0v
bm91dmVhdS9pbmNsdWRlL252a20vY29yZS9kZXZpY2UuaCBiL2RybS9ub3V2ZWF1L2luY2x1ZGUv
bnZrbS9jb3JlL2RldmljZS5oCmluZGV4IDZkNTVjZDA0Ny4uNGZiM2Y5NzJmIDEwMDY0NAotLS0g
YS9kcm0vbm91dmVhdS9pbmNsdWRlL252a20vY29yZS9kZXZpY2UuaAorKysgYi9kcm0vbm91dmVh
dS9pbmNsdWRlL252a20vY29yZS9kZXZpY2UuaApAQCAtMTI1LDYgKzEyNSw4IEBAIHN0cnVjdCBu
dmttX2RldmljZSB7CiAJdTggIGNoaXByZXY7CiAJdTMyIGNyeXN0YWw7CiAKKwlib29sIGhhc19y
dW5wbTsKKwogCXN0cnVjdCB7CiAJCXN0cnVjdCBub3RpZmllcl9ibG9jayBuYjsKIAl9IGFjcGk7
CmRpZmYgLS1naXQgYS9kcm0vbm91dmVhdS9pbmNsdWRlL252a20vc3ViZGV2L3BjaS5oIGIvZHJt
L25vdXZlYXUvaW5jbHVkZS9udmttL3N1YmRldi9wY2kuaAppbmRleCA0ODAzYTRmYWQuLjEwZDM2
MWU1NiAxMDA2NDQKLS0tIGEvZHJtL25vdXZlYXUvaW5jbHVkZS9udmttL3N1YmRldi9wY2kuaAor
KysgYi9kcm0vbm91dmVhdS9pbmNsdWRlL252a20vc3ViZGV2L3BjaS5oCkBAIC01Miw1ICs1Miw2
IEBAIGludCBnazEwNF9wY2lfbmV3KHN0cnVjdCBudmttX2RldmljZSAqLCBpbnQsIHN0cnVjdCBu
dmttX3BjaSAqKik7CiBpbnQgZ3AxMDBfcGNpX25ldyhzdHJ1Y3QgbnZrbV9kZXZpY2UgKiwgaW50
LCBzdHJ1Y3QgbnZrbV9wY2kgKiopOwogCiAvKiBwY2llIGZ1bmN0aW9ucyAqLwotaW50IG52a21f
cGNpZV9zZXRfbGluayhzdHJ1Y3QgbnZrbV9wY2kgKiwgZW51bSBudmttX3BjaWVfc3BlZWQsIHU4
IHdpZHRoKTsKK2ludCBudmttX3BjaWVfc2V0X2xpbmsoc3RydWN0IG52a21fcGNpICosIGVudW0g
bnZrbV9wY2llX3NwZWVkLCB1OCB3aWR0aCwKKwkJICAgICAgIGJvb2wgc2F2ZSk7CiAjZW5kaWYK
ZGlmZiAtLWdpdCBhL2RybS9ub3V2ZWF1L25vdXZlYXVfZHJtLmMgYi9kcm0vbm91dmVhdS9ub3V2
ZWF1X2RybS5jCmluZGV4IDNkMzJhZmU4YS4uNzhkNTVjNTI1IDEwMDY0NAotLS0gYS9kcm0vbm91
dmVhdS9ub3V2ZWF1X2RybS5jCisrKyBiL2RybS9ub3V2ZWF1L25vdXZlYXVfZHJtLmMKQEAgLTY3
Niw2ICs2NzYsNyBAQCBzdGF0aWMgaW50IG5vdXZlYXVfZHJtX3Byb2JlKHN0cnVjdCBwY2lfZGV2
ICpwZGV2LAogCiAJaWYgKG5vdXZlYXVfYXRvbWljKQogCQlkcml2ZXJfcGNpLmRyaXZlcl9mZWF0
dXJlcyB8PSBEUklWRVJfQVRPTUlDOworCWRldmljZS0+aGFzX3J1bnBtID0gbm91dmVhdV9wbW9w
c19ydW50aW1lKCk7CiAKIAlkcm1fZGV2ID0gZHJtX2Rldl9hbGxvYygmZHJpdmVyX3BjaSwgJnBk
ZXYtPmRldik7CiAJaWYgKElTX0VSUihkcm1fZGV2KSkgewpkaWZmIC0tZ2l0IGEvZHJtL25vdXZl
YXUvbnZrbS9zdWJkZXYvY2xrL2Jhc2UuYyBiL2RybS9ub3V2ZWF1L252a20vc3ViZGV2L2Nsay9i
YXNlLmMKaW5kZXggYmE2YTg2OGQ0Li5lMzBlNzc0NTMgMTAwNjQ0Ci0tLSBhL2RybS9ub3V2ZWF1
L252a20vc3ViZGV2L2Nsay9iYXNlLmMKKysrIGIvZHJtL25vdXZlYXUvbnZrbS9zdWJkZXYvY2xr
L2Jhc2UuYwpAQCAtMjc3LDcgKzI3Nyw3IEBAIG52a21fcHN0YXRlX3Byb2coc3RydWN0IG52a21f
Y2xrICpjbGssIGludCBwc3RhdGVpKQogCW52a21fZGVidWcoc3ViZGV2LCAic2V0dGluZyBwZXJm
b3JtYW5jZSBzdGF0ZSAlZFxuIiwgcHN0YXRlaSk7CiAJY2xrLT5wc3RhdGUgPSBwc3RhdGVpOwog
Ci0JbnZrbV9wY2llX3NldF9saW5rKHBjaSwgcHN0YXRlLT5wY2llX3NwZWVkLCBwc3RhdGUtPnBj
aWVfd2lkdGgpOworCW52a21fcGNpZV9zZXRfbGluayhwY2ksIHBzdGF0ZS0+cGNpZV9zcGVlZCwg
cHN0YXRlLT5wY2llX3dpZHRoLCB0cnVlKTsKIAogCWlmIChmYiAmJiBmYi0+cmFtICYmIGZiLT5y
YW0tPmZ1bmMtPmNhbGMpIHsKIAkJc3RydWN0IG52a21fcmFtICpyYW0gPSBmYi0+cmFtOwpkaWZm
IC0tZ2l0IGEvZHJtL25vdXZlYXUvbnZrbS9zdWJkZXYvcGNpL2Jhc2UuYyBiL2RybS9ub3V2ZWF1
L252a20vc3ViZGV2L3BjaS9iYXNlLmMKaW5kZXggZWUyNDMxYTc4Li5jOWI2MGVmNzYgMTAwNjQ0
Ci0tLSBhL2RybS9ub3V2ZWF1L252a20vc3ViZGV2L3BjaS9iYXNlLmMKKysrIGIvZHJtL25vdXZl
YXUvbnZrbS9zdWJkZXYvcGNpL2Jhc2UuYwpAQCAtOTAsNiArOTAsOCBAQCBudmttX3BjaV9maW5p
KHN0cnVjdCBudmttX3N1YmRldiAqc3ViZGV2LCBib29sIHN1c3BlbmQpCiAKIAlpZiAocGNpLT5h
Z3AuYnJpZGdlKQogCQludmttX2FncF9maW5pKHBjaSk7CisJZWxzZSBpZiAocGNpX2lzX3BjaWUo
cGNpLT5wZGV2KSkKKwkJbnZrbV9wY2llX2ZpbmkocGNpLCBzdXNwZW5kKTsKIAogCXJldHVybiAw
OwogfQpkaWZmIC0tZ2l0IGEvZHJtL25vdXZlYXUvbnZrbS9zdWJkZXYvcGNpL3BjaWUuYyBiL2Ry
bS9ub3V2ZWF1L252a20vc3ViZGV2L3BjaS9wY2llLmMKaW5kZXggZWQwMTViMjUyLi42YzI5MGIz
ZjUgMTAwNjQ0Ci0tLSBhL2RybS9ub3V2ZWF1L252a20vc3ViZGV2L3BjaS9wY2llLmMKKysrIGIv
ZHJtL25vdXZlYXUvbnZrbS9zdWJkZXYvcGNpL3BjaWUuYwpAQCAtMjMsNiArMjMsOCBAQAogICov
CiAjaW5jbHVkZSAicHJpdi5oIgogCisjaW5jbHVkZSA8Y29yZS9vcHRpb24uaD4KKwogc3RhdGlj
IGNoYXIgKm52a21fcGNpZV9zcGVlZHNbXSA9IHsKIAkiMi41R1QvcyIsCiAJIjUuMEdUL3MiLApA
QCAtMTA2LDExICsxMDgsMjUgQEAgbnZrbV9wY2llX2luaXQoc3RydWN0IG52a21fcGNpICpwY2kp
CiAJCXBjaS0+ZnVuYy0+cGNpZS5pbml0KHBjaSk7CiAKIAlpZiAocGNpLT5wY2llLnNwZWVkICE9
IC0xKQotCQludmttX3BjaWVfc2V0X2xpbmsocGNpLCBwY2ktPnBjaWUuc3BlZWQsIHBjaS0+cGNp
ZS53aWR0aCk7CisJCW52a21fcGNpZV9zZXRfbGluayhwY2ksIHBjaS0+cGNpZS5zcGVlZCwKKwkJ
CQkgICBwY2ktPnBjaWUud2lkdGgsIGZhbHNlKTsKIAogCXJldHVybiAwOwogfQogCitpbnQKK252
a21fcGNpZV9maW5pKHN0cnVjdCBudmttX3BjaSAqcGNpLCBib29sIHN1c3BlbmQpCit7CisJc3Ry
dWN0IG52a21fZGV2aWNlICpkZXZpY2UgPSBwY2ktPnN1YmRldi5kZXZpY2U7CisJaWYgKCFkZXZp
Y2UtPmhhc19ydW5wbSB8fCAhc3VzcGVuZCkKKwkJcmV0dXJuIDA7CisKKwlpZiAoIW52a21fYm9v
bG9wdChkZXZpY2UtPmNmZ29wdCwgIk52UnVucG1Xb3JrYXJvdW5kIiwgdHJ1ZSkpCisJCXJldHVy
biAwOworCisJcmV0dXJuIG52a21fcGNpZV9zZXRfbGluayhwY2ksIE5WS01fUENJRV9TUEVFRF84
XzAsIDE2LCBmYWxzZSk7Cit9CisKIGVudW0gbnZrbV9wY2lfYXNwbQogbnZrbV9wY2llX2FzcG1f
b2ZmKHN0cnVjdCBudmttX3BjaSAqcGNpLCBlbnVtIG52a21fcGNpX2FzcG0gc3RhdGVzKQogewpA
QCAtMTIwLDcgKzEzNiw4IEBAIG52a21fcGNpZV9hc3BtX29mZihzdHJ1Y3QgbnZrbV9wY2kgKnBj
aSwgZW51bSBudmttX3BjaV9hc3BtIHN0YXRlcykKIH0KIAogaW50Ci1udmttX3BjaWVfc2V0X2xp
bmsoc3RydWN0IG52a21fcGNpICpwY2ksIGVudW0gbnZrbV9wY2llX3NwZWVkIHNwZWVkLCB1OCB3
aWR0aCkKK252a21fcGNpZV9zZXRfbGluayhzdHJ1Y3QgbnZrbV9wY2kgKnBjaSwgZW51bSBudmtt
X3BjaWVfc3BlZWQgc3BlZWQsIHU4IHdpZHRoLAorICAgICAgICAgICAgICAgICAgIGJvb2wgc2F2
ZSkKIHsKIAlzdHJ1Y3QgbnZrbV9zdWJkZXYgKnN1YmRldiA9ICZwY2ktPnN1YmRldjsKIAllbnVt
IG52a21fcGNpZV9zcGVlZCBjdXJfc3BlZWQsIG1heF9zcGVlZDsKQEAgLTE1NSw4ICsxNzIsMTAg
QEAgbnZrbV9wY2llX3NldF9saW5rKHN0cnVjdCBudmttX3BjaSAqcGNpLCBlbnVtIG52a21fcGNp
ZV9zcGVlZCBzcGVlZCwgdTggd2lkdGgpCiAJCXNwZWVkID0gbWF4X3NwZWVkOwogCX0KIAotCXBj
aS0+cGNpZS5zcGVlZCA9IHNwZWVkOwotCXBjaS0+cGNpZS53aWR0aCA9IHdpZHRoOworCWlmIChz
YXZlKSB7CisJCXBjaS0+cGNpZS5zcGVlZCA9IHNwZWVkOworCQlwY2ktPnBjaWUud2lkdGggPSB3
aWR0aDsKKwl9CiAKIAlpZiAoc3BlZWQgPT0gY3VyX3NwZWVkKSB7CiAJCW52a21fZGVidWcoc3Vi
ZGV2LCAicmVxdWVzdGVkIG1hdGNoZXMgY3VycmVudCBzcGVlZFxuIik7CmRpZmYgLS1naXQgYS9k
cm0vbm91dmVhdS9udmttL3N1YmRldi9wY2kvcHJpdi5oIGIvZHJtL25vdXZlYXUvbnZrbS9zdWJk
ZXYvcGNpL3ByaXYuaAppbmRleCAxN2JlMWQ1NjMuLmQ5YTMyYjQxZSAxMDA2NDQKLS0tIGEvZHJt
L25vdXZlYXUvbnZrbS9zdWJkZXYvcGNpL3ByaXYuaAorKysgYi9kcm0vbm91dmVhdS9udmttL3N1
YmRldi9wY2kvcHJpdi5oCkBAIC03MSw0ICs3MSw1IEBAIGludCBnazEwNF9wY2llX3ZlcnNpb25f
c3VwcG9ydGVkKHN0cnVjdCBudmttX3BjaSAqKTsKIAogaW50IG52a21fcGNpZV9vbmVpbml0KHN0
cnVjdCBudmttX3BjaSAqKTsKIGludCBudmttX3BjaWVfaW5pdChzdHJ1Y3QgbnZrbV9wY2kgKik7
CitpbnQgbnZrbV9wY2llX2Zpbmkoc3RydWN0IG52a21fcGNpICosIGJvb2wgc3VzcGVuZCk7CiAj
ZW5kaWYKLS0gCjIuMjEuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KTm91dmVhdSBtYWlsaW5nIGxpc3QKTm91dmVhdUBsaXN0cy5mcmVlZGVza3RvcC5v
cmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9ub3V2ZWF1
