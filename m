Return-Path: <nouveau-bounces@lists.freedesktop.org>
X-Original-To: lists+nouveau@lfdr.de
Delivered-To: lists+nouveau@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 39866434CF
	for <lists+nouveau@lfdr.de>; Thu, 13 Jun 2019 11:43:59 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A860F89856;
	Thu, 13 Jun 2019 09:43:57 +0000 (UTC)
X-Original-To: nouveau@lists.freedesktop.org
Delivered-To: nouveau@lists.freedesktop.org
Received: from bombadil.infradead.org (bombadil.infradead.org
 [IPv6:2607:7c80:54:e::133])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6AB1E89854;
 Thu, 13 Jun 2019 09:43:56 +0000 (UTC)
Received: from mpp-cp1-natpool-1-198.ethz.ch ([82.130.71.198] helo=localhost)
 by bombadil.infradead.org with esmtpsa (Exim 4.92 #3 (Red Hat Linux))
 id 1hbMGu-0001ni-6t; Thu, 13 Jun 2019 09:43:52 +0000
From: Christoph Hellwig <hch@lst.de>
To: Dan Williams <dan.j.williams@intel.com>,
 =?UTF-8?q?J=C3=A9r=C3=B4me=20Glisse?= <jglisse@redhat.com>,
 Jason Gunthorpe <jgg@mellanox.com>, Ben Skeggs <bskeggs@redhat.com>
Date: Thu, 13 Jun 2019 11:43:11 +0200
Message-Id: <20190613094326.24093-9-hch@lst.de>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190613094326.24093-1-hch@lst.de>
References: <20190613094326.24093-1-hch@lst.de>
MIME-Version: 1.0
X-SRS-Rewrite: SMTP reverse-path rewritten from <hch@infradead.org> by
 bombadil.infradead.org. See http://www.infradead.org/rpr.html
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; 
 d=infradead.org; s=bombadil.20170209; h=Content-Transfer-Encoding:
 MIME-Version:References:In-Reply-To:Message-Id:Date:Subject:Cc:To:From:Sender
 :Reply-To:Content-Type:Content-ID:Content-Description:Resent-Date:Resent-From
 :Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Id:List-Help:
 List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=J6KgL/HbS2N6LTNHClyEsjbtYbBDeWvEUc8ywUokDbM=; b=Jh8lILEBlkoz7BxZUpZfrk+rPo
 5Vv8zvkEs/Fw9OO79N5N/Y0XT5tjZHyEHTWn8eyvOgqXtUXVd1z/SRTfQtsDOkc03rcc8Oqr+0gGj
 XtkmK2r6kYcloDj/rKBacpiDOED1N5eXx2e3cRHkATAi8m82hHeWGVKkUJ/Fey7N4V9iRL/1FecYK
 PCRNRhSXbu3d/ofC8c+2tCSbKz0UToD06c23kveqrK8w7bUNKe5YMyLwjfgvyitQrNsCgWTU3bjfC
 +/5c3xHAUo+nzc8XFEIMoLhoIwvUGPRqZ8AKtA0fnh3a7Vt8YVEbCbjiXL7LVQ5gOLdxh0voFqRRa
 p1FErRFg==;
Subject: [Nouveau] [PATCH 08/22] memremap: pass a struct dev_pagemap to
 ->kill
X-BeenThere: nouveau@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Nouveau development list <nouveau.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/nouveau>
List-Post: <mailto:nouveau@lists.freedesktop.org>
List-Help: <mailto:nouveau-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/nouveau>,
 <mailto:nouveau-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-nvdimm@lists.01.org, linux-pci@vger.kernel.org,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 linux-mm@kvack.org, nouveau@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: nouveau-bounces@lists.freedesktop.org
Sender: "Nouveau" <nouveau-bounces@lists.freedesktop.org>

UGFzc2luZyB0aGUgYWN0dWFsIHR5cGVkIHN0cnVjdHVyZSBsZWFkcyB0byBtb3JlIHVuZGVyc3Rh
bmRhYmxlIGNvZGUKdnMgdGhlIGFjdHVhbCByZWZlcmVuY2VzLgoKU2lnbmVkLW9mZi1ieTogQ2hy
aXN0b3BoIEhlbGx3aWcgPGhjaEBsc3QuZGU+Ci0tLQogZHJpdmVycy9kYXgvZGV2aWNlLmMgICAg
ICAgICAgICAgIHwgNyArKystLS0tCiBkcml2ZXJzL252ZGltbS9wbWVtLmMgICAgICAgICAgICAg
fCA2ICsrKy0tLQogZHJpdmVycy9wY2kvcDJwZG1hLmMgICAgICAgICAgICAgIHwgNiArKystLS0K
IGluY2x1ZGUvbGludXgvbWVtcmVtYXAuaCAgICAgICAgICB8IDIgKy0KIGtlcm5lbC9tZW1yZW1h
cC5jICAgICAgICAgICAgICAgICB8IDQgKystLQogbW0vaG1tLmMgICAgICAgICAgICAgICAgICAg
ICAgICAgIHwgNCArKy0tCiB0b29scy90ZXN0aW5nL252ZGltbS90ZXN0L2lvbWFwLmMgfCA2ICsr
LS0tLQogNyBmaWxlcyBjaGFuZ2VkLCAxNiBpbnNlcnRpb25zKCspLCAxOSBkZWxldGlvbnMoLSkK
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2RheC9kZXZpY2UuYyBiL2RyaXZlcnMvZGF4L2RldmljZS5j
CmluZGV4IDRhZGFiNzc0ZGFkZS4uZTIzZmExYmQ4Yzk3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2Rh
eC9kZXZpY2UuYworKysgYi9kcml2ZXJzL2RheC9kZXZpY2UuYwpAQCAtMzcsMTMgKzM3LDEyIEBA
IHN0YXRpYyB2b2lkIGRldl9kYXhfcGVyY3B1X2V4aXQodm9pZCAqZGF0YSkKIAlwZXJjcHVfcmVm
X2V4aXQocmVmKTsKIH0KIAotc3RhdGljIHZvaWQgZGV2X2RheF9wZXJjcHVfa2lsbChzdHJ1Y3Qg
cGVyY3B1X3JlZiAqZGF0YSkKK3N0YXRpYyB2b2lkIGRldl9kYXhfcGVyY3B1X2tpbGwoc3RydWN0
IGRldl9wYWdlbWFwICpwZ21hcCkKIHsKLQlzdHJ1Y3QgcGVyY3B1X3JlZiAqcmVmID0gZGF0YTsK
LQlzdHJ1Y3QgZGV2X2RheCAqZGV2X2RheCA9IHJlZl90b19kZXZfZGF4KHJlZik7CisJc3RydWN0
IGRldl9kYXggKmRldl9kYXggPSBjb250YWluZXJfb2YocGdtYXAsIHN0cnVjdCBkZXZfZGF4LCBw
Z21hcCk7CiAKIAlkZXZfZGJnKCZkZXZfZGF4LT5kZXYsICIlc1xuIiwgX19mdW5jX18pOwotCXBl
cmNwdV9yZWZfa2lsbChyZWYpOworCXBlcmNwdV9yZWZfa2lsbChwZ21hcC0+cmVmKTsKIH0KIAog
c3RhdGljIGludCBjaGVja192bWEoc3RydWN0IGRldl9kYXggKmRldl9kYXgsIHN0cnVjdCB2bV9h
cmVhX3N0cnVjdCAqdm1hLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9udmRpbW0vcG1lbS5jIGIvZHJp
dmVycy9udmRpbW0vcG1lbS5jCmluZGV4IDRlZmJmMTg0ZWE2OC4uYjk2MzhjNjU1M2ExIDEwMDY0
NAotLS0gYS9kcml2ZXJzL252ZGltbS9wbWVtLmMKKysrIGIvZHJpdmVycy9udmRpbW0vcG1lbS5j
CkBAIC0zMTYsMTEgKzMxNiwxMSBAQCBzdGF0aWMgdm9pZCBwbWVtX3JlbGVhc2VfcXVldWUodm9p
ZCAqcSkKIAlibGtfY2xlYW51cF9xdWV1ZShxKTsKIH0KIAotc3RhdGljIHZvaWQgcG1lbV9raWxs
KHN0cnVjdCBwZXJjcHVfcmVmICpyZWYpCitzdGF0aWMgdm9pZCBwbWVtX2tpbGwoc3RydWN0IGRl
dl9wYWdlbWFwICpwZ21hcCkKIHsKLQlzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcTsKKwlzdHJ1Y3Qg
cmVxdWVzdF9xdWV1ZSAqcSA9CisJCWNvbnRhaW5lcl9vZihwZ21hcC0+cmVmLCBzdHJ1Y3QgcmVx
dWVzdF9xdWV1ZSwgcV91c2FnZV9jb3VudGVyKTsKIAotCXEgPSBjb250YWluZXJfb2YocmVmLCB0
eXBlb2YoKnEpLCBxX3VzYWdlX2NvdW50ZXIpOwogCWJsa19mcmVlemVfcXVldWVfc3RhcnQocSk7
CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvcGNpL3AycGRtYS5jIGIvZHJpdmVycy9wY2kvcDJw
ZG1hLmMKaW5kZXggNmU3NjM4MGY1Yjk3Li4zYmNhY2M5MjIyYzYgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvcGNpL3AycGRtYS5jCisrKyBiL2RyaXZlcnMvcGNpL3AycGRtYS5jCkBAIC04Miw3ICs4Miw3
IEBAIHN0YXRpYyB2b2lkIHBjaV9wMnBkbWFfcGVyY3B1X3JlbGVhc2Uoc3RydWN0IHBlcmNwdV9y
ZWYgKnJlZikKIAljb21wbGV0ZV9hbGwoJnAycC0+ZGV2bWFwX3JlZl9kb25lKTsKIH0KIAotc3Rh
dGljIHZvaWQgcGNpX3AycGRtYV9wZXJjcHVfa2lsbChzdHJ1Y3QgcGVyY3B1X3JlZiAqcmVmKQor
c3RhdGljIHZvaWQgcGNpX3AycGRtYV9wZXJjcHVfa2lsbChzdHJ1Y3QgZGV2X3BhZ2VtYXAgKnBn
bWFwKQogewogCS8qCiAJICogcGNpX3AycGRtYV9hZGRfcmVzb3VyY2UoKSBtYXkgYmUgY2FsbGVk
IG11bHRpcGxlIHRpbWVzCkBAIC05MCwxMCArOTAsMTAgQEAgc3RhdGljIHZvaWQgcGNpX3AycGRt
YV9wZXJjcHVfa2lsbChzdHJ1Y3QgcGVyY3B1X3JlZiAqcmVmKQogCSAqIHRpbWVzLiBXZSBvbmx5
IHdhbnQgdGhlIGZpcnN0IGFjdGlvbiB0byBhY3R1YWxseSBraWxsIHRoZQogCSAqIHBlcmNwdV9y
ZWYuCiAJICovCi0JaWYgKHBlcmNwdV9yZWZfaXNfZHlpbmcocmVmKSkKKwlpZiAocGVyY3B1X3Jl
Zl9pc19keWluZyhwZ21hcC0+cmVmKSkKIAkJcmV0dXJuOwogCi0JcGVyY3B1X3JlZl9raWxsKHJl
Zik7CisJcGVyY3B1X3JlZl9raWxsKHBnbWFwLT5yZWYpOwogfQogCiBzdGF0aWMgdm9pZCBwY2lf
cDJwZG1hX3JlbGVhc2Uodm9pZCAqZGF0YSkKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvbWVt
cmVtYXAuaCBiL2luY2x1ZGUvbGludXgvbWVtcmVtYXAuaAppbmRleCA1ZjdmNDA4NzViMzUuLjk2
YTNhNmQ1NjRhZCAxMDA2NDQKLS0tIGEvaW5jbHVkZS9saW51eC9tZW1yZW1hcC5oCisrKyBiL2lu
Y2x1ZGUvbGludXgvbWVtcmVtYXAuaApAQCAtNzQsNyArNzQsNyBAQCBzdHJ1Y3QgZGV2X3BhZ2Vt
YXBfb3BzIHsKIAkvKgogCSAqIFRyYW5zaXRpb24gdGhlIHBlcmNwdV9yZWYgaW4gc3RydWN0IGRl
dl9wYWdlbWFwIHRvIHRoZSBkZWFkIHN0YXRlLgogCSAqLwotCXZvaWQgKCpraWxsKShzdHJ1Y3Qg
cGVyY3B1X3JlZiAqcmVmKTsKKwl2b2lkICgqa2lsbCkoc3RydWN0IGRldl9wYWdlbWFwICpwZ21h
cCk7CiB9OwogCiAvKioKZGlmZiAtLWdpdCBhL2tlcm5lbC9tZW1yZW1hcC5jIGIva2VybmVsL21l
bXJlbWFwLmMKaW5kZXggZTIzMjg2Y2UwZWM0Li45NGI4MzBiNmVjYTUgMTAwNjQ0Ci0tLSBhL2tl
cm5lbC9tZW1yZW1hcC5jCisrKyBiL2tlcm5lbC9tZW1yZW1hcC5jCkBAIC05Miw3ICs5Miw3IEBA
IHN0YXRpYyB2b2lkIGRldm1fbWVtcmVtYXBfcGFnZXNfcmVsZWFzZSh2b2lkICpkYXRhKQogCXVu
c2lnbmVkIGxvbmcgcGZuOwogCWludCBuaWQ7CiAKLQlwZ21hcC0+b3BzLT5raWxsKHBnbWFwLT5y
ZWYpOworCXBnbWFwLT5vcHMtPmtpbGwocGdtYXApOwogCWZvcl9lYWNoX2RldmljZV9wZm4ocGZu
LCBwZ21hcCkKIAkJcHV0X3BhZ2UocGZuX3RvX3BhZ2UocGZuKSk7CiAKQEAgLTI2Niw3ICsyNjYs
NyBAQCB2b2lkICpkZXZtX21lbXJlbWFwX3BhZ2VzKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0
IGRldl9wYWdlbWFwICpwZ21hcCkKICBlcnJfcGZuX3JlbWFwOgogCXBnbWFwX2FycmF5X2RlbGV0
ZShyZXMpOwogIGVycl9hcnJheToKLQlwZ21hcC0+b3BzLT5raWxsKHBnbWFwLT5yZWYpOworCXBn
bWFwLT5vcHMtPmtpbGwocGdtYXApOwogCXJldHVybiBFUlJfUFRSKGVycm9yKTsKIH0KIEVYUE9S
VF9TWU1CT0xfR1BMKGRldm1fbWVtcmVtYXBfcGFnZXMpOwpkaWZmIC0tZ2l0IGEvbW0vaG1tLmMg
Yi9tbS9obW0uYwppbmRleCAyNTAxYWM2MDQ1ZDAuLmM3NmExYjVkZWZkYSAxMDA2NDQKLS0tIGEv
bW0vaG1tLmMKKysrIGIvbW0vaG1tLmMKQEAgLTEzMjUsOSArMTMyNSw5IEBAIHN0YXRpYyB2b2lk
IGhtbV9kZXZtZW1fcmVmX2V4aXQodm9pZCAqZGF0YSkKIAlwZXJjcHVfcmVmX2V4aXQocmVmKTsK
IH0KIAotc3RhdGljIHZvaWQgaG1tX2Rldm1lbV9yZWZfa2lsbChzdHJ1Y3QgcGVyY3B1X3JlZiAq
cmVmKQorc3RhdGljIHZvaWQgaG1tX2Rldm1lbV9yZWZfa2lsbChzdHJ1Y3QgZGV2X3BhZ2VtYXAg
KnBnbWFwKQogewotCXBlcmNwdV9yZWZfa2lsbChyZWYpOworCXBlcmNwdV9yZWZfa2lsbChwZ21h
cC0+cmVmKTsKIH0KIAogc3RhdGljIHZtX2ZhdWx0X3QgaG1tX2Rldm1lbV9mYXVsdChzdHJ1Y3Qg
dm1fYXJlYV9zdHJ1Y3QgKnZtYSwKZGlmZiAtLWdpdCBhL3Rvb2xzL3Rlc3RpbmcvbnZkaW1tL3Rl
c3QvaW9tYXAuYyBiL3Rvb2xzL3Rlc3RpbmcvbnZkaW1tL3Rlc3QvaW9tYXAuYwppbmRleCA3ZjVl
Y2U5YjUwMTEuLmVlMDdjNGRlMmIzNSAxMDA2NDQKLS0tIGEvdG9vbHMvdGVzdGluZy9udmRpbW0v
dGVzdC9pb21hcC5jCisrKyBiL3Rvb2xzL3Rlc3RpbmcvbnZkaW1tL3Rlc3QvaW9tYXAuYwpAQCAt
MTA0LDExICsxMDQsOSBAQCB2b2lkICpfX3dyYXBfZGV2bV9tZW1yZW1hcChzdHJ1Y3QgZGV2aWNl
ICpkZXYsIHJlc291cmNlX3NpemVfdCBvZmZzZXQsCiB9CiBFWFBPUlRfU1lNQk9MKF9fd3JhcF9k
ZXZtX21lbXJlbWFwKTsKIAotc3RhdGljIHZvaWQgbmZpdF90ZXN0X2tpbGwodm9pZCAqX3BnbWFw
KQorc3RhdGljIHZvaWQgbmZpdF90ZXN0X2tpbGwodm9pZCAqcGdtYXApCiB7Ci0Jc3RydWN0IGRl
dl9wYWdlbWFwICpwZ21hcCA9IF9wZ21hcDsKLQotCXBnbWFwLT5vcHMtPmtpbGwocGdtYXAtPnJl
Zik7CisJcGdtYXAtPm9wcy0+a2lsbChwZ21hcCk7CiB9CiAKIHZvaWQgKl9fd3JhcF9kZXZtX21l
bXJlbWFwX3BhZ2VzKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldl9wYWdlbWFwICpwZ21h
cCkKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KTm91dmVhdSBtYWlsaW5nIGxpc3QKTm91dmVhdUBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9ub3V2ZWF1
